<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="rict">
<title>River Invertebrate Classification Tool (RICT) Functional Specification • rict</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="River Invertebrate Classification Tool (RICT) Functional Specification">
<meta property="og:description" content="rict">
<meta name="robots" content="noindex">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">rict</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">3.1.5</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/functional-specification.html">River Invertebrate Classification Tool (RICT) Functional Specification</a>
    <a class="dropdown-item" href="../articles/tech-demo-temperature-change.html">Tech demo: Temperature change</a>
    <a class="dropdown-item" href="../articles/user-guide.html">User Guide</a>
  </div>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/aquaMetrics/rict/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">


<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>River Invertebrate Classification Tool (RICT) Functional Specification</h1>
                        <h4 data-toc-skip class="author">RICT Steering
Group</h4>
            
            <h4 data-toc-skip class="date">2023-07-06 version:
3.1.5</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/aquaMetrics/rict/blob/HEAD/vignettes/functional-specification.Rmd" class="external-link"><code>vignettes/functional-specification.Rmd</code></a></small>
      <div class="d-none name"><code>functional-specification.Rmd</code></div>
    </div>

    
    
<style>
img {
border: 0px;
outline: 0 ;
}
</style>
<p align="center" width="100%">
<img width="33%" src="images/rict_logo.png"></p>
<div class="section level2" number="1">
<h2 id="introduction">
<span class="header-section-number">1</span> Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<div class="section level3" number="1.1">
<h3 id="purpose-of-the-document">
<span class="header-section-number">1.1</span> Purpose of the
document<a class="anchor" aria-label="anchor" href="#purpose-of-the-document"></a>
</h3>
<p>The purpose of this document is to define the business, functional
and non-functional capabilities of RICT to support the design and
implementation of RICT software tool.</p>
<p>The details will be sufficient to enable the software tool to be
designed and built without having to continually refer queries to
business representatives.</p>
<p>Further, it will be of sufficient detail to provide supporting
documented information for any future RICT development.</p>
</div>
<div class="section level3" number="1.2">
<h3 id="background">
<span class="header-section-number">1.2</span> Background<a class="anchor" aria-label="anchor" href="#background"></a>
</h3>
<p>The UK Regulatory Agencies have a requirement to classify ecological
quality in rivers using data from invertebrate samples. The RIVPACS
(River InVertebrate Prediction and Classification System) model and
software tool, which was developed on behalf of the agencies by the
Freshwater Biological Association (FBA) and subsequently by the Centre
for Ecology and Hydrology (CEH), was originally used for this purpose.
It incorporates a set of summarised reference data from sites assumed to
be the best available of their type.</p>
<p>The EU Water Framework Directive (WFD) introduced in 2000, included
modifications to the regulatory requirements in relation to
classification and therefore the RIVPACS software processing tool had to
be amended.</p>
<p>The original RIVPACS software tool was written in FORTRAN and had
been developed in stages over a number of years. As a result, it was not
written in a modern programming language and did not have flexibility to
allow changes without significant cost. Therefore, a new tool was
developed that allowed future changes to be made with minimal cost in
many cases (e.g. the addition of a new index). This was the River
Invertebrate Classification Tool (RICT) version 1 which went live in
2007. This version of RICT was a web-served application which was
accessed via a website hosted by SEPA. The SEPA website also hosted
copies of the manual, guidance and background documents.</p>
<p>RICT has had some updates since 2007, including the addition of
‘split season’ classification to enable WHPT (Walley, Hawkes, Paisley
and Trigg) calculations using seasonal average EQRs (Ecological Quality
Ratio). RICT was managed and hosted by Scottish Environment Protection
Agency (SEPA) but is also used by Environment Agency (EA), Natural
Resources Wales (NRW) and Northern Ireland Environment Agency (NIEA) as
part of their regulatory and statutory requirements as well as public
users such as academic institutions.</p>
<p>However, a number of issues were identified with this version of RICT
which can be found in the outline business case produced by the scoping
project. These include improving the performance, support arrangements
and resilience as well as adding the new RIVPACS model (RIVPACS version
IV) to the RICT tool, resolving critical bugs and other additional
functionality. The full list of Critical success factors can be found in
Annex C.</p>
<p>A shortlist of options to resolve the issues was discussed which
resulted in the recommendation that RICT should adopt a Platform as a
Service arrangement and run a modified application.</p>
<p>A new cloud-based open source version of RICT was developed which
incorporated the current RIVPACS IV model and WFD status classification
and uses the same basic algorithms to provide the same final results
(other than correction of errors). Code and data tables for the new
version will be more accessible to developers who wish to further
develop RICT. This new version of RICT is called RICT version 2
(RICT2).</p>
<p>The platform chosen for RICT2 was Microsoft Azure Machine Learning
(ML) Studio with open source R programming language. Due to Azure
closing down this service, the platform moved to a ‘Shiny’ web server
hosted by Posit. This version is called RICT version 3 (RICT3). The code
was moved to an R package on Github.</p>
<p>Advanced users can create their version of R code or run the R
package locally on their machines.</p>
<p>The RICT web app and latest documentation including the technical
specification and user guide via <a href="https://rictapplications.shinyapps.io/rictapp/" class="external-link">RICT web
app</a>.</p>
</div>
</div>
<div class="section level2" number="2">
<h2 id="functional-overview">
<span class="header-section-number">2</span> Functional
Overview<a class="anchor" aria-label="anchor" href="#functional-overview"></a>
</h2>
<p>RICT is an application that implements the RIVPACS IV predictive
model. The primary requirement of the tool is to allocate WFD (Water
Framework Directive) compliant classifications to rivers with regard to
the quality of the river invertebrate community.</p>
<p>The classifications are calculated and described as H() = high, G =
good, M = moderate, P = poor or B = bad. This is achieved by comparing
sample data from a river site against sample data previously taken from
river sites considered to be the best available of their type.</p>
<p>The primary functions of the RICT tool are:</p>
<ol style="list-style-type: decimal">
<li><p><strong>Predict</strong> - Predict the value of various biotic
indices and the presence and abundance of invertebrate species, genera
or families that you would expect at any place on any stream or river in
the UK if it was not environmentally disturbed.</p></li>
<li><p><strong>Classify</strong> - Determine the Water Framework
Directive (WFD) quality status class and statistical information about
its confidence.</p></li>
<li><p><strong>Compare</strong> - Compare the statistical significance
of differences between classifications.</p></li>
</ol>
<p>It is to be capable of doing this for one or more sites at a time,
with the results provided in an output file for subsequent processing by
the relevant user.</p>
<p>The diagram below shows a diagrammatical representation of the main
functionality of the RICT tool with numbered links to more detailed
information.</p>
</div>
<div class="section level2" number="3">
<h2 id="supporting-files">
<span class="header-section-number">3</span> Supporting files<a class="anchor" aria-label="anchor" href="#supporting-files"></a>
</h2>
<p>RICT uses the RIVPACS reference data which contain sites that are
considered to be the best available of their type. The latest version of
the complete RIVPACS reference database for RICT can be downloaded from
the RICT Website:</p>
<p><a href="https://fba.org.uk/FBA/Public/Discover-and-Learn/Projects/RIVPACS-Reference-Sites-and-Reports.aspx" class="external-link uri">https://fba.org.uk/FBA/Public/Discover-and-Learn/Projects/RIVPACS-Reference-Sites-and-Reports.aspx</a></p>
<p>Within RICT, the RIVPACS reference data is not used at site level but
is used at the End Group level, where an End Group contains combined
data for sites considered to be of a similar biological composition. End
Groups are grouped up to End Group Sets (e.g. New GB – 43 Group
level).</p>
<p>As well as this data table, RICT needs other data which will be held
and used as internal data tables and R software code functions.</p>
<p>All the following files can be found within the rict package on <a href="https://github.com/aquaMetrics/rict" class="external-link">github</a>.</p>
<p>The rict code is automatically tested and compiled/built on every
update to the master branch on Github. This process is carried out by
the Github actions website, which monitors repo for any changes and
re-builds and tests the code on a Windows, Mac and Linux machine in the
cloud. It then automatically deploys updates to the web app and/or
documentation.</p>
<div class="section level3" number="3.1">
<h3 id="prediction">
<span class="header-section-number">3.1</span> Prediction<a class="anchor" aria-label="anchor" href="#prediction"></a>
</h3>
<div class="section level4" number="3.1.1">
<h4 id="support-tables">
<span class="header-section-number">3.1.1</span> Support
Tables:<a class="anchor" aria-label="anchor" href="#support-tables"></a>
</h4>
<p>These files can be found in the inst/extdat folder within the rict
package.</p>
<p><strong>Model 1 specific:</strong></p>
<ul>
<li>
<code>df-coeff-gb-685.DAT</code> – used for Discriminant score.</li>
<li>
<code>df-mean-gb-685.DAT</code> - used for calculating Mahanalobis
distance.</li>
</ul>
<p><strong>Model 44 specific:</strong></p>
<ul>
<li>
<code>discrimintant-function-coefficient-model-44.csv</code> - used
for discriminant score.</li>
<li>
<code>discrimantinant-function-model-44.csv</code> file used for
calculating Mahanalobis distance.</li>
</ul>
<p><strong>For both models:</strong></p>
<ul>
<li>
<code>air-temp-grid.csv</code> – contains previously derived
Environmental data values for the Mean Air Temperature (TEMPM) and
Temperature range (TEMPR) for points in the centres of 5km interval grid
squares. Values are used after converting the supplied NGR (or BNR) to
latitude and longitude to identify the relevant values required.</li>
<li>
<code>end-grp-assess-scores.csv</code> used for calculating
proportion during prediction.</li>
<li>
<code>TAXA_AB_APR_PRAB.csv</code> - containing abundance and
probability of abundance category for each taxon used in predicting
taxa.</li>
<li>
<code>x-103-end-group-means-formatted-jdb-17-dec-2019.csv</code> –
combined data for sites considered to be of a similar biological
composition the End Group table used in RICT is called</li>
</ul>
</div>
<div class="section level4" number="3.1.2">
<h4 id="prediction-functions">
<span class="header-section-number">3.1.2</span> Prediction
Functions:<a class="anchor" aria-label="anchor" href="#prediction-functions"></a>
</h4>
<p>Found in the <code>/R</code> package directory there are two main R
functions files for predictions:</p>
<p><code>rict-predict.R</code> - main function called to run
prediction<br><code>rict-validate.R</code> - lower level function to validate input
data <code>helper-functions.R</code> - support functions to carry out
the Environmental Variables validation</p>
<p>Prediction support functions are found:</p>
<p><code>prediction-functions.R</code><br><code>calc_temperatures.R</code></p>
</div>
</div>
<div class="section level3" number="3.2">
<h3 id="classification">
<span class="header-section-number">3.2</span> Classification<a class="anchor" aria-label="anchor" href="#classification"></a>
</h3>
<div class="section level4" number="3.2.1">
<h4 id="files-supporting">
<span class="header-section-number">3.2.1</span> Files
Supporting:<a class="anchor" aria-label="anchor" href="#files-supporting"></a>
</h4>
<ul>
<li>
<code>adjustParams_ntaxa_aspt.csv</code> - reference adjustment
values.</li>
<li>
<code>EndGrp_AssessScores.csv</code> - Excel csv used for adjusting
the expected values during classification for calculating
proportion.</li>
</ul>
<p><strong>Note</strong>, no classification is carried out on the 80
indices – carried out for Prediction only!</p>
<p>A list of the tables and functions required for the NI model
below:</p>
<ul>
<li>
<code>DFCOEFF_NI.DAT</code> file used for Discriminant score as
described in section 7.5 of this document.</li>
<li>
<code>DFMEAN_NI_RALPH.DAT</code> file used for calculating
Mahanalobis distance as described in section 7.6 of this document.j</li>
<li>
<code>EndGrp_AssessScores.csv</code> file used for calculating
proportion during prediction.</li>
</ul>
</div>
<div class="section level4" number="3.2.2">
<h4 id="classification-functions">
<span class="header-section-number">3.2.2</span> Classification
Functions:<a class="anchor" aria-label="anchor" href="#classification-functions"></a>
</h4>
<ul>
<li>
<code>classification-functions.R</code> - A large number of R code
functions used during the prediction process as described in Section
8.</li>
</ul>
</div>
<div class="section level4" number="3.2.3">
<h4 id="classification-support-files">
<span class="header-section-number">3.2.3</span> Classification
support files:<a class="anchor" aria-label="anchor" href="#classification-support-files"></a>
</h4>
<ul>
<li>
<code>adjustParams_ntaxa_aspt.csv</code> containing reference
adjustment values which are used as described in Section 8.2.</li>
<li>
<code>EndGrp_AssessScoresNI.csv</code> used for adjusting the
expected values during classification as described in Section 8.2.</li>
</ul>
<p>All source code and support files can be downloaded into R
environment for example Rstudio from Github for users who wish to amend
and create their own versions.</p>
</div>
</div>
</div>
<div class="section level2" number="4">
<h2 id="rict">
<span class="header-section-number">4</span> RICT<a class="anchor" aria-label="anchor" href="#rict"></a>
</h2>
<div class="section level3" number="4.1">
<h3 id="default-values">
<span class="header-section-number">4.1</span> Default values<a class="anchor" aria-label="anchor" href="#default-values"></a>
</h3>
<p>The list below describes the default values used:</p>
<ul>
<li>Number of Monte-Carlo simulations – 10,000</li>
<li>Index sets – all 80 indices</li>
<li>Season type – Spring, Autumn, Spring/Autumn Combined, Summer</li>
<li>Classification boundary limits – Coded as per WFD compliant values
found in the classification support files (user would need to amend the
function in this file to alter values for their own version)</li>
<li>Bias - Bias values can be provided in the input file by the user and
will be used if provided. However, if no data values for Bias or “-9”
has been entered in the input file, then the hard-coded default value of
1.62 (GB) or 0 (NI) will be used.</li>
</ul>
<p>Note that 1.62 is the default value currently being used for Bias as
this was input as the default value in the previous version of RICT as
used in SEPA for BMWP NTAXA. However, the EA uses a value of 1.68 as the
Bias value for WHPT which was based on an audit of the analytical
quality of Environment Agency laboratories. The Bias value for WHPT
should be greater than the value for BMWP for the same level of
analytical quality, because WHPT uses more taxa than BMWP. Plus WHPT
taxa also includes additional Diptera families which are less easy to
identify.</p>
</div>
<div class="section level3" number="4.2">
<h3 id="future-developments">
<span class="header-section-number">4.2</span> Future
Developments<a class="anchor" aria-label="anchor" href="#future-developments"></a>
</h3>
<p>A multi-site classification will be added to enable water bodies to
be classified from more than one site. The GIS data location checker and
delivery system and multi-site classification are currently in
development and we hope to release them in a couple of months.</p>
<p>Additional standard default to calculate the output for more specific
Index sets (e.g. for hydro-ecological evaluation) may be added later, if
the need arises.</p>
<p>Future RICT release may allow a user to run predictions and
classifications against previous classifications and RIVPACS models to
allow historical data to be analysed in a consistent way with current
monitoring data. That may include BMWP (Biological Monitoring Working
Party) classification based on RIVPACS IV (used before 2015) or RIVPACS
III+ (used 1990-1009), or using WHPT based on BMWP taxa including BMWP
composite taxa.</p>
<p>We may correct or improve features, if we need to do that, we will
run them through testing and add to this document and user guides, as
appropriate.</p>
</div>
</div>
<div class="section level2" number="5">
<h2 id="acceptance-and-validation-of-input-data">
<span class="header-section-number">5</span> Acceptance and
validation of input data<a class="anchor" aria-label="anchor" href="#acceptance-and-validation-of-input-data"></a>
</h2>
<p>In order to be able to predict and classify, the tool requires input
data in one csv file which includes:</p>
<ul>
<li>Site Identifier</li>
<li>Values for a number of Environmental Variables (e.g. NGR, slope,
discharge, etc.)</li>
<li>Values for a number of Observed Tool Indices (e.g. ASPT, NTAXA,
etc.) (only required for classification)</li>
</ul>
<p>An excel spreadsheet template will be provided for the user to enter
input data into the relevant column headings. Validation rules will be
applied to the data that has been input for each column to help the user
meet the validation requirements detailed below.</p>
<p>The input data spreadsheet template can be found in Annex A of this
document. Once completed, this spreadsheet will need to be saved as a
csv format and uploaded by the user.</p>
<div class="section level3" number="5.1">
<h3 id="environmental-variable-values-and-validation">
<span class="header-section-number">5.1</span> Environmental
Variable Values and Validation<a class="anchor" aria-label="anchor" href="#environmental-variable-values-and-validation"></a>
</h3>
<p>Environmental Variables (EV) are needed to enable the prediction
process to calculate the probability of end group membership. The values
of some Environmental Variables are provided and input by the user. The
values of other Environmental Variables have to be derived using the
values of one or more provided Environmental Variables and then
converted. The complete set of input and derived Environmental Variables
used by RICT are called Predictive Environmental Variables (PEVs).</p>
<p>The tables below refers to the Environmental Variable data required
and the data field validation for the RIVPACS IV Great Britain and
Northern Ireland Model M1 and additionally the model M44. The M1 model
requires input of 13 PEVs for Great Britain and 11 PEVs for Northern
Ireland. M44 model required 17 PEVs.</p>
<p>Input file screening will be carried out using the rules described in
the tables below when a user enters data into the input file
spreadsheet. This will be done by the conditional formatting tool within
the MS Excel ribbon to check and highlight to the user where data does
not meet validation requirements. It will highlight failures in red and
warnings in orange. However, it will not stop the user from supplying
that data to RICT for processing. When RICT processes the data, the
appropriate Fail and Warn errors will be generated as described
below.</p>
<p>Validation has also been coded into RICT for validation of the value
ranges, i.e. “all”, “gb” and “ni”.</p>
<p>Note that at least one set of the following data will be required for
each site but there may be up to three sets of data where the ‘raw’ data
is being provided for up to three years for multi-year
classification.</p>
<div class="section level5" number="5.1.0.1">
<h5 id="input-variables">
<span class="header-section-number">5.1.0.1</span> Input
variables<a class="anchor" aria-label="anchor" href="#input-variables"></a>
</h5>
<p>All input variables as well as their validation rules are listed in
the validation-rules.csv file within the package. The tables below are
generated from this file.</p>
</div>
<div class="section level5" number="5.1.0.2">
<h5 id="model-1-user-input-file">
<span class="header-section-number">5.1.0.2</span> Model 1 User
input file<a class="anchor" aria-label="anchor" href="#model-1-user-input-file"></a>
</h5>
<p>Required values (including using physical predictors) :</p>
<table class="table">
<colgroup>
<col width="4%">
<col width="23%">
<col width="8%">
<col width="36%">
<col width="14%">
<col width="12%">
</colgroup>
<thead><tr class="header">
<th align="left"></th>
<th align="left">Variable</th>
<th align="left">Units</th>
<th align="left">Description</th>
<th align="left">Type</th>
<th align="left">Optional</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">1</td>
<td align="left">SITE</td>
<td align="left"></td>
<td align="left">Site</td>
<td align="left">character</td>
<td align="left">FALSE</td>
</tr>
<tr class="even">
<td align="left">2</td>
<td align="left">WATERBODY</td>
<td align="left"></td>
<td align="left">Waterbody</td>
<td align="left">character</td>
<td align="left">TRUE</td>
</tr>
<tr class="odd">
<td align="left">3</td>
<td align="left">YEAR</td>
<td align="left"></td>
<td align="left">Year</td>
<td align="left">integer</td>
<td align="left">FALSE</td>
</tr>
<tr class="even">
<td align="left">4</td>
<td align="left">NGR</td>
<td align="left"></td>
<td align="left">National Grid Reference</td>
<td align="left">character</td>
<td align="left">FALSE</td>
</tr>
<tr class="odd">
<td align="left">5</td>
<td align="left">EASTING</td>
<td align="left">m</td>
<td align="left">Easting</td>
<td align="left">character</td>
<td align="left">FALSE</td>
</tr>
<tr class="even">
<td align="left">6</td>
<td align="left">NORTHING</td>
<td align="left">m</td>
<td align="left">Northing</td>
<td align="left">character</td>
<td align="left">FALSE</td>
</tr>
<tr class="odd">
<td align="left">7</td>
<td align="left">ALTITUDE</td>
<td align="left">m</td>
<td align="left">Altitude</td>
<td align="left">numeric</td>
<td align="left">FALSE</td>
</tr>
<tr class="even">
<td align="left">9</td>
<td align="left">SLOPE</td>
<td align="left">m/km</td>
<td align="left">Slope at site</td>
<td align="left">numeric</td>
<td align="left">FALSE</td>
</tr>
<tr class="odd">
<td align="left">11</td>
<td align="left">DISCHARGE</td>
<td align="left"></td>
<td align="left">Discharge Category</td>
<td align="left">numeric</td>
<td align="left">TRUE</td>
</tr>
<tr class="even">
<td align="left">13</td>
<td align="left">VELOCITY</td>
<td align="left">m/s</td>
<td align="left">Velocity</td>
<td align="left">numeric</td>
<td align="left">TRUE</td>
</tr>
<tr class="odd">
<td align="left">15</td>
<td align="left">DIST_FROM_SOURCE</td>
<td align="left">km</td>
<td align="left">Distance from Source</td>
<td align="left">numeric</td>
<td align="left">FALSE</td>
</tr>
<tr class="even">
<td align="left">17</td>
<td align="left">MEAN_WIDTH</td>
<td align="left">m</td>
<td align="left">Stream Width</td>
<td align="left">numeric</td>
<td align="left">FALSE</td>
</tr>
<tr class="odd">
<td align="left">19</td>
<td align="left">MEAN_DEPTH</td>
<td align="left">cm</td>
<td align="left">Stream Depth</td>
<td align="left">numeric</td>
<td align="left">FALSE</td>
</tr>
<tr class="even">
<td align="left">21</td>
<td align="left">BOULDER_COBBLES</td>
<td align="left">%</td>
<td align="left">Boulder Cobble Percentage</td>
<td align="left">numeric</td>
<td align="left">FALSE</td>
</tr>
<tr class="odd">
<td align="left">22</td>
<td align="left">PEBBLES_GRAVEL</td>
<td align="left">%</td>
<td align="left">Pebbles Gravel Percentage</td>
<td align="left">numeric</td>
<td align="left">FALSE</td>
</tr>
<tr class="even">
<td align="left">23</td>
<td align="left">SAND</td>
<td align="left">%</td>
<td align="left">Sand Percentage</td>
<td align="left">numeric</td>
<td align="left">FALSE</td>
</tr>
<tr class="odd">
<td align="left">24</td>
<td align="left">SILT_CLAY</td>
<td align="left">%</td>
<td align="left">Silt Clay Percentage</td>
<td align="left">numeric</td>
<td align="left">FALSE</td>
</tr>
<tr class="even">
<td align="left">25</td>
<td align="left">HARDNESS</td>
<td align="left">%</td>
<td align="left">Hardness</td>
<td align="left">numeric</td>
<td align="left">TRUE</td>
</tr>
<tr class="odd">
<td align="left">26</td>
<td align="left">CALCIUM</td>
<td align="left"></td>
<td align="left">Calcium Concentration</td>
<td align="left">numeric</td>
<td align="left">TRUE</td>
</tr>
<tr class="even">
<td align="left">27</td>
<td align="left">CONDUCTIVITY</td>
<td align="left"></td>
<td align="left">Electrical Conductivity</td>
<td align="left">numeric</td>
<td align="left">TRUE</td>
</tr>
<tr class="odd">
<td align="left">28</td>
<td align="left">ALKALINITY</td>
<td align="left">mg/L</td>
<td align="left">Alkalinity as CaCO3</td>
<td align="left">numeric</td>
<td align="left">FALSE</td>
</tr>
</tbody>
</table>
</div>
<div class="section level5" number="5.1.0.3">
<h5 id="model-44-input-files-using-gis-predictors">
<span class="header-section-number">5.1.0.3</span> Model 44 Input
files (using GIS predictors)<a class="anchor" aria-label="anchor" href="#model-44-input-files-using-gis-predictors"></a>
</h5>
<p>Required values:</p>
<table class="table">
<colgroup>
<col width="3%">
<col width="14%">
<col width="14%">
<col width="42%">
<col width="12%">
<col width="11%">
</colgroup>
<thead><tr class="header">
<th align="left"></th>
<th align="left">Variable</th>
<th align="left">Units</th>
<th align="left">Description</th>
<th align="left">Type</th>
<th align="left">Optional</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">1</td>
<td align="left">SITE</td>
<td align="left"></td>
<td align="left">Site</td>
<td align="left">character</td>
<td align="left">FALSE</td>
</tr>
<tr class="even">
<td align="left">2</td>
<td align="left">WATERBODY</td>
<td align="left"></td>
<td align="left">Waterbody</td>
<td align="left">character</td>
<td align="left">TRUE</td>
</tr>
<tr class="odd">
<td align="left">3</td>
<td align="left">YEAR</td>
<td align="left"></td>
<td align="left">Year</td>
<td align="left">integer</td>
<td align="left">FALSE</td>
</tr>
<tr class="even">
<td align="left">4</td>
<td align="left">ALKALINITY</td>
<td align="left">mg/L</td>
<td align="left">Alkalinity as CaCO3</td>
<td align="left">numeric</td>
<td align="left">FALSE</td>
</tr>
<tr class="odd">
<td align="left">6</td>
<td align="left">DISCH_CAT</td>
<td align="left"></td>
<td align="left">Discharge Category</td>
<td align="left">numeric</td>
<td align="left">FALSE</td>
</tr>
<tr class="even">
<td align="left">7</td>
<td align="left">PEAT</td>
<td align="left">Proportion</td>
<td align="left">Peat</td>
<td align="left">numeric</td>
<td align="left">FALSE</td>
</tr>
<tr class="odd">
<td align="left">8</td>
<td align="left">CHALK</td>
<td align="left">Proportion</td>
<td align="left">Chalk</td>
<td align="left">numeric</td>
<td align="left">FALSE</td>
</tr>
<tr class="even">
<td align="left">9</td>
<td align="left">CLAY</td>
<td align="left">Proportion</td>
<td align="left">Clay</td>
<td align="left">numeric</td>
<td align="left">FALSE</td>
</tr>
<tr class="odd">
<td align="left">10</td>
<td align="left">HARDROCK</td>
<td align="left">Proportion</td>
<td align="left">Hardrock</td>
<td align="left">numeric</td>
<td align="left">FALSE</td>
</tr>
<tr class="even">
<td align="left">11</td>
<td align="left">LIMESTONE</td>
<td align="left">Proportion</td>
<td align="left">Limestone</td>
<td align="left">numeric</td>
<td align="left">FALSE</td>
</tr>
<tr class="odd">
<td align="left">12</td>
<td align="left">LOG_AREA</td>
<td align="left">Log (km2)</td>
<td align="left">Log Area</td>
<td align="left">numeric</td>
<td align="left">FALSE</td>
</tr>
<tr class="even">
<td align="left">13</td>
<td align="left">LOGALTBAR</td>
<td align="left">m</td>
<td align="left">Mean Altitude of Catchment</td>
<td align="left">numeric</td>
<td align="left">FALSE</td>
</tr>
<tr class="odd">
<td align="left">14</td>
<td align="left">ALTITUDE</td>
<td align="left">m</td>
<td align="left">Site Altitude</td>
<td align="left">numeric</td>
<td align="left">FALSE</td>
</tr>
<tr class="even">
<td align="left">15</td>
<td align="left">D_F_SOURCE</td>
<td align="left">m</td>
<td align="left">Distance from Source</td>
<td align="left">numeric</td>
<td align="left">FALSE</td>
</tr>
<tr class="odd">
<td align="left">16</td>
<td align="left">SLOPE</td>
<td align="left">m/km</td>
<td align="left">Slope at site</td>
<td align="left">numeric</td>
<td align="left">FALSE</td>
</tr>
<tr class="even">
<td align="left">17</td>
<td align="left">SX</td>
<td align="left"></td>
<td align="left">Sampling Site X Coordinate (BNG)</td>
<td align="left">numeric</td>
<td align="left">FALSE</td>
</tr>
<tr class="odd">
<td align="left">18</td>
<td align="left">SY</td>
<td align="left"></td>
<td align="left">Sampling Site Y Coordinate (BNG)</td>
<td align="left">numeric</td>
<td align="left">FALSE</td>
</tr>
</tbody>
</table>
</div>
<div class="section level5" number="5.1.0.4">
<h5 id="optional-values">
<span class="header-section-number">5.1.0.4</span> Optional
values<a class="anchor" aria-label="anchor" href="#optional-values"></a>
</h5>
<p>Columns containing optional values must still be present in input
data file but all or some of their values may be missing (data type NA).
However, they must comply with the following notes:</p>
</div>
<div class="section level5" number="5.1.0.5">
<h5 id="model-1-optional-notes">
<span class="header-section-number">5.1.0.5</span> Model 1 Optional
notes:<a class="anchor" aria-label="anchor" href="#model-1-optional-notes"></a>
</h5>
<table class="table">
<colgroup>
<col width="4%">
<col width="18%">
<col width="76%">
</colgroup>
<thead><tr class="header">
<th align="left"></th>
<th align="left">Variable</th>
<th align="left">Optional note</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">1</td>
<td align="left">DISCHARGE</td>
<td align="left">One of DISCHARGE or VELOCITY</td>
</tr>
<tr class="even">
<td align="left">3</td>
<td align="left">VELOCITY</td>
<td align="left">One of DISCHARGE or VELOCITY</td>
</tr>
<tr class="odd">
<td align="left">5</td>
<td align="left">HARDNESS</td>
<td align="left">One of Alkalinity, Hardness, Conductivity or
Calcium</td>
</tr>
<tr class="even">
<td align="left">6</td>
<td align="left">CALCIUM</td>
<td align="left">One of Alkalinity, Hardness, Conductivity or
Calcium</td>
</tr>
<tr class="odd">
<td align="left">7</td>
<td align="left">CONDUCTIVITY</td>
<td align="left">One of Alkalinity, Hardness, Conductivity or
Calcium</td>
</tr>
<tr class="even">
<td align="left">8</td>
<td align="left">ALKALINITY</td>
<td align="left">One of Alkalinity, Hardness, Conductivity or
Calcium</td>
</tr>
</tbody>
</table>
</div>
<div class="section level5" number="5.1.0.6">
<h5 id="model-44-optional-notes">
<span class="header-section-number">5.1.0.6</span> Model 44 Optional
notes:<a class="anchor" aria-label="anchor" href="#model-44-optional-notes"></a>
</h5>
<table class="table">
<thead><tr class="header">
<th align="left">Variable</th>
<th align="left">Optional note</th>
</tr></thead>
<tbody><tr class="odd">
<td align="left">ALKALINITY</td>
<td align="left">One of Alkalinity, Hardness, Conductivity or
Calcium</td>
</tr></tbody>
</table>
</div>
<div class="section level5" number="5.1.0.7">
<h5 id="validation">
<span class="header-section-number">5.1.0.7</span> Validation<a class="anchor" aria-label="anchor" href="#validation"></a>
</h5>
<p>Warnings: Where the value of an environmental input variable exceeds
a “Warn” limit, the prediction process will continue but warning message
is created for that particular site.</p>
<p>Fails: Where the value of an environmental input variable exceeds a
“Fail” limit, the prediction process will not proceed for that
particular site and flags the transgression in a fail message.</p>
</div>
<div class="section level5" number="5.1.0.8">
<h5 id="validation-rules-for-model-1">
<span class="header-section-number">5.1.0.8</span> Validation rules
for Model 1<a class="anchor" aria-label="anchor" href="#validation-rules-for-model-1"></a>
</h5>
<table class="table">
<colgroup>
<col width="19%">
<col width="5%">
<col width="17%">
<col width="20%">
<col width="17%">
<col width="20%">
</colgroup>
<thead><tr class="header">
<th align="left">Variable</th>
<th align="left">Area</th>
<th align="right">Less than fail</th>
<th align="right">Greater than fail</th>
<th align="right">Less than warn</th>
<th align="right">Greater than warn</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">SITE</td>
<td align="left">all</td>
<td align="right">0.00</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
</tr>
<tr class="even">
<td align="left">WATERBODY</td>
<td align="left">all</td>
<td align="right">0.00</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
</tr>
<tr class="odd">
<td align="left">YEAR</td>
<td align="left">all</td>
<td align="right">0.00</td>
<td align="right">NA</td>
<td align="right">1990.0000000</td>
<td align="right">NA</td>
</tr>
<tr class="even">
<td align="left">NGR</td>
<td align="left">all</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
</tr>
<tr class="odd">
<td align="left">EASTING</td>
<td align="left">all</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
</tr>
<tr class="even">
<td align="left">NORTHING</td>
<td align="left">all</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
</tr>
<tr class="odd">
<td align="left">LATITUDE</td>
<td align="left">gb</td>
<td align="right">49.95</td>
<td align="right">60.86</td>
<td align="right">49.9978431</td>
<td align="right">60.8034893</td>
</tr>
<tr class="even">
<td align="left">LATITUDE</td>
<td align="left">ni</td>
<td align="right">54.02</td>
<td align="right">55.38</td>
<td align="right">54.0684100</td>
<td align="right">55.1995835</td>
</tr>
<tr class="odd">
<td align="left">LONGITUDE</td>
<td align="left">gb</td>
<td align="right">-7.67</td>
<td align="right">1.76</td>
<td align="right">-7.3651894</td>
<td align="right">1.3560119</td>
</tr>
<tr class="even">
<td align="left">LONGITUDE</td>
<td align="left">ni</td>
<td align="right">-8.20</td>
<td align="right">-5.43</td>
<td align="right">-8.0916181</td>
<td align="right">-5.7731300</td>
</tr>
<tr class="odd">
<td align="left">ALTITUDE</td>
<td align="left">gb</td>
<td align="right">0.00</td>
<td align="right">1345.00</td>
<td align="right">0.0000000</td>
<td align="right">590.0000000</td>
</tr>
<tr class="even">
<td align="left">ALTITUDE</td>
<td align="left">ni</td>
<td align="right">0.00</td>
<td align="right">850.00</td>
<td align="right">3.0000000</td>
<td align="right">180.0000000</td>
</tr>
<tr class="odd">
<td align="left">SLOPE</td>
<td align="left">gb</td>
<td align="right">0.00</td>
<td align="right">NA</td>
<td align="right">0.1000000</td>
<td align="right">150.0000000</td>
</tr>
<tr class="even">
<td align="left">SLOPE</td>
<td align="left">ni</td>
<td align="right">0.00</td>
<td align="right">NA</td>
<td align="right">0.1000000</td>
<td align="right">50.0000000</td>
</tr>
<tr class="odd">
<td align="left">DISCHARGE</td>
<td align="left">gb</td>
<td align="right">1.00</td>
<td align="right">10.00</td>
<td align="right">NA</td>
<td align="right">9.0000000</td>
</tr>
<tr class="even">
<td align="left">DISCHARGE</td>
<td align="left">ni</td>
<td align="right">1.00</td>
<td align="right">10.00</td>
<td align="right">NA</td>
<td align="right">8.0000000</td>
</tr>
<tr class="odd">
<td align="left">VELOCITY</td>
<td align="left">gb</td>
<td align="right">1.00</td>
<td align="right">5.00</td>
<td align="right">NA</td>
<td align="right">NA</td>
</tr>
<tr class="even">
<td align="left">VELOCITY</td>
<td align="left">ni</td>
<td align="right">1.00</td>
<td align="right">5.00</td>
<td align="right">NA</td>
<td align="right">NA</td>
</tr>
<tr class="odd">
<td align="left">DIST_FROM_SOURCE</td>
<td align="left">gb</td>
<td align="right">0.00</td>
<td align="right">NA</td>
<td align="right">0.1000000</td>
<td align="right">202.8000000</td>
</tr>
<tr class="even">
<td align="left">DIST_FROM_SOURCE</td>
<td align="left">ni</td>
<td align="right">0.00</td>
<td align="right">NA</td>
<td align="right">2.2000000</td>
<td align="right">75.0000000</td>
</tr>
<tr class="odd">
<td align="left">MEAN_WIDTH</td>
<td align="left">gb</td>
<td align="right">0.00</td>
<td align="right">NA</td>
<td align="right">0.4000000</td>
<td align="right">116.7000000</td>
</tr>
<tr class="even">
<td align="left">MEAN_WIDTH</td>
<td align="left">ni</td>
<td align="right">0.00</td>
<td align="right">NA</td>
<td align="right">2.0000000</td>
<td align="right">37.2000000</td>
</tr>
<tr class="odd">
<td align="left">MEAN_DEPTH</td>
<td align="left">gb</td>
<td align="right">0.00</td>
<td align="right">NA</td>
<td align="right">1.7000000</td>
<td align="right">300.0000000</td>
</tr>
<tr class="even">
<td align="left">MEAN_DEPTH</td>
<td align="left">ni</td>
<td align="right">0.00</td>
<td align="right">NA</td>
<td align="right">15.0000000</td>
<td align="right">183.0000000</td>
</tr>
<tr class="odd">
<td align="left">BOULDER_COBBLES</td>
<td align="left">all</td>
<td align="right">0.00</td>
<td align="right">100.00</td>
<td align="right">NA</td>
<td align="right">NA</td>
</tr>
<tr class="even">
<td align="left">PEBBLES_GRAVEL</td>
<td align="left">all</td>
<td align="right">0.00</td>
<td align="right">100.00</td>
<td align="right">NA</td>
<td align="right">NA</td>
</tr>
<tr class="odd">
<td align="left">SAND</td>
<td align="left">all</td>
<td align="right">0.00</td>
<td align="right">100.00</td>
<td align="right">NA</td>
<td align="right">NA</td>
</tr>
<tr class="even">
<td align="left">SILT_CLAY</td>
<td align="left">all</td>
<td align="right">0.00</td>
<td align="right">100.00</td>
<td align="right">NA</td>
<td align="right">NA</td>
</tr>
<tr class="odd">
<td align="left">MSUBST</td>
<td align="left">gb</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">-7.7050000</td>
<td align="right">8.0000000</td>
</tr>
<tr class="even">
<td align="left">MSUBST</td>
<td align="left">ni</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">-7.7500000</td>
<td align="right">6.6125000</td>
</tr>
<tr class="odd">
<td align="left">HARDNESS</td>
<td align="left">all</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
</tr>
<tr class="even">
<td align="left">CALCIUM</td>
<td align="left">all</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
</tr>
<tr class="odd">
<td align="left">CONDUCTIVITY</td>
<td align="left">all</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
</tr>
<tr class="even">
<td align="left">TEMPM</td>
<td align="left">gb</td>
<td align="right">0.10</td>
<td align="right">NA</td>
<td align="right">7.5000000</td>
<td align="right">11.5000000</td>
</tr>
<tr class="odd">
<td align="left">TEMPR</td>
<td align="left">gb</td>
<td align="right">0.10</td>
<td align="right">NA</td>
<td align="right">8.2100000</td>
<td align="right">13.9000000</td>
</tr>
<tr class="even">
<td align="left">ALKALINITY</td>
<td align="left">gb</td>
<td align="right">0.00</td>
<td align="right">NA</td>
<td align="right">0.7000000</td>
<td align="right">365.5000000</td>
</tr>
<tr class="odd">
<td align="left">ALKALINITY</td>
<td align="left">ni</td>
<td align="right">0.00</td>
<td align="right">NA</td>
<td align="right">2.5000000</td>
<td align="right">193.5000000</td>
</tr>
<tr class="even">
<td align="left">TOTSUB</td>
<td align="left">all</td>
<td align="right">97.00</td>
<td align="right">103.00</td>
<td align="right">NA</td>
<td align="right">NA</td>
</tr>
<tr class="odd">
<td align="left">DIST_FROM_SOURCE</td>
<td align="left">iom</td>
<td align="right">0.00</td>
<td align="right">NA</td>
<td align="right">0.1000000</td>
<td align="right">13.1000000</td>
</tr>
<tr class="even">
<td align="left">ALTITUDE</td>
<td align="left">iom</td>
<td align="right">0.00</td>
<td align="right">621.00</td>
<td align="right">0.0000000</td>
<td align="right">219.0000000</td>
</tr>
<tr class="odd">
<td align="left">SLOPE</td>
<td align="left">iom</td>
<td align="right">0.00</td>
<td align="right">NA</td>
<td align="right">0.1000000</td>
<td align="right">166.6700000</td>
</tr>
<tr class="even">
<td align="left">ALKALINITY</td>
<td align="left">iom</td>
<td align="right">0.00</td>
<td align="right">NA</td>
<td align="right">0.7000000</td>
<td align="right">126.6000000</td>
</tr>
</tbody>
</table>
<p>Model 1 Validation notes:</p>
<table class="table">
<colgroup>
<col width="6%">
<col width="93%">
</colgroup>
<thead><tr class="header">
<th align="left">Variable</th>
<th align="left">Validation notes</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">YEAR</td>
<td align="left">Warn if samples collected prior to 1990 as unlikely to
be collected using RIVPACS method</td>
</tr>
<tr class="even">
<td align="left">NGR</td>
<td align="left">Must be less than 3 letters, can be upper or lower
case</td>
</tr>
<tr class="odd">
<td align="left">EASTING</td>
<td align="left">Must be 5 digits; text not number, to retain leading
zeros (input file screening). In R Code: If less than 5 digits add
leading zeros</td>
</tr>
<tr class="even">
<td align="left">NORTHING</td>
<td align="left">Must be 5 digits; text not number, to retain leading
zeros (input file screening). In R Code: If less than 5 digits add
leading zeros</td>
</tr>
</tbody>
</table>
</div>
<div class="section level5" number="5.1.0.9">
<h5 id="validation-rules-for-model-44">
<span class="header-section-number">5.1.0.9</span> Validation rules
for Model 44<a class="anchor" aria-label="anchor" href="#validation-rules-for-model-44"></a>
</h5>
<table class="table">
<colgroup>
<col width="14%">
<col width="6%">
<col width="18%">
<col width="21%">
<col width="18%">
<col width="21%">
</colgroup>
<thead><tr class="header">
<th align="left">Variable</th>
<th align="left">Area</th>
<th align="right">Less than fail</th>
<th align="right">Greater than fail</th>
<th align="right">Less than warn</th>
<th align="right">Greater than warn</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">SITE</td>
<td align="left">all</td>
<td align="right">0.00000</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
</tr>
<tr class="even">
<td align="left">WATERBODY</td>
<td align="left">all</td>
<td align="right">0.00000</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
</tr>
<tr class="odd">
<td align="left">YEAR</td>
<td align="left">all</td>
<td align="right">0.00000</td>
<td align="right">NA</td>
<td align="right">1990.0000000</td>
<td align="right">NA</td>
</tr>
<tr class="even">
<td align="left">LATITUDE</td>
<td align="left">gb</td>
<td align="right">49.95000</td>
<td align="right">60.86000</td>
<td align="right">49.9978431</td>
<td align="right">60.8034893</td>
</tr>
<tr class="odd">
<td align="left">LATITUDE</td>
<td align="left">ni</td>
<td align="right">54.02000</td>
<td align="right">55.38000</td>
<td align="right">54.0684100</td>
<td align="right">55.1995835</td>
</tr>
<tr class="even">
<td align="left">LONGITUDE</td>
<td align="left">gb</td>
<td align="right">-7.67000</td>
<td align="right">1.76000</td>
<td align="right">-7.3651894</td>
<td align="right">1.3560119</td>
</tr>
<tr class="odd">
<td align="left">LONGITUDE</td>
<td align="left">ni</td>
<td align="right">-8.20000</td>
<td align="right">-5.43000</td>
<td align="right">-8.0916181</td>
<td align="right">-5.7731300</td>
</tr>
<tr class="even">
<td align="left">TEMPM</td>
<td align="left">gb</td>
<td align="right">0.10000</td>
<td align="right">NA</td>
<td align="right">7.5000000</td>
<td align="right">11.5000000</td>
</tr>
<tr class="odd">
<td align="left">TEMPR</td>
<td align="left">gb</td>
<td align="right">0.10000</td>
<td align="right">NA</td>
<td align="right">8.2100000</td>
<td align="right">13.9000000</td>
</tr>
<tr class="even">
<td align="left">ALKALINITY</td>
<td align="left">gb</td>
<td align="right">0.00000</td>
<td align="right">NA</td>
<td align="right">0.7000000</td>
<td align="right">366.0000000</td>
</tr>
<tr class="odd">
<td align="left">ALKALINITY</td>
<td align="left">ni</td>
<td align="right">0.00000</td>
<td align="right">NA</td>
<td align="right">0.7000000</td>
<td align="right">194.0000000</td>
</tr>
<tr class="even">
<td align="left">DISCH_CAT</td>
<td align="left">all</td>
<td align="right">1.00000</td>
<td align="right">10.00000</td>
<td align="right">NA</td>
<td align="right">9.0000000</td>
</tr>
<tr class="odd">
<td align="left">PEAT</td>
<td align="left">all</td>
<td align="right">0.00000</td>
<td align="right">1.00000</td>
<td align="right">NA</td>
<td align="right">NA</td>
</tr>
<tr class="even">
<td align="left">CHALK</td>
<td align="left">all</td>
<td align="right">0.00000</td>
<td align="right">1.00000</td>
<td align="right">NA</td>
<td align="right">NA</td>
</tr>
<tr class="odd">
<td align="left">CLAY</td>
<td align="left">all</td>
<td align="right">0.00000</td>
<td align="right">1.00000</td>
<td align="right">NA</td>
<td align="right">NA</td>
</tr>
<tr class="even">
<td align="left">HARDROCK</td>
<td align="left">all</td>
<td align="right">0.00000</td>
<td align="right">1.00000</td>
<td align="right">NA</td>
<td align="right">NA</td>
</tr>
<tr class="odd">
<td align="left">LIMESTONE</td>
<td align="left">all</td>
<td align="right">0.00000</td>
<td align="right">1.00000</td>
<td align="right">NA</td>
<td align="right">NA</td>
</tr>
<tr class="even">
<td align="left">LOG_AREA</td>
<td align="left">all</td>
<td align="right">-2.60206</td>
<td align="right">3.99875</td>
<td align="right">-0.0530000</td>
<td align="right">3.9000000</td>
</tr>
<tr class="odd">
<td align="left">LOGALTBAR</td>
<td align="left">all</td>
<td align="right">-2.81558</td>
<td align="right">3.12905</td>
<td align="right">0.1400000</td>
<td align="right">2.8600000</td>
</tr>
<tr class="even">
<td align="left">ALTITUDE</td>
<td align="left">all</td>
<td align="right">0.00000</td>
<td align="right">1346.00000</td>
<td align="right">NA</td>
<td align="right">597.0000000</td>
</tr>
<tr class="odd">
<td align="left">D_F_SOURCE</td>
<td align="left">all</td>
<td align="right">0.00000</td>
<td align="right">296037.00000</td>
<td align="right">100.0000000</td>
<td align="right">245000.0000000</td>
</tr>
<tr class="even">
<td align="left">SLOPE</td>
<td align="left">all</td>
<td align="right">0.00000</td>
<td align="right">1576.85000</td>
<td align="right">0.1000000</td>
<td align="right">142.0000000</td>
</tr>
<tr class="odd">
<td align="left">SX</td>
<td align="left">all</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
</tr>
<tr class="even">
<td align="left">SY</td>
<td align="left">all</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
</tr>
<tr class="odd">
<td align="left">LgDFS_CEH</td>
<td align="left">all</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
</tr>
<tr class="even">
<td align="left">LgSlope_CEH</td>
<td align="left">all</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
</tr>
</tbody>
</table>
<p>Model 44 validation notes:</p>
<table class="table">
<colgroup>
<col width="10%">
<col width="89%">
</colgroup>
<thead><tr class="header">
<th align="left">Variable</th>
<th align="left">Validation notes</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">YEAR</td>
<td align="left">Warn if samples collected prior to 1990 as unlikely to
be collected using RIVPACS method</td>
</tr>
<tr class="even">
<td align="left">CHALK</td>
<td align="left">Combined proportion figure for chalk, clay, hardrock
and limestone cannot be more than 1</td>
</tr>
<tr class="odd">
<td align="left">CLAY</td>
<td align="left">Combined proportion figure for chalk, clay, hardrock
and limestone cannot be more than 1</td>
</tr>
<tr class="even">
<td align="left">HARDROCK</td>
<td align="left">Combined proportion figure for chalk, clay, hardrock
and limestone cannot be more than 1</td>
</tr>
<tr class="odd">
<td align="left">LIMESTONE</td>
<td align="left">Combined proportion figure for chalk, clay, hardrock
and limestone cannot be more than 1</td>
</tr>
</tbody>
</table>
</div>
<div class="section level5" number="5.1.0.10">
<h5 id="replacement-values">
<span class="header-section-number">5.1.0.10</span> Replacement
values<a class="anchor" aria-label="anchor" href="#replacement-values"></a>
</h5>
<p>If values are provided that are zero (or close to zero) they are
replaced to avoid divide by zero errors. Specifically, variables that
are used in the RIVPACS model discriminator functions in their log form
(as you cannot take logs of zeroes):</p>
<table class="table">
<colgroup>
<col width="19%">
<col width="10%">
<col width="5%">
<col width="20%">
<col width="24%">
<col width="20%">
</colgroup>
<thead><tr class="header">
<th align="left">Variable</th>
<th align="left">Model</th>
<th align="left">Area</th>
<th align="right">Replacement value</th>
<th align="left">Replacement condition</th>
<th align="right">Replacement limit</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">ALTITUDE</td>
<td align="left">physical</td>
<td align="left">gb</td>
<td align="right">1.0</td>
<td align="left">equals</td>
<td align="right">0.0</td>
</tr>
<tr class="even">
<td align="left">ALTITUDE</td>
<td align="left">physical</td>
<td align="left">ni</td>
<td align="right">1.0</td>
<td align="left">equals</td>
<td align="right">0.0</td>
</tr>
<tr class="odd">
<td align="left">SLOPE</td>
<td align="left">physical</td>
<td align="left">gb</td>
<td align="right">0.1</td>
<td align="left">equals</td>
<td align="right">0.0</td>
</tr>
<tr class="even">
<td align="left">SLOPE</td>
<td align="left">physical</td>
<td align="left">ni</td>
<td align="right">0.1</td>
<td align="left">equals</td>
<td align="right">0.0</td>
</tr>
<tr class="odd">
<td align="left">DIST_FROM_SOURCE</td>
<td align="left">physical</td>
<td align="left">gb</td>
<td align="right">0.1</td>
<td align="left">lessthan</td>
<td align="right">0.1</td>
</tr>
<tr class="even">
<td align="left">DIST_FROM_SOURCE</td>
<td align="left">physical</td>
<td align="left">ni</td>
<td align="right">0.1</td>
<td align="left">lessthan</td>
<td align="right">0.1</td>
</tr>
<tr class="odd">
<td align="left">MEAN_WIDTH</td>
<td align="left">physical</td>
<td align="left">gb</td>
<td align="right">0.1</td>
<td align="left">lessthan</td>
<td align="right">0.1</td>
</tr>
<tr class="even">
<td align="left">MEAN_WIDTH</td>
<td align="left">physical</td>
<td align="left">ni</td>
<td align="right">0.1</td>
<td align="left">lessthan</td>
<td align="right">0.1</td>
</tr>
<tr class="odd">
<td align="left">MEAN_DEPTH</td>
<td align="left">physical</td>
<td align="left">gb</td>
<td align="right">1.0</td>
<td align="left">lessthan</td>
<td align="right">1.0</td>
</tr>
<tr class="even">
<td align="left">MEAN_DEPTH</td>
<td align="left">physical</td>
<td align="left">ni</td>
<td align="right">1.0</td>
<td align="left">lessthan</td>
<td align="right">1.0</td>
</tr>
<tr class="odd">
<td align="left">ALKALINITY</td>
<td align="left">physical</td>
<td align="left">gb</td>
<td align="right">0.1</td>
<td align="left">lessthan</td>
<td align="right">0.1</td>
</tr>
<tr class="even">
<td align="left">ALKALINITY</td>
<td align="left">physical</td>
<td align="left">ni</td>
<td align="right">0.1</td>
<td align="left">lessthan</td>
<td align="right">0.1</td>
</tr>
<tr class="odd">
<td align="left">ALKALINITY</td>
<td align="left">gis</td>
<td align="left">gb</td>
<td align="right">0.1</td>
<td align="left">lessthan</td>
<td align="right">0.1</td>
</tr>
<tr class="even">
<td align="left">ALKALINITY</td>
<td align="left">gis</td>
<td align="left">ni</td>
<td align="right">0.1</td>
<td align="left">lessthan</td>
<td align="right">0.1</td>
</tr>
<tr class="odd">
<td align="left">ALTITUDE</td>
<td align="left">gis</td>
<td align="left">all</td>
<td align="right">1.0</td>
<td align="left">equals</td>
<td align="right">0.0</td>
</tr>
<tr class="even">
<td align="left">D_F_SOURCE</td>
<td align="left">gis</td>
<td align="left">all</td>
<td align="right">100.0</td>
<td align="left">lessthan</td>
<td align="right">100.0</td>
</tr>
<tr class="odd">
<td align="left">SLOPE</td>
<td align="left">gis</td>
<td align="left">all</td>
<td align="right">0.1</td>
<td align="left">equals</td>
<td align="right">0.0</td>
</tr>
<tr class="even">
<td align="left">DIST_FROM_SOURCE</td>
<td align="left">physical</td>
<td align="left">iom</td>
<td align="right">0.1</td>
<td align="left">lessthan</td>
<td align="right">0.1</td>
</tr>
<tr class="odd">
<td align="left">ALTITUDE</td>
<td align="left">physical</td>
<td align="left">iom</td>
<td align="right">1.0</td>
<td align="left">equals</td>
<td align="right">0.0</td>
</tr>
<tr class="even">
<td align="left">SLOPE</td>
<td align="left">physical</td>
<td align="left">iom</td>
<td align="right">0.1</td>
<td align="left">equals</td>
<td align="right">0.0</td>
</tr>
<tr class="odd">
<td align="left">ALKALINITY</td>
<td align="left">physical</td>
<td align="left">iom</td>
<td align="right">0.1</td>
<td align="left">lessthan</td>
<td align="right">0.1</td>
</tr>
</tbody>
</table>
</div>
<div class="section level4" number="5.1.1">
<h4 id="validation-rules">
<span class="header-section-number">5.1.1</span> Validation
rules<a class="anchor" aria-label="anchor" href="#validation-rules"></a>
</h4>
<p>The min/max validation rules are stores in the
<code>validation-rules.csv</code>. This can be updated with new min/max
validation as required. The more complex validation rules for example
checking the presence of optional columns are hard-coded into the
<code>rict_validation()</code> function.</p>
</div>
<div class="section level4" number="5.1.2">
<h4 id="environmental-variables-validation-process">
<span class="header-section-number">5.1.2</span> Environmental
Variables Validation Process<a class="anchor" aria-label="anchor" href="#environmental-variables-validation-process"></a>
</h4>
<p>Some initial validation is done if the user (as recommended) enters
data into the input spreadsheet:</p>
<ul>
<li>Spreadsheet validation is carried out to check that the
Environmental Values are present and they are the correct format as user
enters data.</li>
</ul>
<p>The user then inputs the values into RICT and the software carries
out further validation:</p>
<p>If any columns are missing when data is imported to RICT the program
fails.</p>
<ul>
<li>Check against ‘Overall’ Valid Max/Min Values</li>
<li>Check that each provided EV value is greater than or equal to the
‘overall’ minimum value and less than or equal to the ‘overall’ maximum
value defined in the Environmental Variable parameter table above.</li>
<li>Within RICT code, if the values do not meet the validation criteria
the site is flagged as a failure and that particular site is removed
from the run.</li>
</ul>
<p>The fail limits are based on the minimum and maximum values likely in
GB or NI. Values exceeding these limits must be wrong.</p>
<ul>
<li>Check against ‘Warning’ Max/Min Values</li>
<li>Check that each provided EV value is greater than or equal to the
‘warning’ minimum value and less than or equal to the ‘warning’ maximum
value defined in the Environmental Variable parameter table above.</li>
<li>If not, then this should be recorded so that it can be flagged as a
‘warning’ in the output file but the software will proceed as
normal.</li>
</ul>
<p>The warning limits are the minimum and maximum values of the
variables in the RIVPACS reference database for reference sites included
in RIVPACS IV GB or NI. Exceedences indicate that the site is beyond the
scope of the model and may be the cause of poor suitability and they
could indicate errors. Exceeding longitude and latitude is less serious
that exceeding other parameters.</p>
</div>
</div>
<div class="section level3" number="5.2">
<h3 id="observed-biological-data-values-and-validation">
<span class="header-section-number">5.2</span> Observed Biological
Data Values and Validation<a class="anchor" aria-label="anchor" href="#observed-biological-data-values-and-validation"></a>
</h3>
<p>Biological data is needed to enable the classification process. The
values of the Biological data is provided by the user.</p>
<p>The table below refers to the data items required and the data field
validation for the RIVPACS IV Great Britain Model 1 and for the RIVPACS
IV Northern Ireland Model 1.</p>
<p>Conditional formatting validation will be carried out for all of the
validation rules described in the table below when a user enters data
into the input file spreadsheet. There is no validation for the Observed
Biological data within RICT.</p>
<p>However, RICT will validate that relevant values have been provided
from the prediction process prior to the classification process. This is
to check that there are no null values if these values are required for
the classification to be successful.</p>
<p>Note, this data will need to be entered for each season as relevant.
For WFD classification, this will be data for spring and autumn.</p>
<p>Data Item<br>
Validation<br>
Season ID</p>
<p>Season_ID must be numeric single digit code, i.e. from list:</p>
<ul>
<li>1 = spring</li>
<li>2 = summer<br>
</li>
<li>3 = autumn<br>
</li>
<li>4 = spring + summer<br>
</li>
<li>5 = spring + autumn<br>
</li>
<li>6 = summer + autumn<br>
</li>
<li>7 = spring + summer + autumn</li>
</ul>
<p>See All Indices table with new labels<br>
Must be numeric integer (i.e. whole number)<br>
Bias (Ntaxa_Bias) Must be numeric</p>
</div>
</div>
<div class="section level2" number="6">
<h2 id="conversion-of-input-environmental-variables">
<span class="header-section-number">6</span> Conversion of Input
Environmental Variables<a class="anchor" aria-label="anchor" href="#conversion-of-input-environmental-variables"></a>
</h2>
<p>The values for some input environmental variable data needs to be
converted to particular values that are required for the prediction
process. These are as follows:</p>
<ul>
<li>NGR converted to latitude and longitude</li>
<li>Calculate mean air temperature and temperature range from latitude
and longitude (GB only)</li>
<li>Calculate Mean Substratum Composition</li>
<li>Estimating Discharge Category (if unavailable) from Stream
Velocity</li>
<li>Estimating Alkalinity (if unavailable) from Hardness, Calcium or
Conductivity. In addition, some EVs then need further conversion</li>
<li>NGR convert many EVs to logarithms</li>
<li>Replace values of some EVs to prevent arithmetical problems, such as
division by zero</li>
</ul>
<p>The required conversion rules and some validation rules that need to
be applied are described below.</p>
<div class="section level3" number="6.1">
<h3 id="convert-grid-references">
<span class="header-section-number">6.1</span> Convert Grid
References<a class="anchor" aria-label="anchor" href="#convert-grid-references"></a>
</h3>
<p>Grid references consists of:</p>
<p>nat_grid_ref = 2 letters for the British National Grid (BNG) or 1
letter for the Irish grid specifying a 100km x 100km grid square</p>
<p>easting = 3 digit Easting within the 100km grid square (to nearest
100m)</p>
<p>northing = 3 digit Northing within the 100km grid square (to nearest
100m)</p>
<p>To derive latitude and longitude, the NGR input by the users is run
through <code>getLatLong()</code> in the <code>helper-functions.R</code>
file.</p>
<p>This code converts the grid references to Latitude and Longitude
WGS84 system. This co-ordinate system is required to calculate Long Term
Average Mean Temperature and Range of Air Temperature environmental
variables.</p>
<p>The specific function code used within
<code>helper-functions.R</code> is as below:</p>
<p><code>getLatLong &lt;- function(nat_grid_ref, easting, northing, coordsys_latlon, area)</code></p>
<p>where:</p>
<p><code>nat_grid_ref</code>, are the grid letter(s),
<code>easting</code> and <code>northing</code> from the user input file,
<code>coordsys_latlon</code> uses the WGS84 system as described above
and <code>area</code> is <code>gb</code> or <code>ni</code>.</p>
<p>NOte, GIS model 44 data provides Lat/Lon in BNR in SX and SY columns.
These are converted to lat and lon in the rict_validate.R function.</p>
</div>
<div class="section level3" number="6.2">
<h3 id="latitude-and-longitude-for-ni">
<span class="header-section-number">6.2</span> Latitude and
Longitude for NI<a class="anchor" aria-label="anchor" href="#latitude-and-longitude-for-ni"></a>
</h3>
<p>Same as above - <code>using area = "ni"</code> within
<code>getLatLong()</code> function.</p>
</div>
<div class="section level3" number="6.3">
<h3 id="calculate-air-temperature">
<span class="header-section-number">6.3</span> Calculate Air
Temperature<a class="anchor" aria-label="anchor" href="#calculate-air-temperature"></a>
</h3>
<p>This conversion process is only applicable to GB model sites.</p>
<p>When converting Latitude and Longitude to Long Term Average Mean
Temperature and Range of Air Temperature, RICT uses a data file
containing previously derived values for Mean air temperature and Air
temperature range for points in the centres of 5km interval grid
squares. This data file can be found in the inst/ext directory and is
called <code>air-temp-grid.csv</code>.</p>
<p>To calculate Long Term Average Mean Temperature and Range of Air
Temperature, the Latitude and Longitude previously derived is run
through <code>calc-temperatures.R</code> within the prediction support
files folder.</p>
<p>The specific function code used within
<code>calc-temperatures.R</code> is as below:</p>
<p><code>calculated_temps &lt;- calcTemps(coordinates)</code></p>
<p>where:</p>
<p>coordinates are the eastings and northings (lat, long) calculated
values as described in Section 6.1</p>
<pre><code><span><span class="co"># R version originally written by by C. Laize CEH in early 2012</span></span>
<span><span class="co"># Based on FORTRAN PROGRAM TEMPGRID</span></span>
<span><span class="co"># For QC and traceability, followed the FORTRAN code as closely as possible; not necessarily best R code</span></span>
<span><span class="co"># Converted to calc.temps function by M Dunbar, Environment Agency April 2018</span></span>
<span></span>
<span><span class="co"># Modified by T Loveday to avoid errors on east coast, Environment Agency May 2019 </span></span>
<span><span class="co"># Modified by T Loveday Environment Agency Mar 2020 to improve look and performance</span></span>
<span><span class="co">############################################</span></span>
<span></span>
<span><span class="co">#Program to calculate mean temperature and annual temperature range</span></span>
<span></span>
<span><span class="va">calc.temps</span> <span class="op">&lt;-</span> <span class="va">test1</span><span class="op">&lt;-</span><span class="kw">function</span><span class="op">(</span><span class="va">coordinates</span><span class="op">)</span><span class="op">{</span></span>
<span><span class="co"># coordinates is a data frame with three columns</span></span>
<span><span class="co"># SITE_ID</span></span>
<span><span class="co"># EASTING4</span></span>
<span><span class="co"># NORTHING4</span></span>
<span>  </span>
<span><span class="co"># this function will know about AirTempGrid because it will have been defined in the global environment just</span></span>
<span><span class="co"># before the function has been called. This isn't great programming practice, but will do for now.</span></span>
<span>  </span>
<span><span class="va">SMEAN</span><span class="op">&lt;-</span><span class="cn">NULL</span></span>
<span><span class="va">SRANGE</span><span class="op">&lt;-</span><span class="cn">NULL</span></span>
<span></span>
<span><span class="va">TempGrid_out</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">l</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">coordinates</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span><span class="co">#0</span></span>
<span><span class="kw">if</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nchar.html" class="external-link">nchar</a></span><span class="op">(</span><span class="va">coordinates</span><span class="op">$</span><span class="va">Site_ID</span><span class="op">[</span><span class="va">l</span><span class="op">]</span><span class="op">)</span><span class="op">&lt;</span><span class="fl">4</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="kw">for</span><span class="op">(</span><span class="va">z</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="op">(</span><span class="fl">4</span><span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/nchar.html" class="external-link">nchar</a></span><span class="op">(</span><span class="va">coordinates</span><span class="op">$</span><span class="va">Site_ID</span><span class="op">[</span><span class="va">l</span><span class="op">]</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">{</span></span>
<span>    <span class="va">coordinates</span><span class="op">$</span><span class="va">Site_ID</span><span class="op">[</span><span class="va">l</span><span class="op">]</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="st">"0"</span>, <span class="va">coordinates</span><span class="op">$</span><span class="va">Site_ID</span><span class="op">[</span><span class="va">l</span><span class="op">]</span>,sep<span class="op">=</span><span class="st">""</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="va">NP</span><span class="op">&lt;-</span><span class="fl">0</span></span>
<span><span class="va">subsetATG1</span> <span class="op">&lt;-</span> <span class="cn">NULL</span></span>
<span><span class="va">IGEAST</span><span class="op">&lt;-</span><span class="va">coordinates</span><span class="op">$</span><span class="va">Easting</span><span class="op">[</span><span class="va">l</span><span class="op">]</span>    <span class="co">#============================================================</span></span>
<span>                        <span class="co">#remember to change back</span></span>
<span><span class="va">IGNORTH</span><span class="op">&lt;-</span><span class="va">coordinates</span><span class="op">$</span><span class="va">Northing</span><span class="op">[</span><span class="va">l</span><span class="op">]</span>  <span class="co">#============================================================</span></span>
<span></span>
<span><span class="va">KE</span><span class="op">&lt;-</span><span class="va">IGEAST</span><span class="op">-</span><span class="fl">25</span></span>
<span><span class="va">KN</span><span class="op">&lt;-</span><span class="va">IGNORTH</span><span class="op">-</span><span class="fl">25</span></span>
<span></span>
<span><span class="co">#find nearest 5km-point to sw and distances e and n from that</span></span>
<span><span class="co">#although this point might be the below the site location as the first four are derived by adding 50 to east and nort</span></span>
<span></span>
<span><span class="va">KSQE</span><span class="op">&lt;-</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">trunc</a></span><span class="op">(</span><span class="va">KE</span><span class="op">/</span><span class="fl">50</span><span class="op">)</span><span class="op">*</span><span class="fl">50</span><span class="op">)</span><span class="op">+</span><span class="fl">25</span></span>
<span><span class="va">KSQN</span><span class="op">&lt;-</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">trunc</a></span><span class="op">(</span><span class="va">KN</span><span class="op">/</span><span class="fl">50</span><span class="op">)</span><span class="op">*</span><span class="fl">50</span><span class="op">)</span><span class="op">+</span><span class="fl">25</span></span>
<span></span>
<span><span class="va">IREME</span><span class="op">&lt;-</span><span class="va">IGEAST</span><span class="op">-</span><span class="va">KSQE</span></span>
<span><span class="va">IREMN</span><span class="op">&lt;-</span><span class="va">IGNORTH</span><span class="op">-</span><span class="va">KSQN</span></span>
<span></span>
<span><span class="va">ME1</span><span class="op">&lt;-</span><span class="va">KSQE</span></span>
<span><span class="va">ME2</span><span class="op">&lt;-</span><span class="va">ME1</span></span>
<span><span class="va">MN1</span><span class="op">&lt;-</span><span class="va">KSQN</span></span>
<span><span class="va">MN2</span><span class="op">&lt;-</span><span class="va">MN1</span></span>
<span></span>
<span><span class="co">#test if at a 5km-point or a vertical or horizontal between</span></span>
<span><span class="kw">if</span> <span class="op">(</span><span class="va">IREME</span><span class="op">==</span><span class="fl">0</span> <span class="op">&amp;</span> <span class="va">IREMN</span><span class="op">==</span><span class="fl">0</span><span class="op">)</span> <span class="op">{</span><span class="co">#1 site is coincident with a point possible on the grid</span></span>
<span>        <span class="va">subsetATG1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/subset.html" class="external-link">subset</a></span><span class="op">(</span><span class="va">AirTempGrid</span>,  <span class="va">Easting</span> <span class="op">&gt;=</span> <span class="va">ME1</span> <span class="op">&amp;</span> <span class="va">Easting</span> <span class="op">&lt;=</span> <span class="va">ME2</span> <span class="op">&amp;</span> <span class="va">Northing</span> <span class="op">&gt;=</span> <span class="va">MN1</span> <span class="op">&amp;</span> <span class="va">Northing</span> <span class="op">&lt;=</span> <span class="va">MN2</span><span class="op">)</span></span>
<span>    <span class="va">NP</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">subsetATG1</span><span class="op">)</span> ;<span class="va">SMEAN</span><span class="op">&lt;-</span><span class="va">subsetATG1</span><span class="op">$</span><span class="va">TEMPM</span> ;<span class="va">SRANGE</span><span class="op">&lt;-</span><span class="va">subsetATG1</span><span class="op">$</span><span class="va">TEMPR</span></span>
<span></span>
<span>    <span class="kw">if</span><span class="op">(</span><span class="va">NP</span><span class="op">==</span><span class="fl">1</span><span class="op">)</span><span class="op">{</span><span class="co">#2</span></span>
<span>    <span class="op">}</span> <span class="kw">else</span> <span class="op">{</span><span class="co">#2 if the point is not present in the tempgrid file the search is expanded to the surrounding 8 squares </span></span>
<span>            <span class="va">subsetATG1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/subset.html" class="external-link">subset</a></span><span class="op">(</span><span class="va">AirTempGrid</span>,  <span class="va">Easting</span> <span class="op">&gt;=</span> <span class="va">ME1</span> <span class="op">-</span><span class="fl">50</span> <span class="op">&amp;</span> <span class="va">Easting</span> <span class="op">&lt;=</span> <span class="va">ME2</span> <span class="op">+</span> <span class="fl">50</span> <span class="op">&amp;</span> <span class="va">Northing</span> <span class="op">&gt;=</span> <span class="va">MN1</span> <span class="op">-</span><span class="fl">50</span> <span class="op">&amp;</span> <span class="va">Northing</span> <span class="op">&lt;=</span> <span class="va">MN2</span> <span class="op">+</span> <span class="fl">50</span><span class="op">)</span></span>
<span>        <span class="va">NP</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">subsetATG1</span><span class="op">)</span></span>
<span>        <span class="kw">if</span><span class="op">(</span><span class="va">NP</span><span class="op">&gt;</span><span class="fl">3</span><span class="op">)</span><span class="op">{</span><span class="co">#3</span></span>
<span>        <span class="op">}</span> <span class="kw">else</span> <span class="op">{</span><span class="co">#3 if 3 of the 8 points are not present in the tempgrid file the search is expanded to the surrounding 24 squares </span></span>
<span>            <span class="va">subsetATG1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/subset.html" class="external-link">subset</a></span><span class="op">(</span><span class="va">AirTempGrid</span>,  <span class="va">Easting</span> <span class="op">&gt;=</span> <span class="va">ME1</span> <span class="op">-</span><span class="fl">100</span> <span class="op">&amp;</span> <span class="va">Easting</span> <span class="op">&lt;=</span> <span class="va">ME2</span> <span class="op">+</span> <span class="fl">100</span> <span class="op">&amp;</span> <span class="va">Northing</span> <span class="op">&gt;=</span> <span class="va">MN1</span> <span class="op">-</span><span class="fl">100</span> <span class="op">&amp;</span> <span class="va">Northing</span> <span class="op">&lt;=</span> <span class="va">MN2</span> <span class="op">+</span> <span class="fl">100</span><span class="op">)</span></span>
<span>            <span class="va">NP</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">subsetATG1</span><span class="op">)</span></span>
<span>            <span class="kw">if</span><span class="op">(</span><span class="va">NP</span><span class="op">&lt;</span><span class="fl">4</span><span class="op">)</span><span class="op">{</span><span class="va">NP</span><span class="op">&lt;-</span><span class="fl">0</span><span class="op">}</span> <span class="kw">else</span> <span class="op">{</span><span class="op">}</span><span class="co">#4</span></span>
<span>            <span class="op">}</span><span class="co">#3</span></span>
<span>        <span class="op">}</span><span class="co">#2 </span></span>
<span><span class="op">}</span> <span class="kw">else</span> <span class="op">{</span><span class="co">#1</span></span>
<span>        <span class="kw">if</span> <span class="op">(</span><span class="va">IREME</span><span class="op">==</span><span class="fl">0</span><span class="op">)</span> <span class="op">{</span><span class="co">#5 site lies on the N/S line of a point which may or may not be in the temp grid</span></span>
<span>            <span class="va">subsetATG1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/subset.html" class="external-link">subset</a></span><span class="op">(</span><span class="va">AirTempGrid</span>,  <span class="va">Easting</span> <span class="op">==</span> <span class="va">ME1</span>  <span class="op">&amp;</span> <span class="va">Northing</span> <span class="op">&gt;=</span> <span class="va">MN1</span> <span class="op">&amp;</span> <span class="va">Northing</span> <span class="op">&lt;=</span> <span class="va">MN2</span> <span class="op">+</span> <span class="fl">50</span><span class="op">)</span></span>
<span>            <span class="va">NP</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">subsetATG1</span><span class="op">)</span></span>
<span>            <span class="kw">if</span><span class="op">(</span><span class="va">NP</span><span class="op">==</span><span class="fl">2</span><span class="op">)</span><span class="op">{</span><span class="co">#6</span></span>
<span>            <span class="op">}</span> <span class="kw">else</span> <span class="op">{</span><span class="co">#6 if either point is absent the search is expanded to E and W to give a potential max no of points of 6</span></span>
<span>                <span class="va">subsetATG1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/subset.html" class="external-link">subset</a></span><span class="op">(</span><span class="va">AirTempGrid</span>,  <span class="va">Easting</span> <span class="op">&gt;=</span> <span class="va">ME1</span> <span class="op">-</span><span class="fl">50</span> <span class="op">&amp;</span> <span class="va">Easting</span> <span class="op">&lt;=</span> <span class="va">ME2</span> <span class="op">+</span> <span class="fl">50</span> <span class="op">&amp;</span> <span class="va">Northing</span> <span class="op">&gt;=</span> <span class="va">MN1</span> <span class="op">&amp;</span> <span class="va">Northing</span> <span class="op">&lt;=</span> <span class="va">MN2</span> <span class="op">+</span> <span class="fl">50</span><span class="op">)</span></span>
<span>                <span class="va">NP</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">subsetATG1</span><span class="op">)</span>    </span>
<span>                <span class="kw">if</span><span class="op">(</span><span class="va">NP</span><span class="op">&gt;</span><span class="fl">3</span><span class="op">)</span><span class="op">{</span><span class="co">#7</span></span>
<span>                <span class="op">}</span> <span class="kw">else</span> <span class="op">{</span><span class="co">#7 if less than 4 of the possible 6 points are present the search is expanded N and S to give a potential max no of points of 12</span></span>
<span>                    <span class="va">subsetATG1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/subset.html" class="external-link">subset</a></span><span class="op">(</span><span class="va">AirTempGrid</span>,  <span class="va">Easting</span> <span class="op">&gt;=</span> <span class="va">ME1</span> <span class="op">-</span><span class="fl">50</span> <span class="op">&amp;</span> <span class="va">Easting</span> <span class="op">&lt;=</span> <span class="va">ME2</span> <span class="op">+</span> <span class="fl">50</span> <span class="op">&amp;</span> <span class="va">Northing</span> <span class="op">&gt;=</span> <span class="va">MN1</span> <span class="op">-</span><span class="fl">50</span> <span class="op">&amp;</span> <span class="va">Northing</span> <span class="op">&lt;=</span> <span class="va">MN2</span> <span class="op">+</span> <span class="fl">100</span><span class="op">)</span></span>
<span>                    <span class="va">NP</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">subsetATG1</span><span class="op">)</span></span>
<span>                    <span class="kw">if</span><span class="op">(</span><span class="va">NP</span><span class="op">&lt;</span><span class="fl">4</span><span class="op">)</span><span class="op">{</span><span class="va">NP</span><span class="op">&lt;-</span><span class="fl">0</span><span class="op">}</span> <span class="kw">else</span> <span class="op">{</span><span class="op">}</span><span class="co">#8</span></span>
<span>                    <span class="op">}</span><span class="co">#7 </span></span>
<span>                <span class="op">}</span><span class="co">#6 </span></span>
<span>        <span class="op">}</span> <span class="kw">else</span> <span class="op">{</span><span class="co">#5</span></span>
<span>                <span class="kw">if</span> <span class="op">(</span><span class="va">IREMN</span><span class="op">==</span><span class="fl">0</span><span class="op">)</span> <span class="op">{</span><span class="co">#9                   </span></span>
<span>                    <span class="va">subsetATG1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/subset.html" class="external-link">subset</a></span><span class="op">(</span><span class="va">AirTempGrid</span>,  <span class="va">Easting</span> <span class="op">&gt;=</span> <span class="va">ME1</span>  <span class="op">&amp;</span> <span class="va">Easting</span> <span class="op">&lt;=</span>  <span class="va">ME2</span> <span class="op">+</span> <span class="fl">50</span> <span class="op">&amp;</span> <span class="va">Northing</span> <span class="op">&gt;=</span> <span class="va">MN1</span> <span class="op">&amp;</span> <span class="va">Northing</span> <span class="op">&lt;=</span> <span class="va">MN2</span><span class="op">)</span></span>
<span>                    <span class="va">NP</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">subsetATG1</span><span class="op">)</span></span>
<span>                    <span class="kw">if</span><span class="op">(</span><span class="va">NP</span><span class="op">==</span><span class="fl">2</span><span class="op">)</span><span class="op">{</span><span class="co">#10                       </span></span>
<span>                    <span class="op">}</span> <span class="kw">else</span> <span class="op">{</span><span class="co">#10</span></span>
<span>                        <span class="va">subsetATG1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/subset.html" class="external-link">subset</a></span><span class="op">(</span><span class="va">AirTempGrid</span>,  <span class="va">Easting</span> <span class="op">&gt;=</span> <span class="va">ME1</span>  <span class="op">&amp;</span> <span class="va">Easting</span> <span class="op">&lt;=</span>  <span class="va">ME2</span> <span class="op">+</span> <span class="fl">50</span> <span class="op">&amp;</span> <span class="va">Northing</span> <span class="op">&gt;=</span> <span class="va">MN1</span> <span class="op">-</span><span class="fl">50</span> <span class="op">&amp;</span> <span class="va">Northing</span> <span class="op">&lt;=</span> <span class="va">MN2</span> <span class="op">+</span><span class="fl">50</span><span class="op">)</span></span>
<span>                        <span class="va">NP</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">subsetATG1</span><span class="op">)</span></span>
<span>                        <span class="kw">if</span><span class="op">(</span><span class="va">NP</span><span class="op">&gt;</span><span class="fl">3</span><span class="op">)</span><span class="op">{</span><span class="co">#11</span></span>
<span>                        <span class="op">}</span> <span class="kw">else</span> <span class="op">{</span><span class="co">#11</span></span>
<span>                        <span class="va">subsetATG1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/subset.html" class="external-link">subset</a></span><span class="op">(</span><span class="va">AirTempGrid</span>,  <span class="va">Easting</span> <span class="op">&gt;=</span> <span class="va">ME1</span> <span class="op">-</span><span class="fl">50</span>  <span class="op">&amp;</span> <span class="va">Easting</span> <span class="op">&lt;=</span>  <span class="va">ME2</span> <span class="op">+</span> <span class="fl">100</span> <span class="op">&amp;</span> <span class="va">Northing</span> <span class="op">&gt;=</span> <span class="va">MN1</span> <span class="op">-</span><span class="fl">50</span> <span class="op">&amp;</span> <span class="va">Northing</span> <span class="op">&lt;=</span> <span class="va">MN2</span> <span class="op">+</span><span class="fl">50</span><span class="op">)</span></span>
<span>                        <span class="va">NP</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">subsetATG1</span><span class="op">)</span></span>
<span>                        <span class="kw">if</span><span class="op">(</span><span class="va">NP</span><span class="op">&lt;</span><span class="fl">4</span><span class="op">)</span><span class="op">{</span><span class="va">NP</span><span class="op">&lt;-</span><span class="fl">0</span><span class="op">}</span> <span class="kw">else</span> <span class="op">{</span><span class="op">}</span><span class="co">#12</span></span>
<span>                            <span class="op">}</span><span class="co">#11</span></span>
<span>                        <span class="op">}</span><span class="co">#10</span></span>
<span>                <span class="op">}</span> <span class="kw">else</span> <span class="op">{</span><span class="co">#9</span></span>
<span>                        <span class="co">#must interpolate between 4 values if none of the above is satisfied</span></span>
<span>                        <span class="va">subsetATG1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/subset.html" class="external-link">subset</a></span><span class="op">(</span><span class="va">AirTempGrid</span>,  <span class="va">Easting</span> <span class="op">&gt;=</span> <span class="va">ME1</span>  <span class="op">&amp;</span> <span class="va">Easting</span> <span class="op">&lt;=</span>  <span class="va">ME2</span> <span class="op">+</span> <span class="fl">50</span> <span class="op">&amp;</span> <span class="va">Northing</span> <span class="op">&gt;=</span> <span class="va">MN1</span> <span class="op">&amp;</span> <span class="va">Northing</span> <span class="op">&lt;=</span> <span class="va">MN2</span> <span class="op">+</span><span class="fl">50</span><span class="op">)</span></span>
<span>                        <span class="va">NP</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">subsetATG1</span><span class="op">)</span></span>
<span>                        <span class="kw">if</span><span class="op">(</span><span class="va">NP</span><span class="op">&gt;</span><span class="fl">2</span><span class="op">)</span> <span class="op">{</span><span class="co">#13</span></span>
<span>                        <span class="op">}</span> <span class="kw">else</span> <span class="op">{</span><span class="co">#13</span></span>
<span>                                <span class="va">subsetATG1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/subset.html" class="external-link">subset</a></span><span class="op">(</span><span class="va">AirTempGrid</span>,  <span class="va">Easting</span> <span class="op">&gt;=</span> <span class="va">ME1</span> <span class="op">-</span><span class="fl">50</span>  <span class="op">&amp;</span> <span class="va">Easting</span> <span class="op">&lt;=</span>  <span class="va">ME2</span> <span class="op">+</span> <span class="fl">100</span> <span class="op">&amp;</span> <span class="va">Northing</span> <span class="op">&gt;=</span> <span class="va">MN1</span> <span class="op">-</span><span class="fl">50</span> <span class="op">&amp;</span> <span class="va">Northing</span> <span class="op">&lt;=</span> <span class="va">MN2</span> <span class="op">+</span><span class="fl">100</span><span class="op">)</span></span>
<span>                                <span class="va">NP</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">subsetATG1</span><span class="op">)</span></span>
<span>                                <span class="kw">if</span><span class="op">(</span><span class="va">NP</span><span class="op">&lt;</span><span class="fl">4</span><span class="op">)</span><span class="op">{</span></span>
<span>                                    <span class="va">NP</span><span class="op">&lt;-</span><span class="fl">0</span></span>
<span>                                    <span class="op">}</span> <span class="kw">else</span> <span class="op">{</span><span class="op">}</span><span class="co">#14    </span></span>
<span>                            <span class="op">}</span><span class="co">#13</span></span>
<span>                    <span class="op">}</span><span class="co">#9 </span></span>
<span>            <span class="op">}</span><span class="co">#5</span></span>
<span>    <span class="op">}</span><span class="co">#1</span></span>
<span><span class="co">#write.csv(subsetATG1 ,"Subset.csv", row.names = FALSE, append = FALSE)</span></span>
<span><span class="kw">if</span><span class="op">(</span><span class="va">NP</span><span class="op">==</span><span class="fl">0</span><span class="op">)</span><span class="op">{</span></span>
<span>    <span class="va">smean</span><span class="op">&lt;-</span><span class="fl">0</span></span>
<span>    <span class="va">srange</span><span class="op">&lt;-</span><span class="fl">0</span></span>
<span>    <span class="op">}</span><span class="kw">else</span><span class="op">{</span></span>
<span>    <span class="kw">if</span><span class="op">(</span><span class="va">NP</span><span class="op">==</span><span class="fl">1</span><span class="op">)</span><span class="op">{</span> </span>
<span>        <span class="va">smean</span><span class="op">&lt;-</span> <span class="va">subsetATG1</span><span class="op">$</span><span class="va">TEMPM</span></span>
<span>        <span class="va">srange</span><span class="op">&lt;-</span> <span class="va">subsetATG1</span><span class="op">$</span><span class="va">TEMPR</span></span>
<span>        <span class="op">}</span><span class="kw">else</span><span class="op">{</span></span>
<span>        <span class="va">subsetATG1</span><span class="op">$</span><span class="va">D</span><span class="op">&lt;-</span><span class="op">(</span><span class="va">subsetATG1</span><span class="op">$</span><span class="va">Easting</span><span class="op">-</span><span class="op">(</span><span class="va">KE</span><span class="op">+</span><span class="fl">25</span><span class="op">)</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span><span class="op">+</span><span class="op">(</span><span class="va">subsetATG1</span><span class="op">$</span><span class="va">Northing</span><span class="op">-</span><span class="op">(</span><span class="va">KN</span><span class="op">+</span><span class="fl">25</span><span class="op">)</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span></span>
<span>        <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="va">subsetATG1</span><span class="op">$</span><span class="va">D</span><span class="op">!=</span><span class="fl">0.000000</span>, <span class="va">subsetATG1</span><span class="op">$</span><span class="va">DS</span><span class="op">&lt;-</span><span class="fl">1</span><span class="op">/</span><span class="va">subsetATG1</span><span class="op">$</span><span class="va">D</span>, <span class="va">subsetATG1</span><span class="op">$</span><span class="va">DS</span><span class="op">&lt;-</span><span class="fl">0.01</span><span class="op">)</span></span>
<span>        <span class="va">smean</span><span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">subsetATG1</span><span class="op">$</span><span class="va">TEMPM</span><span class="op">/</span><span class="va">subsetATG1</span><span class="op">$</span><span class="va">D</span><span class="op">)</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">subsetATG1</span><span class="op">$</span><span class="va">DS</span><span class="op">)</span></span>
<span>        <span class="va">srange</span><span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">subsetATG1</span><span class="op">$</span><span class="va">TEMPR</span><span class="op">/</span><span class="va">subsetATG1</span><span class="op">$</span><span class="va">D</span><span class="op">)</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">subsetATG1</span><span class="op">$</span><span class="va">DS</span><span class="op">)</span></span>
<span>        <span class="op">}</span></span>
<span>    <span class="op">}</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="va">coordinates</span><span class="op">[</span><span class="va">l</span>,<span class="fl">1</span><span class="op">]</span>,<span class="va">NP</span>, <span class="va">smean</span>, <span class="va">srange</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">TempGrid_out</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span><span class="va">TempGrid_out</span>, <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">coordinates</span><span class="op">[</span><span class="va">l</span>,<span class="op">]</span>, <span class="va">smean</span>, <span class="va">srange</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span><span class="co">#0</span></span>
<span><span class="va">TempGrid_out</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="va">TempGrid_out</span><span class="op">)</span></span>
<span><span class="co">#write.csv(TempGrid_out,"TempGrid.csv", row.names = FALSE, append = TRUE)</span></span>
<span><span class="op">}</span></span></code></pre>
<p>The temperature grid below is used to obtain mean air temperature and
mean air temperature range for RICT predictions. The dots represent
points on the existing temperature grid if the site has exactly the same
coordinates as the centre point</p>
<p><strong>Key</strong></p>
<p><code>0</code> Available data point<br><code>1</code> Data point included in the sample<br><code>5</code> Nearest point on the existing temperature grid to the
site</p>
<ol style="list-style-type: decimal">
<li>If the site has exactly the same coordinates as the centre
point</li>
</ol>
<p>If the point has exactly the same coordinates as the centre point it
samples only the centre point to provide the temperature mean and range
if that point exists in the dataset:</p>
<pre><code>0 0 0 0 0  
0 0 0 0 0  
0 0 1 0 0  
0 0 0 0 0  
0 0 0 0 0 </code></pre>
<p>If the centre point doesn’t exist in the above example then the
surrounding 8 points are sampled, if more than 4 of the 8 pts are
present within the dataset a value is returned:</p>
<pre><code>0 0 0 0 0   
0 1 1 1 0   
0 1 5 5 5   
0 1 1 5 5   
0 0 0 0 0   </code></pre>
<p>If the above condition is not satisfied then the sampling is expanded
to include the adjacent points, if at least 5 of the 24 possible points
are available a result is returned - if less than 5 no result is
returned:</p>
<pre><code>1 1 1 1 1     
1 1 5 5 5 
1 1 5 5 5  
1 1 5 5 5   
1 1 1 1 1   </code></pre>
<ol start="2" style="list-style-type: decimal">
<li>If the site lies exactly on the N/S line of the centre point</li>
</ol>
<p>If the point lies exactly on the N/S line of the centre point then
the nearest point and the one above are sampled if both points are
present in the dataset:</p>
<pre><code>0 0 0 0 0   
0 0 1 0 0   
0 0 1 0 0   
0 0 0 0 0   
0 0 0 0 0   </code></pre>
<p>If one of the two points above is not present in the dataset then the
two either side are also sampled, if more than three points are present
a result is returned:</p>
<pre><code>0 0 0 0 0  
0 1 5 1 0  
0 1 1 1 0  
0 0 0 0 0  
0 0 0 0 0  </code></pre>
<p>If less than 4 of the 6 points above are present in the dataset then
the three above and below are also sampled if that at least 4 of the 12
are present a result is returned:</p>
<pre><code>0 1 1 1 0  
0 1 5 5 0  
0 1 1 5 0  
0 1 1 1 0  
0 0 0 0 0  </code></pre>
<ol start="3" style="list-style-type: decimal">
<li>if the site lies exactly on the E/W line of the centre point</li>
</ol>
<p>If the point lies exactly on the E/W line of the centre point then
the nearest point and the east of it will be sampled if both points are
present in the dataset:</p>
<pre><code>0 0 0 0 0  
0 0 0 0 0  
0 0 1 1 0  
0 0 0 0 0  
0 0 0 0 0  </code></pre>
<p>If one of the two pointts above are not present in the dataset then
the two either side are also sampled, if more than three points are
present a result is returned:</p>
<pre><code>0 0 0 0 0  
0 0 1 1 0  
0 0 1 1 0  
0 0 1 1 0  
0 0 0 0 0   </code></pre>
<p>If less than 4 of the 6 points above are present in the dataset then
the three east and west are also sampled assuming that at least 4 of the
12 are present:</p>
<pre><code>0 0 0 0 0  
0 1 5 5 1   
0 1 1 5 1   
0 1 1 1 1   
0 0 0 0 0  </code></pre>
<ol start="4" style="list-style-type: decimal">
<li>If none of the above are satisfied - the majority of sites. The site
is not coincident with any point or the n/s or e/w line of any
point.</li>
</ol>
<p>Interpolates between four values, 3 of the 4 points must be present
to return a value:</p>
<pre><code>0 0 0 0 0  
0 0 1 1 0  
0 0 1 1 0  
0 0 0 0 0  
0 0 0 0 0  </code></pre>
<p>If the above is not satisfied then the sampling is expanded to take
in 16 points of which 5 or more must be present:</p>
<pre><code>0 1 1 1 1  
0 1 1 5 5     
0 1 1 5 5    
0 1 1 1 1  
0 0 0 0 0  </code></pre>
</div>
<div class="section level3" number="6.4">
<h3 id="calculating-mean-substratum-composition">
<span class="header-section-number">6.4</span> Calculating Mean
Substratum Composition<a class="anchor" aria-label="anchor" href="#calculating-mean-substratum-composition"></a>
</h3>
<p>MSUBST (in phi units) is derived from the following user-supplied
environmental variables from the input file for the river bed substratum
composition observed at the sampling site:</p>
<pre><code>BOULDER_COBBLES = percentage cover of Boulders/Cobbles  
PEBBLES_GRAVEL  = percentage cover of Pebbles/Gravel  
*SAND   = percentage cover of sand  
*SILT_CLAY  = percentage cover of silt/clay  </code></pre>
<p>The Algorithm used is:</p>
<pre><code><span><span class="va">TOTSUB</span> <span class="op">=</span> <span class="va">BOULDER_COBBLES</span> <span class="op">+</span> <span class="va">PEBBLES_GRAVEL</span> <span class="op">+</span> <span class="va">SAND</span> <span class="op">+</span> <span class="va">SILT_CLAY</span></span>
<span><span class="va">MSUBST</span> <span class="op">=</span> <span class="op">(</span> <span class="op">-</span><span class="fl">7.75</span><span class="op">*</span><span class="va">BOULDER_COBBLES</span> <span class="op">-</span> <span class="fl">3.25</span><span class="op">*</span><span class="va">PEBBLES_GRAVEL</span> <span class="op">+</span> <span class="fl">2</span><span class="op">*</span><span class="va">SAND</span> <span class="op">+</span> <span class="fl">8</span><span class="op">*</span><span class="va">SILT_CLAY</span> <span class="op">)</span> <span class="op">/</span> <span class="va">TOTSUB</span></span></code></pre>
<p>The specific function code <code>get_substrate</code> used can be
found within helper-functions.R</p>
</div>
<div class="section level3" number="6.5">
<h3 id="estimating-discharge-category">
<span class="header-section-number">6.5</span> Estimating Discharge
Category<a class="anchor" aria-label="anchor" href="#estimating-discharge-category"></a>
</h3>
<p>If a value for discharge category (DCH) is not supplied by the user
for the test site, it is to be estimated from a measurement of surface
water velocity category (VEL) supplied by the user. If neither value is
provided then an error will be recorded against the site and prediction
and classification should not take place for that site.</p>
<p>The conversion from user-supplied velocity category (VEL) to
discharge category (DCH) is done by:</p>
<ol style="list-style-type: decimal">
<li>Converting the velocity category (VEL) to an estimate of some sort
of mid- or typical actual velocity</li>
</ol>
<table class="table">
<colgroup>
<col width="28%">
<col width="32%">
<col width="38%">
</colgroup>
<thead><tr class="header">
<th align="left">Velocity category VELC(VEL)</th>
<th align="left">Velocity Category(VEL) (cm.s<sup>-1</sup>)</th>
<th align="left">Mid-range estimate VELC(VEL) (cm.s<sup>-1</sup>)</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">1</td>
<td align="left">≤10</td>
<td align="left">5</td>
</tr>
<tr class="even">
<td align="left">2</td>
<td align="left">&gt;10 – 25</td>
<td align="left">17.5</td>
</tr>
<tr class="odd">
<td align="left">3</td>
<td align="left">&gt;25 – 50</td>
<td align="left">37.5</td>
</tr>
<tr class="even">
<td align="left">4</td>
<td align="left">&gt;50 – 100</td>
<td align="left">75</td>
</tr>
<tr class="odd">
<td align="left">5</td>
<td align="left">&gt;100</td>
<td align="left">150</td>
</tr>
</tbody>
</table>
<ol start="2" style="list-style-type: decimal">
<li><p>Then use the equation
<code>RDCH = DEPTH/100 * WIDTH * VELC(VEL)/100</code> to convert the
estimated velocity VELC(VEL) into an estimated actual mean discharge
RDCH in cumecs</p></li>
<li><p>Finally, assign the estimated discharge RDCH to the appropriate
discharge category DCH based on the discharge category upper limits
below</p></li>
</ol>
<table class="table">
<thead><tr class="header">
<th align="left">Discharge Category DCH</th>
<th align="left">Mean annual discharge RDCH(m3.s<sup>-1</sup> =
cumecs)</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">1</td>
<td align="left">&lt; 0.31</td>
</tr>
<tr class="even">
<td align="left">2</td>
<td align="left">0.31 - 0.62</td>
</tr>
<tr class="odd">
<td align="left">3</td>
<td align="left">0.62 - 1.25</td>
</tr>
<tr class="even">
<td align="left">4</td>
<td align="left">1.25 - 2.50</td>
</tr>
<tr class="odd">
<td align="left">5</td>
<td align="left">2.50 - 5.00</td>
</tr>
<tr class="even">
<td align="left">6</td>
<td align="left">5.00 - 10.00</td>
</tr>
<tr class="odd">
<td align="left">7</td>
<td align="left">10.00 - 20.0</td>
</tr>
<tr class="even">
<td align="left">8</td>
<td align="left">20.00 - 40.0</td>
</tr>
<tr class="odd">
<td align="left">9</td>
<td align="left">40.00 - 80.0</td>
</tr>
<tr class="even">
<td align="left">10</td>
<td align="left">&gt;80</td>
</tr>
</tbody>
</table>
<p>The FORTRAN algorithm for estimating DCH from Stream Velocity is:</p>
<pre><code>DATA cdch / 0.31, 0.62, 1.25, 2.5, 5.0, 10.0, 20.0, 40.0, 80.0 /  
CDCH(1) = 0.31  
CDCH(2) = 0.62  
CDCH(3) = 1.25  
CDCH(4) = 2.50  
CDCH(5) = 5.0  
CDCH(6) = 10.0  
CDCH(7) = 20.0  
CDCH(8) = 40.0  
CDCH(9) = 80.0  
  
VELC(1) = 5.0  
VELC(2) = 17.5  
VELC(3) = 37.5  
VELC(1) = 75.0  
VELC(1) = 150.0  
RDCH = DEPTH/100. * WIDTH * VELC(VEL)/100  
K=10  
REPEAT    
DCH=K  
K=K-1  
UNTIL RDCH&gt;CDCH(K)`</code></pre>
<p>The specific function code is <code>get_discharge()</code> used can
be found within helper-functions.R.</p>
</div>
<div class="section level3" number="6.6">
<h3 id="estimating-alkalinity">
<span class="header-section-number">6.6</span> Estimating
Alkalinity<a class="anchor" aria-label="anchor" href="#estimating-alkalinity"></a>
</h3>
<p>If a value for alkalinity (ALK) is not supplied by the user for the
test site, then it is to be assumed that alkalinity is to be estimated
from, in order of preference, the user-supplied values for either water
hardness (HARD), calcium concentration (CALCIUM) or conductivity
(CONDUCT).</p>
<p>If none of these values are provided then an error should be recorded
against the site and prediction and classification should not then take
place for that site.</p>
<p>The algorithm for estimating Alkalinity from the other values is:</p>
<pre><code>IF HARD is provided THEN  
ALK = 4.677 + 0.6393*HARD  sudo apt install font-manager
ELSE  
IF CALCIUM is provided THEN  
ALK = 14.552 + 1.7606*CALCIUM  
ELSE  
IF CONDUCT is provided THEN  
ALK = 0.3201*CONDUCT -8.0593</code></pre>
<p>The specific helper function is <code>get_alkalinity()</code>.</p>
</div>
<div class="section level3" number="6.7">
<h3 id="transform-environmental-variables">
<span class="header-section-number">6.7</span> Transform
Environmental Variables<a class="anchor" aria-label="anchor" href="#transform-environmental-variables"></a>
</h3>
<p>Some environmental predictor variables are used in discriminant
functions in a logarithm to base10 transformed form (denoted Log10).
They, therefore, need to be converted prior to prediction.</p>
<p>The discriminant functions for the Great Britain (GB) model
(Reference end group set 1) use 13 environmental predictor variables
(i.e. vN = 13), as detailed below.</p>
<p>The Northern Ireland (NI) model (Reference end group set 2) uses the
same set of variables apart from air temperature mean (TEMPM) and air
temperature range (TEMPR), which were not available for Northern Ireland
and probably would not add discriminatory power within this relatively
small geographic region.</p>
<p>For the purposes of specifying the discriminant functions and
inputting their coefficients (DFCoeff<sub>v,d</sub>), RICT will have a
<code>helper-functions.R</code> file (among the support files) for the
Northern Ireland model.</p>
<p>Some of the environmental predictor variables are used in the
discriminant functions in a logarithm to base 10 transformed form
(denoted Log<sub>10</sub>), as detailed below.</p>
<p>Specific functions within the <code>helper-functions.R</code> will do
the conversions as described in Sections 6.1 – 6.6 above and will also
calculate to log base 10 for any Environmental variables that require
Log Base 10 form.</p>
<p>The precise order and form of the environmental variables to be used
as Env 1– Env<sub>vN</sub> in the discrimination functions equations
used to calculate the discriminant function axis scores (DFScore) is as
follows:</p>
<table class="table">
<colgroup>
<col width="3%">
<col width="16%">
<col width="17%">
<col width="33%">
<col width="11%">
<col width="19%">
</colgroup>
<thead><tr class="header">
<th align="left"></th>
<th align="left">EV</th>
<th align="left">User input</th>
<th align="left">Environmental predictor variable</th>
<th align="left">Derived</th>
<th align="left">Use in log10 form?</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">1</td>
<td align="left">ENV 1</td>
<td align="left">LATITUDE</td>
<td align="left">Latitude</td>
<td align="left">calculated</td>
<td align="left">FALSE</td>
</tr>
<tr class="even">
<td align="left">3</td>
<td align="left">ENV 2</td>
<td align="left">LONGITUDE</td>
<td align="left">Longitude</td>
<td align="left">calculated</td>
<td align="left">FALSE</td>
</tr>
<tr class="odd">
<td align="left">5</td>
<td align="left">ENV 3</td>
<td align="left">ALTITUDE</td>
<td align="left">Altitude</td>
<td align="left">input</td>
<td align="left">TRUE</td>
</tr>
<tr class="even">
<td align="left">8</td>
<td align="left">ENV 4</td>
<td align="left">DIST_FROM_SOURCE</td>
<td align="left">Distance from Source</td>
<td align="left">input</td>
<td align="left">TRUE</td>
</tr>
<tr class="odd">
<td align="left">11</td>
<td align="left">ENV 5</td>
<td align="left">MEAN_WIDTH</td>
<td align="left">Stream Width</td>
<td align="left">input</td>
<td align="left">TRUE</td>
</tr>
<tr class="even">
<td align="left">13</td>
<td align="left">ENV 6</td>
<td align="left">MEAN_DEPTH</td>
<td align="left">Stream Depth</td>
<td align="left">input</td>
<td align="left">TRUE</td>
</tr>
<tr class="odd">
<td align="left">15</td>
<td align="left">ENV 7</td>
<td align="left">MSUBST</td>
<td align="left">Mean Substratum</td>
<td align="left">calculated</td>
<td align="left">FALSE</td>
</tr>
<tr class="even">
<td align="left">17</td>
<td align="left">ENV 8</td>
<td align="left">DISCHARGE</td>
<td align="left">Discharge Category</td>
<td align="left">input</td>
<td align="left">FALSE</td>
</tr>
<tr class="odd">
<td align="left">19</td>
<td align="left">ENV 9 &amp; ENV 10*</td>
<td align="left">ALKALINITY</td>
<td align="left">Alkalinity as CaCO3</td>
<td align="left">input</td>
<td align="left">TRUE</td>
</tr>
<tr class="even">
<td align="left">22</td>
<td align="left">ENV 11</td>
<td align="left">SLOPE</td>
<td align="left">Slope at site</td>
<td align="left">input</td>
<td align="left">TRUE</td>
</tr>
<tr class="odd">
<td align="left">25</td>
<td align="left">ENV 12</td>
<td align="left">TEMPM</td>
<td align="left">Air Mean Temperature</td>
<td align="left">calculated</td>
<td align="left">FALSE</td>
</tr>
<tr class="even">
<td align="left">26</td>
<td align="left">ENV 13</td>
<td align="left">TEMPR</td>
<td align="left">Air Temperature Range</td>
<td align="left">calculated</td>
<td align="left">FALSE</td>
</tr>
</tbody>
</table>
<p>** Alkalinity is involved in the discriminant functions in both
untransformed form (as Env9) and in log transformed form (as Env10) to
represent its non-linear impact on the biota.</p>
<p>This table also shows which EVs are supplied by the user in the input
file and which EVs are internally derived by RICT conversions.</p>
</div>
<div class="section level3" number="6.8">
<h3 id="validation-of-derived-environmental-variables">
<span class="header-section-number">6.8</span> Validation of Derived
Environmental Variables<a class="anchor" aria-label="anchor" href="#validation-of-derived-environmental-variables"></a>
</h3>
<p>Whenever the value of an Environmental variable is derived from any
conversion applied, it needs to be validated against the various max/min
values. There are two distinct max/min values; Fail and Warn and the
required validation is as detailed previously in section 5.</p>
<p>Once all the conversion processing has been carried out, then this
should result in a value being present for every required Environmental
variable. This complete set of Environmental variables is called the
Predictive Environmental Variables (PEVS).</p>
</div>
</div>
<div class="section level2" number="7">
<h2 id="prediction-1">
<span class="header-section-number">7</span> Prediction<a class="anchor" aria-label="anchor" href="#prediction-1"></a>
</h2>
<div class="section level3" number="7.1">
<h3 id="prediction-process">
<span class="header-section-number">7.1</span> Prediction
Process<a class="anchor" aria-label="anchor" href="#prediction-process"></a>
</h3>
<p>The prediction functionality involves four distinct steps:</p>
<ol style="list-style-type: lower-alpha">
<li>determine the probability of end group membership<br>
</li>
<li>determine Environmental Suitability<br>
</li>
<li>based on a), determine the predicted index values for the indices
relevant to the run<br>
</li>
<li>based on a), determine the predicted taxa to be present at the
site</li>
</ol>
<p>The most complex part of this is a), which involves the use of
multiple discriminant analysis and specialised statistical techniques
(e.g. Mahanalobis Distance).</p>
<p>It needs to be carried out for every set of site data applicable to
the run (a site may be present more than once where more than one years’
worth of environmental data has been provided).</p>
<p>The flow diagram below summarises the prediction process and
calculations (including the data input, validation, conversion and
transform steps described above) as well as identifying the relevant
section for further information from the WFD72C final report:</p>
<p><img src="images/rict-prediction.png"></p>
</div>
<div class="section level3" number="7.2">
<h3 id="prediction-overview">
<span class="header-section-number">7.2</span> Prediction
Overview<a class="anchor" aria-label="anchor" href="#prediction-overview"></a>
</h3>
<p>The probability of a site belonging to an End Group is determined by
the similarity of its Environmental Variables (EVs) to those of the
relevant End Group.</p>
<p>Due to the multivariate nature of the environmental variable data,
Multiple Discriminant Analysis (MDA) is used to turn the environmental
variable data into a format that can be used to discriminate between the
end groups.</p>
<p>MDA depends on multiple Discriminant Functions (DF). A Discriminant
Function has the general format:-</p>
<pre><code><span><span class="va">Z</span> <span class="op">=</span> <span class="va">constant</span> <span class="op">+</span> <span class="va">c1EV1</span> <span class="op">+</span> <span class="va">c2EV2</span> <span class="op">+</span> <span class="va">c3EV3</span> <span class="op">+</span> <span class="va">...</span> <span class="op">+</span> <span class="va">cnEVn</span></span></code></pre>
<p>where Z is the Discriminant Score (DS) for that particular
discriminant function, c1…cn are the coefficients of that discriminant
function and EV1…EVn are the values of the environmental variables.</p>
<p>A DF is a linear combination of the EVs and the coefficients, which
maximises the separation in data space of the end groups. In other
words, if the discriminant function was solved for the mean values of
the environmental variables of each end group and the results plotted on
a line, the value from the solved formula for each end group would be as
far apart from its nearest neighbour as could be achieved by using the
available environmental variables to separate the end groups</p>
</div>
<div class="section level3" number="7.3">
<h3 id="environmental-variables">
<span class="header-section-number">7.3</span> Environmental
Variables<a class="anchor" aria-label="anchor" href="#environmental-variables"></a>
</h3>
<p>The values of the EVs relevant to the prediction run will have been
determined during the acceptance, validation and subsequent conversion
processing of the input data as described in section 5 and 6 of this
document. These are referred to in the algorithm below as EnvvN.</p>
</div>
<div class="section level3" number="7.4">
<h3 id="discriminant-functions-and-coefficients">
<span class="header-section-number">7.4</span> Discriminant
Functions and Coefficients<a class="anchor" aria-label="anchor" href="#discriminant-functions-and-coefficients"></a>
</h3>
<p>The RIVPACS model used will determine the Discriminant Functions
(DFs) that have to be run. For the GB model 1 with 13 EVs the DFs values
can be found in the inst/ext folder for GB in a file called
DFCOEFF_GB685.</p>
<p>For the GB model 44 with 17 EVs the DFs values can be found in the
prediction support files folder for GB in a file called
<code>discrimant-function-coefficients-model-44.csv</code> - see section
12 for additional Model 44 information.</p>
<p>For the NI model with 11 EVs, the DFs values can be found in the
prediction support files folder for Northern Ireland in a file called
<code>DFCOEFF_NI</code></p>
<p>These are separate occurrences of DF. Each of these has a single
‘constant’ and, for each component EV, a co-efficient that is to be
applied to the EV value. The coefficients are referred to in the
algorithm below as DFCoef.</p>
</div>
<div class="section level3" number="7.5">
<h3 id="calculate-discriminant-function-scores">
<span class="header-section-number">7.5</span> Calculate
Discriminant Function Scores<a class="anchor" aria-label="anchor" href="#calculate-discriminant-function-scores"></a>
</h3>
<p>(Step 4 in diagram above)</p>
<p><img src="images/rict-discriminant-function-score.png" width="200"></p>
<p>The functions that RICT uses for the calculations in the steps below
(steps 4 - 8) can be found in the prediction-functions.R file. The
algorithms and definitions provided below are copied from WFD72C and
have been used to create the functions.</p>
<p>For each DF, the Discriminant Score needs to be calculated as
follows:</p>
<p>DFScore<sub>d</sub> = DFCoef<sub>1,d</sub> * Env1 + … +
DFCoef<sub>vN,d</sub> * En<sub>vvN</sub>; for d = 1. … dN</p>
<p>Definitions – these have been copied from WFD72C:</p>
<p>v = id of current environmental predictor variable<br>
vN = number of environmental predictor variables<br>
d = id of current discriminant function axis<br>
dN = number of discriminant function axes in current Reference end group
set<br>
DFCoef<sub>v,d</sub> = discriminant function coefficient for predictor
variable v on<br>
discriminant function d obtained from the values in the DFCOEFF_GB685
file for<br>
Great Britain, DFCOEFF_NI file for Northern Ireland or
discrimant-function-coefficients-model-44.csv for model 44 which can be
found within the prediction support files.<br>
Env<sub>v</sub> = value of environmental predictor variable v for the
current test site<br>
DFScore<sub>d</sub> = discriminant function score on axis d for the
current test site</p>
</div>
<div class="section level3" number="7.6">
<h3 id="calculate-mahanalobis-distance">
<span class="header-section-number">7.6</span> Calculate Mahanalobis
Distance<a class="anchor" aria-label="anchor" href="#calculate-mahanalobis-distance"></a>
</h3>
<p>(Step 5 in diagram above)</p>
<p><img src="images/rict-mahalanobis-distance.png" width="200"></p>
<p>For a particular End Group g, the probability of End Group Membership
is calculated as follows:</p>
<ul>
<li>Calculate Mahanalobis distance (MahDistg) of test site from each End
Group</li>
</ul>
<pre><code>MahDistg = (DFScore1 - DFMeang,1)2 + ... + (DFScoredN - DFMeang,dN )2 ; for g = 1,...,gN</code></pre>
<p>Definitions – these have been copied from WFD72C:</p>
<p>g = id of current end group (set ID: 1 = GB, 2 =NI)<br>
gN = number of end groups in current Reference end group set<br>
NRef<sub>g</sub> = number of reference sites in end group g<br>
DFMean<sub>g,d</sub> = mean discriminant function score of end group g
on axis d Obtained from the ‘target’ values in the DFMEAN_GB685 file
forObtained from the table
x-103-end-group-means-formatted-jdb-17-dec-2019.csv which is within the
inst/ext folder) Great Britain, DFMEAN_NI file for Northern Ireland or
end-group-means-discriminant-scores-model-44.csv for Model 44.<br>
MahDistg = Mahalanobis distance of test site from end group g</p>
</div>
<div class="section level3" number="7.7">
<h3 id="mahanalobis-distance">
<span class="header-section-number">7.7</span> Mahanalobis
Distance<a class="anchor" aria-label="anchor" href="#mahanalobis-distance"></a>
</h3>
<p>Use Mahanalobis distance to determine probability of End Group
membership (Step 6 in diagram above):</p>
<p><img src="images/rict-probability-end-group.png" width="200"></p>
<ul>
<li>Calculate the PDistg for each End Group</li>
</ul>
<p>PDist<sub>g</sub> = NRef <sub>g</sub> *
EXP(-MahDist<sub>g</sub>/2)</p>
<p>where NRef g = the number of reference sites in the End Group (from
the End Group Reference Data table) and EXP is the natural exponential
function</p>
<ul>
<li>Calculate the PDistTot</li>
</ul>
<p>PDistTot = PDist<sub>1</sub> to PDist <sub>gN</sub></p>
<p>where gN is the number of end groups in the relevant end group
set</p>
<ul>
<li>Calculate the Probability of End Group Membership
(Prob<sub>g</sub>)</li>
</ul>
<p>Prob<sub>g</sub> = PDist<sub>g</sub> / PDistTot</p>
<p>where Probg is the Probability test site belongs to end group g</p>
<p>At the end of this process we end up with a set of probabilities of
End Group Membership, one for each End Group. These are referred to
below as Prob<sub>1</sub> to Prob<sub>n</sub>.</p>
</div>
<div class="section level3" number="7.8">
<h3 id="determine-environmental-suitability">
<span class="header-section-number">7.8</span> Determine
Environmental Suitability<a class="anchor" aria-label="anchor" href="#determine-environmental-suitability"></a>
</h3>
<p>Determine environmental suitability of the test site for
prediction:</p>
<p><img src="images/rict-environmental-suitability.png" width="200"></p>
<p>(Step 7 in diagram above)</p>
<p>In certain cases it may be calculated that there is a very low
probability of the site being in any of the end groups based on the data
provided.</p>
<p>In order to highlight this to the user, a calculation is required to
allocate an Environmental Suitability code to the site data indicating
the probability the site belongs to any end group. The potential codes
are:</p>
<ul>
<li>1 OK</li>
<li>2 &lt; 5%</li>
<li>3 &lt; 2%</li>
<li>4 &lt; 1%</li>
<li>5 &lt; 0.1%</li>
</ul>
<p>The required calculation uses the Chi-square values (CQ1 to CQ4)
which vary per End Group Set as below:</p>
<table class="table">
<thead><tr class="header">
<th align="left">End Group set (ID)</th>
<th align="left">CQ1</th>
<th align="left">CQ2</th>
<th align="left">CQ3</th>
<th align="left">CQ4</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">RIVPACS IV GB (set 1)</td>
<td align="left">21.02606</td>
<td align="left">24.05393</td>
<td align="left">26.21696</td>
<td align="left">32.90923</td>
</tr>
<tr class="even">
<td align="left">RIVPACS IV NI (set 2)</td>
<td align="left">18.307</td>
<td align="left">21.1608</td>
<td align="left">23.2093</td>
<td align="left">29.5883</td>
</tr>
</tbody>
</table>
<p><code>prediction-functions.R</code> has a function called
getSuitabilityCode() which will do this calculation.</p>
<p>The detailed calculation is as follows:</p>
<ul>
<li>Calculate the minimum Mahanalobis distance
(MahDist<sub>min</sub>)</li>
</ul>
<p>MahDistmin = minimum of
(MahDist<sub>1</sub>,….,MahDist<sub>n</sub>)</p>
<ul>
<li>Calculate the Environmental Suitability Code and Suitability
text</li>
</ul>
<p>If the MahDist<sub>min</sub> &lt; value for CQ1 then Suitability Code
= 1 and suitability text is &gt;5%</p>
<p>If the MahDist<sub>min</sub> &gt;= value for CQ1 and &lt; value for
CQ2 then Suitability Code = 2 and suitability text is &lt;5%</p>
<p>If the MahDist<sub>min</sub> &gt;= value for CQ2 and &lt; value for
CQ3 then Suitability Code = 3 and suitability text is &lt;2%</p>
<p>If the MahDist<sub>min</sub> &gt;= value for CQ3 and &lt; value for
CQ4 then Suitability Code = 4 and suitability text is &lt;1%</p>
<p>If the MahDist<sub>min</sub> &gt;= value for CQ4 then Suitability
Code = 5 and suitability text is &lt;0.1%</p>
<p>The output file will provide the user with the Suitability Code and
suitability text. The Suitability text gives the user information and
warnings about the suitability code calculated.</p>
</div>
<div class="section level3" number="7.9">
<h3 id="determine-the-predicted-values-of-indices">
<span class="header-section-number">7.9</span> Determine the
Predicted Values of Indices<a class="anchor" aria-label="anchor" href="#determine-the-predicted-values-of-indices"></a>
</h3>
<p>(Step 8 in diagram above)</p>
<p><img src="images/rict-prediction-of-index.png" width="200"></p>
<p>The indices that require to be processed will be identified from the
options panel. For the initial release of RICT this will be for WHPT
ASPT and WHPT NTAXA sets which are the indices required for the WFD
classification. However, for Prediction, all 80 indices (which includes
WHPT ASPT and WHPT NTAXA sets), will be used at this point and for
Prediction only.</p>
<p><code>prediction-functions.R</code> contains the following functions
which will do this calculation:</p>
<p><code>rict:::getSeasonIndexScores()</code></p>
<p>and the: end_group_IndexDFrame uses the
<code>x-103-end-group-means-formatted-jdb-17-dec-2019.csv</code>
file</p>
<p>Algorithm: (copied from WFD72C)</p>
<p>ExpIDXi = Prob<sub>1</sub> * IDXmean<sub>i,s,1,</sub> + … +
Prob<sub>gN</sub> * IDXmean<sub>i,s,gN</sub></p>
<p>Definitions: (these have been copied from WFD72C)</p>
<p>g = id of current end group<br>
gN = number of end groups in current Reference end group set (set: 1 =
GB, 2 =NI)<br>
Prob<sub>g</sub> = Probability test site belongs to end group g<br>
i = id of current biological index<br>
iN = total number of biological indices<br>
s = id of selected season(s) combination (referred to as ‘season s’); (1
= spring, 2 = summer, 3 = autumn, 4 = pooled spring + summer, 5 = pooled
spring + autumn, 6 = pooled summer + autumn, 7 = all three seasons
pooled – only 1, 2 and 3 are used in RICT 2)<br>
IDXMean<sub>i,s,g</sub> = Mean value of index i for season s for
reference sites in end group g ExpIDX<sub>i</sub> = Expected value of
index i for selected season s for current test site</p>
<p>Internally-supplied Data files:</p>
<p>A separate file called
<code>x-103-end-group-means-formatted-jdb-17-dec-2019.csv</code> will be
provides the values for:</p>
<p>IDXMean<sub>i,s,g</sub> = Mean value of index i for season s for
reference sites in end group g</p>
</div>
<div class="section level3" number="7.10">
<h3 id="prediction-outputs">
<span class="header-section-number">7.10</span> Prediction
Outputs<a class="anchor" aria-label="anchor" href="#prediction-outputs"></a>
</h3>
<p>Once the prediction processing has been completed, the following data
has been calculated for each occurrence of site data:</p>
<ul>
<li>Probabilities of End Group Membership</li>
<li>Expected Index Values</li>
<li>Predicted Taxa occurrence details</li>
</ul>
<p>The expected index data is then passed to the classification
process.</p>
</div>
</div>
<div class="section level2" number="8">
<h2 id="all-index-prediction">
<span class="header-section-number">8</span> All index
prediction<a class="anchor" aria-label="anchor" href="#all-index-prediction"></a>
</h2>
<p>This provides predictions for a wide range of indices.</p>
<p>However, it uses a different end group means data file derived from
the RIVPACS database.</p>
<p>The all indices output file will only show the output for prediction
for the 80 indices.</p>
<p>The biotic indices included in all index prediction are listed in
Appendix B2.</p>
</div>
<div class="section level2" number="9">
<h2 id="taxa-prediction">
<span class="header-section-number">9</span> Taxa Prediction<a class="anchor" aria-label="anchor" href="#taxa-prediction"></a>
</h2>
<p><img src="images/rict-prediction-of-taxa.png" width="200"></p>
<p>Although not required for status classification, an important feature
of RIVPACS that is included in RICT is to be able to predict the taxa
expected to be present at the site. For each taxon, the prediction
provides:</p>
<ul>
<li>Expected probability of occurrence.</li>
<li>Expected log abundance category.</li>
<li>Expected numerical abundance.</li>
</ul>
<p>The steps involved are described below.</p>
<div class="section level3" number="9.1">
<h3 id="data-limits">
<span class="header-section-number">9.1</span> Data Limits<a class="anchor" aria-label="anchor" href="#data-limits"></a>
</h3>
<p>Because of the large amounts data in the output files and stain on
the server, the user is limited to 20 sites per run. This restriction is
only on the web app. Running the RICT package locally is unlimited.</p>
<div class="section level4" number="9.1.1">
<h4 id="taxon-prediction-data-file">
<span class="header-section-number">9.1.1</span> Taxon prediction
data file<a class="anchor" aria-label="anchor" href="#taxon-prediction-data-file"></a>
</h4>
<p>All of the required taxon prediction data was supplied by John
Davy-Bowker in a single file derived from the RIVPACS Reference
Database: TAXA_AB_APR_PRAB.csv</p>
<p>This file contains the following 18 columns:</p>
<pre><code>1. Model                1 = GB, 2 = NI
2. End_Group      1-43 for GB, 1-11 for NI
3. TL                   Taxonomic Level: TL1, TL2, TL3, TL4, TL5
4. Season_Code:     1 = spring, 2 = summer, 3 = autumn

The next 6 columns (5-10) should all be stored as Text columns (even those which appear numeric because they need to retain their leading zeroes.

5. Maitland_Code
6. Maitland_Name
7. Furse_Code
8. Furse_Name
9. NBN_Code
10. NBN_Name

The final 8 columns (11-18) are the 8 parameters whose expected values for any test site we wish to calculate for each taxon at each taxonomic level in each season
  
11. Average_Numerical_Abundance
12. Average_Log10_Abundance
13. Prob_Occurrence
14. Prob_Log1
15. Prob_Log2
16. Prob_Log3
17. Prob_Log4
18. Prob_Log5</code></pre>
<p>Note: For the GB model, at any one taxonomic level (TL1 – TL5) and
particular season (1-3), any particular taxon at that level only occurs
as a row in this input file if it occurred (i.e. has at least one
positive taxonomic parameter value) in at least one of the GB RIVPACS IV
reference site End-groups. Similarly for taxa in the NI model. Thus the
taxa listed (i.e. given) rows varies slightly between seasons because
not all taxa were found in every seasons in at least one of the RIVPACS
IV model reference sites.</p>
<ul>
<li>TL1 = BMWP taxa</li>
<li>TL2 = WHPT taxa</li>
<li>TL3 = all RIVPACS families</li>
<li>TL4 = all RIVPACS species</li>
<li>TL5 = mixed taxon level</li>
</ul>
<p>Season 1 = spring, 2 = summer, 3 = autumn.</p>
</div>
<div class="section level4" number="9.1.2">
<h4 id="calculate-expected-for-a-gb-test-site">
<span class="header-section-number">9.1.2</span> Calculate Expected
for a GB test site<a class="anchor" aria-label="anchor" href="#calculate-expected-for-a-gb-test-site"></a>
</h4>
<p>End-group means of the 8 parameters to be predicted are supplied in
columns 11-18 of the above taxon prediction data file.</p>
<p>When working on the GB model, you first need to subset the data in
the taxon prediction file to eliminate the rows for NI (Model =2).</p>
<p>Assuming the RICT software has already read the test site’s
environmental input data and calculated the probabilities (P1 , P2 , …
P43) of the test site belonging to each of the 43 GB Model End-groups,
for any particular taxa K at taxonomic level L in season S, its
predicted expected value (ExpJKLS) of Taxonomic parameter J for that
season is given by:</p>
<p>E<sub>JKLS</sub> = P1 x M<sub>JKLS(1)</sub> + P2 x
M<sub>JKLS(2)</sub> + … + P43 x M<sub>JKLS(43)</sub></p>
<p>Where M<sub>JKLS(i)</sub> = supplied End-group mean of taxonomic
parameter J of taxa K at taxonomic level L in season S.</p>
<p>In a mathematical sense that’s it and it appears easy. However, in
practice it is not easy, not only because of the vast number of taxa,
taxonomic level, end-group and season combinations for which Expected
values are required, but also because the number of taxa included in the
input file varies between seasons.</p>
</div>
<div class="section level4" number="9.1.3">
<h4 id="calculate-all-taxonomic-expected-values">
<span class="header-section-number">9.1.3</span> Calculate all
taxonomic expected values<a class="anchor" aria-label="anchor" href="#calculate-all-taxonomic-expected-values"></a>
</h4>
<p>The following computing trick calculates the expected values of
taxonomic parameters for all taxa at all levels in all seasons in one
step.</p>
<p>If (P<sub>1</sub> , P<sub>2</sub> , … P<sub>43</sub>) denote the
probabilities of the current test site belonging to each of the 43 GB
Model End-groups, then:</p>
<ol style="list-style-type: lower-roman">
<li><p>Copy column 2 (‘End_Group’) to a new column
‘End_Group_Prob’</p></li>
<li><p>Use a software coding (translation) function to recode the new
‘End_Group_Prob’ column so that : 1 becomes P<sub>1</sub> , <sub>2</sub>
becomes P<sub>2</sub>, … , 43 becomes P<sub>43</sub></p></li>
<li><p>For any particular taxonomic parameter J (denoted here ParamJ and
supplied in one of columns 11-18), calculate new column ParamJ_Prob
as:</p></li>
</ol>
<pre><code>ParamJ_Prob = End_Group_Prob  x ParamJ</code></pre>
<ol start="4" style="list-style-type: lower-roman">
<li><p>Use a software multi-way table function using columns (4, 3, 7,
5, 6, 8, 9, 10,) in that order as multi-way table classifiers and then
sum the column ‘ParamJ_Prob’ across all 43 ‘End-groups’ which it will do
by default in any sum function as ‘End_Group’ is not one of the table
classifiers.</p></li>
<li><p>You actually want to use a multi-way table function which creates
a new output set of columns with one new column for each table
classifier and one for the sum across end-groups of the column
‘ParamJ_Prob’</p></li>
<li><p>In fact, if you can do this for one of 8 taxonomic parameters,
you could probably do it for all 8 parameters at one step, having first
derived the 8 intermediary columns: Param1_Prob, Param2_Prob,… ,
Param8_Prob</p></li>
</ol>
<p>The order of multi-way table classifying columns that I specified
above, namely (4, 3, 7, 5, 6, 8, 9, 10) will ensure that new columns of
Expected taxonomic parameters will have classifier columns sorted first
on Season, then Taxonomic Level, then Furse code, and finally all of the
other alternative taxonomic codes for a taxa. I have suggested using
‘Furse_Code’ as the first (and primary individual taxonomic code) as I
think it is unique and always available. It will also make it easier to
compare with Ralph’s independent test code.</p>
<p>In summary, this should lead to an output file of 18 columns, akin to
those in the input file, but where the values in output file columns
11-18 are now the predicted Expected values for the 8 taxonomic
parameters for each combination of season, taxonomic level and taxa code
as specified in output file columns 1-10.</p>
<p>This procedure could be done for each test site in turn. The 18
output columns for each site could be stacked so that there is one
additional output column denoting ‘SiteName’.</p>
<p>The single output file of columns can now be re-sorted externally by
the User or use to subset by SiteName, Season, Taxonomic Level and/or
Tax code, as required. For example, to just get predictions of taxonomic
parameters for taxa at taxonomic level TL1 (BMWP family level), you just
subset the 18 output columns by column TL= TL2.</p>
<p>If the user wishes to only view the prediction results, a csv output
will be generated which can be downloaded and used for reports.</p>
</div>
<div class="section level4" number="9.1.4">
<h4 id="taxon-prediction-output">
<span class="header-section-number">9.1.4</span> Taxon prediction
Output<a class="anchor" aria-label="anchor" href="#taxon-prediction-output"></a>
</h4>
<p>Taxon prediction output includes a row for each taxon predicted. For
each site, expect about 3500 rows of data. The first block of rows will
be for the first site selected and below it the results for the second
site. Each row includes the same columns as the taxon prediction data
file, together with siteName. Sections below are based on notes from
write up with Maybin (March 2020):</p>
</div>
</div>
<div class="section level3" number="9.2">
<h3 id="data-input-files">
<span class="header-section-number">9.2</span> Data Input files<a class="anchor" aria-label="anchor" href="#data-input-files"></a>
</h3>
<div class="section level4" number="9.2.1">
<h4 id="gb-ni">
<span class="header-section-number">9.2.1</span> GB &amp; NI<a class="anchor" aria-label="anchor" href="#gb-ni"></a>
</h4>
<ul>
<li>New Input File:
<code>New_Input_file_Data_to_use_multi_year.csv</code>
</li>
<li><code>prediction-functions.R</code></li>
<li><code>helper-functions.R</code></li>
</ul>
</div>
</div>
<div class="section level3" number="9.3">
<h3 id="r-code-for-taxa-prediction">
<span class="header-section-number">9.3</span> R code for taxa
prediction<a class="anchor" aria-label="anchor" href="#r-code-for-taxa-prediction"></a>
</h3>
<p>The <code>rict_predict</code> function this is the same as previous
predictions but for taxa prediction we need to find each site’s
EndGroup, it uses columns 15:57 for GB and 13:23 for NI.</p>
<p>An important file as it looks at the taxonomic info from the
<code>TAXA_AB_APR_PRAB.csv</code> about the model to be used in the
prediction. EndGroup found are used with this file to compute
predictions.</p>
<p>If the argument <code>taxa = TRUE</code> the function loops through
each site and processes each site to do the predictions.</p>
</div>
</div>
<div class="section level2" number="10">
<h2 id="classification-1">
<span class="header-section-number">10</span> Classification<a class="anchor" aria-label="anchor" href="#classification-1"></a>
</h2>
<div class="section level3" number="10.1">
<h3 id="classification-process-summary">
<span class="header-section-number">10.1</span> Classification
Process Summary<a class="anchor" aria-label="anchor" href="#classification-process-summary"></a>
</h3>
<p>The flow diagram below summarises the classification process and
calculations as well as identifying the relevant section for further
information from the WFD72C final report and other sources of
information:</p>
<p><img src="images/rict-classification.png"></p>
<p>Note that the blue boxes indicate processes that are simulated.</p>
</div>
<div class="section level3" number="10.2">
<h3 id="classification-overview">
<span class="header-section-number">10.2</span> Classification
overview<a class="anchor" aria-label="anchor" href="#classification-overview"></a>
</h3>
<p>For every site in the input to the classification process consists of
Observed and Expected Index Values for the ‘current year’ for each
applicable index.</p>
<p>Multiyear classification will include Observed and Expected Index
Values for up to two previous years for each applicable index.</p>
<p>For the WFD classification, RICT will use TL2 WHPT Abundance weighted
with distinct taxa for ASPT and NTAXA indices.</p>
<p>Any functions that RICT uses for the calculations described in the
steps below (steps 1 - 13), can be found in the
ClassificationfunctionsV2 within the classification support files
folder. The algorithms and definitions provided below are copied from
WFD72C plus other sources and have been used to create the
functions.</p>
</div>
<div class="section level3" number="10.3">
<h3 id="calculate-expected-values">
<span class="header-section-number">10.3</span> Calculate Expected
Values<a class="anchor" aria-label="anchor" href="#calculate-expected-values"></a>
</h3>
<p>(Step 1 in process diagram above and Section 7)</p>
<p><img src="images/rict-classification-1.png" width="200"></p>
<p>This is the main result from RIVPACS prediction (Section 7), based on
environmental variable data input by the user. It is the prediction of
the value of the index expected at the site if it was in the best
quality available for that type of site, based on samples collected from
best available reference sites.</p>
</div>
<div class="section level3" number="10.4">
<h3 id="adjust-expected-values">
<span class="header-section-number">10.4</span> Adjust Expected
Values<a class="anchor" aria-label="anchor" href="#adjust-expected-values"></a>
</h3>
<p>(Step 2 in process diagram above)</p>
<p><img src="images/rict-classification-2.png" width="200"></p>
<p>The aim of this step is to standardise the raw predictions so that
they relate to the same environmental quality (the high/good boundary
quality) using algorithms first developed in WFD72b. This step is
necessary to take account of variation in the environmental quality of
RIVPACS reference sites.</p>
<p>There are a number of processes involved in this step as described
below:</p>
<ul>
<li><p>The <code>computeScoreProportions()</code> function within the
prediction support files folder is used to calculate proportions (Qij)
for each end group using a CSV file (also within the prediction support
files folder) called EndGrp_AssessScores.</p></li>
<li><p>The <code>getWeighted_proportion_Rj()</code> function within the
prediction support files folder is used to calculate weighted
proportions (Rj) using the probabilities from prediction process by
multiplying with the Qij proportions.</p></li>
<li><p>The <code>compute_RjAj()</code> function within the prediction
support files folder is used to calculate RjAj by multiplying the
weighted proportions by the adjustment factors. See below for details
regarding the adjustment factors.</p></li>
<li><p>Finally, the RjAj value is used to divide by for all the
predictions (NTAXA and ASPT) to get the adjusted expected value
(ExpIDXadj,i) for each site and each index.</p></li>
</ul>
<p>The reference adjustment values referred to above are default values
for the WFD classification and can be found in adjustParams_ntaxa_aspt
csv file within the classification support files folder.</p>
<p>This supporting data table csv file contains the number of reference
sites by Biologist assessment score (1-5) for each End Group together
with the five adjustment factors (Q1, Q2, Q3, Q4, Q5) for each
index.</p>
<p>The source for this csv file is based on the Table 6 from the Testing
RICT predictions and classifications draft report 2018 which is as
below:</p>
<table class="table">
<thead><tr class="header">
<th align="left">Index</th>
<th align="left">WHPT NTAXA</th>
<th align="left">WHPT ASPT</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">Q1</td>
<td align="left">1</td>
<td align="left">1</td>
</tr>
<tr class="even">
<td align="left">Q2</td>
<td align="left">1</td>
<td align="left">1</td>
</tr>
<tr class="odd">
<td align="left">Q3</td>
<td align="left">1</td>
<td align="left">1</td>
</tr>
<tr class="even">
<td align="left">Q4</td>
<td align="left">0.967</td>
<td align="left">0.977</td>
</tr>
<tr class="odd">
<td align="left">Q5</td>
<td align="left">0.926</td>
<td align="left">0.945</td>
</tr>
</tbody>
</table>
<p>Table 1. Adjustment factors for reference site quality (Q1, Q2, Q3,
Q4, Q5) for abundance-weighted WHPT NTAXA and WHPT ASPT</p>
<p>However, further work has been done which has resulted in slightly
different values for these adjustment factors which are reflected in the
<code>adjustParams_ntaxa_aspt.csv</code> file used by RICT, It is
expected that the Testing RICT predictions and classifications draft
report 2018 will be shortly updated to include a Table 7 to show these
changes.</p>
<p>There is one set of adjustment factors for each index. Within current
RICT, adjustment factors for WHPT NTAXA and WHPT ASPT have been
calculated.</p>
</div>
<div class="section level3" number="10.5">
<h3 id="eqr-conversion-factor">
<span class="header-section-number">10.5</span> EQR Conversion
Factor<a class="anchor" aria-label="anchor" href="#eqr-conversion-factor"></a>
</h3>
<p>(Step 3 in process diagram above)</p>
<p><img src="images/rict-classification-3.png" width="200"></p>
<p>This is the conversion factor used to convert the adjusted
predictions that relate to high/good boundary quality to reference
values that relate to reference condition, which is somewhere in high
status (reference values are the average value of the metric at
reference sites in reference condition = high status)</p>
<p>Each index has a different conversion factor, based on the average
value of the index at all RIVPACS Reference Sites divided by the value
at RIVPACS reference sites that are in WFD high status (reflected in
Biologists’ Assessment values for each reference site).</p>
<p>For the default WFD classification in RICT the conversion factor
value will be (as copied from Section 5.5 of the Testing RICT
predictions and classifications draft report 2018):</p>
<ul>
<li>1.0049 for WHPT NTAXA</li>
<li>0.9921 for WHPT ASPT</li>
</ul>
</div>
<div class="section level3" number="10.6">
<h3 id="convert-adjusted-expected-to-reference-value">
<span class="header-section-number">10.6</span> Convert adjusted
expected to reference value<a class="anchor" aria-label="anchor" href="#convert-adjusted-expected-to-reference-value"></a>
</h3>
<p>(Step 4 in process diagram above)</p>
<p><img src="images/rict-classification-4.png" width="200"></p>
<p>The aim of this step is to convert the predictions from high/good
boundary to reference values, which is somewhere in high status
(actually the average value of the index at reference sites in high
status), by applying the conversion factor.</p>
<p>The conversion factor is applied to the adjusted expected value to
give an expected reference value which will be used to calculate the
EQRs expected by the Water Framework Directive.</p>
<p>Specifically, ExpIDXRef,i is calculated as:</p>
<p>ExpIDX<sub>Ref,i</sub> = ExpIDX<sub>Adj,i</sub> / K</p>
<p>Where:</p>
<p>ExpIDX<sub>Adj,i</sub> = the adjusted expected value which is
calculated as described in section 8.2 above.<br>
K = WFD conversion factor (i.e. WHPT NTAXA: K = 1.0049, and WHPT ASPT K
= 0.9921 as described in section 8.3 above.<br>
IDX = do this for each Index, i.e. for WHPT NTAXA and WHPT ASPT<br>
i = do this for each specific site</p>
<p>This avoids the need for the intermediary step of calculating and
referring to EQI (Environmental Quality Indices) values (which are
calculated as EQI = Obs / ExpAdj) and means that the site
classifications can use the published class limits for index EQR values
directly.</p>
<p>This calculation is done directly within RICT code and not via any
function.</p>
</div>
<div class="section level3" number="10.7">
<h3 id="simulate-uncertainty-in-expected">
<span class="header-section-number">10.7</span> Simulate uncertainty
in expected<a class="anchor" aria-label="anchor" href="#simulate-uncertainty-in-expected"></a>
</h3>
<p>(Step 5 in process diagram above)</p>
<p><img src="images/rict-classification-5.png" width="200"></p>
<p>The aim of this step is to take account of error in measurement of
environmental variables used to predict the reference values.</p>
<p>It should be noted that the “ +eir “ shown in the algorithm in the
process step above is a summary of the algorithm values of ZExpir *
SDExpi / √(NExpyear) as described in further detail below. It is the
error term used to adjust the expected value.</p>
<p>The simulation of uncertainty in ExpRef is obtained using the
algorithms in Section 6.4 of the Clarke &amp; Davy-Bowker WHPT indices
RICT Report of March 2014 report, but now where uncertainty in the
Expected values is measured about the WFD Reference-adjusted value
ExpRef., this has been amended as described below.</p>
<p>Main algorithm used:</p>
<p>ExpIDXir = ExpIDX<sub>i</sub> + ZExp<sub>ir</sub> * SDExp<sub>i</sub>
/ √(NExp<sub>year</sub>)</p>
<p>Where (using the same notation as section 6.4 of the 2014 WHPT
report):</p>
<p>ExpIDX<sub>i</sub> = WFD Reference-adjusted Expected value (ExpRef)
of index i<br>
ExpIDX<sub>ir</sub> = WFD Reference-adjusted Expected value of index i
in simulation r<br>
SDExp<sub>i</sub> = Error SD for expected value of index i<br>
NExp<sub>year</sub> = 1 for single-year run<br>
= number of years (1, 2 or 3) for which a separate estimate of the E
value was involved in the estimate of average E value (for multi-year
run)<br>
ZExp<sub>ir</sub> = Random number deviate from a standard Normal
distribution with a mean of 0.0 and SD of 1.0, for use in simulation r
for index i</p>
<p>Where:</p>
<p>SDExp<sub>7</sub> = 4.3 = Measurement error SD of Expected values of
weighted WHPT Score (index 7)<br>
SDExp<sub>8</sub> = 0.53 = Measurement error SD of Expected values of
weighted WHPT NTAXA (index 8)<br>
SDExp<sub>9</sub> = 0.081 = Measurement error SD of Expected values of
weighted WHPT ASPT (index 9)</p>
<p>Within RICT, these calculations are done using functions which can be
found in the ClassificationfunctionsV2 (within the classification
support files folder).</p>
<p>It should be noted that it is important to do this for each index and
also be aware of the numbering for each index. As indicated above, each
index has a number, i.e.:</p>
<ul>
<li><p>WHPT Score (index 7)</p></li>
<li><p>WHPT NTAXA (index 8)</p></li>
<li><p>WHPT ASPT (index 9)</p></li>
</ul>
</div>
<div class="section level3" number="10.8">
<h3 id="calculate-bias-adjustment">
<span class="header-section-number">10.8</span> Calculate Bias
Adjustment<a class="anchor" aria-label="anchor" href="#calculate-bias-adjustment"></a>
</h3>
<p>(Step 6 in process diagram above)</p>
<p><img src="images/rict-classification-6.png" width="200"></p>
<p>RICT classification requires users to input an observed value for an
index (ObsIDXi), based on samples collected in the field. This value is
provided by the user completing the relevant data field in the input
file as described in section 5 and Annex B of this document. Values are
required for each index and for all three seasons, spring, summer and
autumn.</p>
<p>Users may also input a bias value (UBiasis) for NTAXA, which reflects
the impact of analytical error (measured by auditing) on the observed
index values. This value is provided by the user completing the relevant
data field in the input file as described in section 5 and Annex B of
this document. RICT calculates bias for ASPT from bias for NTAXA and the
observed NTAXA. If no input value for Bias is provided, RICT will use a
default value of 1.62.</p>
<p>If bias correction is not wanted, users should enter a bias value of
zero into the relevant data field in the input file. The zero value must
be entered and not left blank or RICT will use a default value.</p>
</div>
<div class="section level3" number="10.9">
<h3 id="simulate-uncertainty-in-observed-values">
<span class="header-section-number">10.9</span> Simulate uncertainty
in observed values<a class="anchor" aria-label="anchor" href="#simulate-uncertainty-in-observed-values"></a>
</h3>
<p>(Step 7 in process diagram above)</p>
<p><img src="images/rict-classification-7.png" width="200"></p>
<p>These simulations take account of sampling error, estimated in
replicated sampling studies, including the Biological Assessment Methods
Study (BAMS) which is needed so that statistical confidence of the
status classification can be estimated.</p>
<p>The main algorithm used:</p>
<p>ObsIDX<sub>ir</sub> = ObsIDX<sub>i</sub> ZNorm<sub>ir</sub> *
SDObs<sub>i</sub></p>
<p>Where:</p>
<p>ObsIDX<sub>i</sub> = input value provided by the user for observed
value for an index as described in section 8.6 above<br>
ZNorm<sub>ir</sub> = Random number deviate from a standard Normal
distribution with a mean of 0.0 and SD of 1.0 for index i in simulation
r<br>
SDObs<sub>i</sub> For single-year runs: SDObs<sub>i</sub> = √(
(SDRep<sub>i</sub>)<sup>2</sup> +
(SDTSeas<sub>i</sub>)<sup>2</sup>)<br>
Where values for SDRep = 0.269 and SDTSeas = 0.279<br>
Definitions for each index used within RICT (which are only the
abundance-weighted WHPT indices are as below copied from Section 6.3.3.2
(b) of the WHPT and other Abundance-Weighted Indices SEPA Report:<br>
ObsIDX8r = (√(ObsIDX8) + ZObs8r)<sup>2</sup> = rth simulated value for
observed weighted WHPT NTAXA<br>
ObsIDX9r = ObsIDX<sub>9</sub> + ZObs<sub>9r</sub> = rth simulated value
for observed weighted WHPT ASPT<br>
ObsIDX7r = ObsIDX<sub>8r</sub> * ObsIDX<sub>9r</sub> = rth simulated
value for observed weighted WHPT Score</p>
<p>Within RICT, these calculations are done using functions which can be
found in the <code>classification-functions.R</code>.</p>
</div>
<div class="section level3" number="10.10">
<h3 id="simulate-variation-in-bias">
<span class="header-section-number">10.10</span> Simulate variation
in Bias<a class="anchor" aria-label="anchor" href="#simulate-variation-in-bias"></a>
</h3>
<p>(Step 8 in process diagram above)</p>
<p><img src="images/rict-classification-8.png" width="200"></p>
<p>This is simulation of user input bias which is calculated in RICT
using the <code>getUbias8r()</code> function found in the
<code>classification-functions.R</code>.</p>
<p>The algorithms used within this function are as below which is copied
from Section 6.3.3.3 of the WHPT and other Abundance-Weighted Indices
SEPA Report.</p>
<p>Definitions</p>
<p>ObsIDX<sub>ir</sub> = Simulation r Observed sample value of index i
for current test site (uncorrected for bias)</p>
<p>Ubias<sub>8</sub> = estimate of average net under-estimation of WHPT
NTAXA for the observed sample</p>
<p>Ubias<sub>8</sub> is either:</p>
<ol style="list-style-type: decimal">
<li>input by the user of the RICT software</li>
<li>estimated as 36% higher than the user-input bias (Ubias2) for number
of BMWP taxa i.e. Ubias<sub>8</sub> = 1.36 Ubias<sub>2</sub>
</li>
</ol>
<pre><code>Ubiasir   = Estimate of bias (net under-estimation) of index i for simulation r
ObsIDXirB = Bias-corrected observed value of index i for simulation r</code></pre>
<p>Special case: when no WHPT taxa were recorded in the sample
(i.e. ObsIDX8 = 0), assume none were missed (i.e, set Ubias8 = 0)</p>
<p>Ubias<sub>8r</sub> = bias (net under-estimate of number of WHPT taxa)
for simulated sample r, estimated as a random deviate from a Poisson
distribution with a mean of Ubias<sub>8</sub></p>
<p>Zbias<sub>9r</sub> = Random number deviate from a standard Normal
distribution with a mean of 0.0 and SD of 1.0</p>
<p>Ubias<sub>9r</sub> = abundance-weighted WHPT ASPT of the Ubias8r
missed WHPT taxa for simulated sample r</p>
<p>= u<sub>9a</sub> + u<sub>9b</sub> * ObsIDX<sub>9</sub> +
Zbias<sub>9r</sub> * (u9c / √Ubias<sub>8r</sub>)</p>
<p>where u<sub>9a</sub> = 4.35 , u<sub>3b</sub> = 0.271 , u<sub>9c</sub>
= 2.5</p>
<p>Then:</p>
<p>Ubias<sub>7r</sub> = Ubias<sub>8r</sub> * Ubias<sub>9r</sub> = bias
of abundance-weighted WHPT score for simulated sample r</p>
</div>
<div class="section level3" number="10.11">
<h3 id="correct-observed-values-for-bias">
<span class="header-section-number">10.11</span> Correct observed
values for bias<a class="anchor" aria-label="anchor" href="#correct-observed-values-for-bias"></a>
</h3>
<p>(Step 9 in process diagram above)</p>
<p><img src="images/rict-classification-9.png" width="200"></p>
<p>The aim of this step is to use the values provided in the previous
steps, add them together to give an overall calculated observed value
corrected for Bias. Bias is a measure of the impact of laboratory error
on the value of observed indices. It is calculated from audits of
laboratory performance and is input by users as described in Section 8.6
above.</p>
<p>The main algorithm used is:</p>
<p>ObsIDX<sub>irB</sub> = ObsIDX<sub>ir</sub> + Ubias<sub>ir</sub></p>
<p>Where:</p>
<p>ObsIDX<sub>irB</sub> = Bias corrected observed value<br>
ObsIDX<sub>ir</sub> = Simulated observed value from Section 8.7
above<br>
Ubias<sub>ir</sub> = Simulated Bias value from Section 8.8 above</p>
<p>Within RICT, these calculations are done using functions which can be
found in the ClassificationfunctionsV2 (within the classification
support files folder).</p>
<p>The algorithms used within this function are as below which is copied
from Section 6.3.3.3 of the WHPT and other Abundance-Weighted Indices
SEPA Report.</p>
<p>ObsIDX<sub>7rB</sub> = ObsIDX<sub>7r</sub> + Ubias<sub>7r</sub> =
bias-corrected observed abundance-weighted WHPT Score for simulation
r<br>
ObsIDX<sub>8rB</sub> = ObsIDX<sub>8r</sub> + Ubias<sub>8r</sub> =
bias-corrected observed abundance-weighted WHPT NTAXA for simulation
r<br>
ObsIDX<sub>9rB</sub> = ObsIDX<sub>7rB</sub> / ObsIDX<sub>8rB</sub> =
bias-corrected observed abundance-weighted WHPT ASPT for simulation
r</p>
<p>It should be noted as mentioned previously, that it is important to
do this for each index and also be aware of the numbering for each
index. As indicated above, each index has a number, i.e.:</p>
<ul>
<li>WHPT Score (index 7)</li>
<li>WHPT NTAXA (index 8)</li>
<li>WHPT ASPT (index 9)</li>
</ul>
<p>Optionally, the simulated EQRs are stored for each metric at this
point if required for Compare.</p>
</div>
<div class="section level3" number="10.12">
<h3 id="calculate-environmental-quality-ratio-eqr">
<span class="header-section-number">10.12</span> Calculate
Environmental Quality Ratio (EQR)<a class="anchor" aria-label="anchor" href="#calculate-environmental-quality-ratio-eqr"></a>
</h3>
<p>(Step 10 in process diagram above)</p>
<p><img src="images/rict-classification-10.png" width="200"></p>
<p>The aim of this step is to express the observed value of the index as
an indication of human impact by removing the effect of natural
environmental conditions.</p>
<p>Status class boundaries for WFD are expressed as EQRs.</p>
<p>Simulated EQRs, based on simulated observed and expected values, are
needed to estimate probabilities of class.</p>
<p>The main algorithm used is:</p>
<p>(EQRirB = (ObsIDXirB ÷ ExpIDX<sub>Ref,ir</sub>)</p>
<p>Where:</p>
<p>EQR<sub>irB</sub> = simulated bias-corrected EQR value for index
i</p>
<p>ObsIDX<sub>irB</sub> = Bias-corrected observed value of index i for
simulation r as calculated in section 8.9.</p>
<p>ExpIDX<sub>Ref,ir</sub> = Reference-adjusted Expected value of index
i in simulation r as calculated in section 8.5.</p>
<p>This calculation is done directly within RICT code and not via any
function.</p>
</div>
<div class="section level3" number="10.13">
<h3 id="combine-spring-and-autumn-eqrs">
<span class="header-section-number">10.13</span> Combine spring and
autumn EQRs<a class="anchor" aria-label="anchor" href="#combine-spring-and-autumn-eqrs"></a>
</h3>
<p>(Step 11 in process diagram above)</p>
<p><img src="images/rict-classification-11.png" width="200"></p>
<p>The aim of this step is to increase precision of classification and
take account of seasonal variations in environmental quality.</p>
<p>The WFD status must be based on EQRs calculated from spring and
autumn samples. These values must be calculated and available for this
step to calculate the seasonal average.</p>
<p>The EQR values for spring and autumn samples are divided by the
number of season (i.e. 2) to calculate the seasonal average for each
simulation. The main algorithm is:</p>
<p>EQR<sub>irB,SpSuAu</sub> = (EQR<sub>irB,Sp</sub> +
EQR<sub>irB,Au</sub>) / 2</p>
<p>Where:</p>
<p>EQR<sub>irB,SpSuAu</sub> = Season average EQR</p>
<p>EQR<sub>irB,Sp</sub> = EQR value for spring season as calculated in
section 8.10</p>
<p>EQR<sub>irB,Au</sub> = EQR value for autumn season as calculated in
section 8.10</p>
<p>This is calculated in RICT using the <code>getAvgEQR_SpAut()</code>
function found in the <code>classification-functions.R</code> (within
the classification support files folder).</p>
</div>
<div class="section level3" number="10.14">
<h3 id="determine-the-probability-of-the-class">
<span class="header-section-number">10.14</span> Determine the
probability of the class<a class="anchor" aria-label="anchor" href="#determine-the-probability-of-the-class"></a>
</h3>
<p>(Step 12 in process diagram above)</p>
<p><img src="images/rict-classification-12.png" width="200"></p>
<p>The aim of this step is to take account of imprecision in monitoring
data in the classification.</p>
<p>The probability of each class is simply the sum of the simulations
resulting in that class and is included in the output file.</p>
<p>As copied from Section 6.5 of the WHPT and other Abundance-Weighted
Indices SEPA Report:</p>
<blockquote>
<p>“Confidence of class - The likelihood of the true status class
(i.e. averaged across all possible samples) of a test site being each of
the five possible WFD classes is estimated simply by applying the
‘status classification method’ to each simulation sample r in turn. Thus
the class for simulation r is based on the EQI/EQR values for simulation
r, namely the set of EQIir. For each index and overall, the proportion
of simulations assigned to a status class estimates the probability that
the true (average) quality of the test site for that time period was of
that ecological status class (based on its macroinvertebrates).”</p>
</blockquote>
<p>So to summarise, the probability of each class is simply the sum of
the simulations resulting in that class and this data is calculated and
then included in the output file.</p>
</div>
<div class="section level3" number="10.15">
<h3 id="determine-the-worst-overall-class">
<span class="header-section-number">10.15</span> Determine the worst
overall class<a class="anchor" aria-label="anchor" href="#determine-the-worst-overall-class"></a>
</h3>
<p>(Step 13 in process diagram above)</p>
<p><img src="images/rict-classification-13.png" width="200"></p>
<p>The aim for this step is to ensure that the classification reflects
ecological impacts caused by any type of environmental pressure.</p>
<p>The overall status class for a sample is defined to be the worst of
classification based on number of taxa and ASPT. This is referred to as
the MINTA class (i.e. MINimum of classes based on number of Taxa and
ASPT).</p>
<p>The WFD status of a site or water body is based on the worst class
indicated by either WHPT ASPT or WHPT Ntaxa, following the ‘one out all
out’ rule.</p>
<p>The WFD requires that all water bodies, including rivers sites, are
classified into one of five ecological status class. These classes in
RICT are coded as classes 1-5 with 1= ‘high’, 2=‘good’, 3=‘moderate’,
4=‘poor’ and 5=‘bad’.</p>
<p>There are a number of processes involved in this step as described
below:</p>
<ul>
<li>The EQR values calculated in section 10 above are used within the
<code>getClassarray_ntaxa()</code> and <code>getClassarray_aspt()</code>
function found in the <code>classification-functions.R</code> to find
the class and relevant boundary limit values.</li>
<li>The <code>getMostProbableClass()</code> function found in the
<code>classification-functions.R</code> is used to find the most
probable class.<br>
</li>
<li>The <code>getMINTA_ntaxa_aspt()</code> function found in the
<code>classification-functions.R</code> is used to find the maximum of
the two classes and which is the worst class. The worst class in then
recorded in the output file and displayed in the MINTA column</li>
</ul>
</div>
<div class="section level3" number="10.16">
<h3 id="classification-output">
<span class="header-section-number">10.16</span> Classification
output<a class="anchor" aria-label="anchor" href="#classification-output"></a>
</h3>
<p>An output file will be created to show the calculated data results
for prediction and classification. The output file will also indicate
any validation errors found during the run and specify which values
resulted in either a “fail” or “warn”.</p>
<p>The output file will be in csv format to be downloaded by the user
and used for reporting. There will be an output file available for
prediction and an output file available for classification.</p>
</div>
</div>
<div class="section level2" number="11">
<h2 id="multi-year-classification">
<span class="header-section-number">11</span> Multi Year
Classification<a class="anchor" aria-label="anchor" href="#multi-year-classification"></a>
</h2>
<p>The aim of multi-year is to take account of temporary differences in
quality and improve precision if a user has more than one year of sample
data.</p>
<p>River Invertebrate status must be assessed every 3 years for WFD.
Where sites are sampled in a 3 year monitoring cycle, WFD status can be
based on samples collected in more than one year.</p>
<p>Multi-year status classification takes account of inter-year
variation based on observations from specific rivers and streams.</p>
<p>The multi-year classification will need to following:</p>
<ul>
<li>Assessment is always on a 3 year period.</li>
<li>Users may supply 1, 2 or 3 years data.</li>
<li>A complete year’s data must include spring and autumn – otherwise
this year cannot be included in the assessment.</li>
<li>Therefore minimum requirement is 1 year of data which includes
spring and autumn.</li>
<li>Each year will be added as a separate row on the input file and for
each year of data will have the same site name</li>
<li>RICT will check each row to see if it is same site name, if it is
will store the simulations and include this in the assessment and will
carry out this check for the next row to collect a maximum of 3 years of
data.</li>
<li>There will be no changes needed to the input file as the user will
select the multi-year option.</li>
<li>Ralph will be able to obtain some test data which can be used to
clarify if the calculations are correct.</li>
<li>Output file will need to be amended to display the multi-year data
and will display the term “multi-year” instead of the actual year in the
Year column.</li>
<li>Apart from the differences highlighted above, the multi-year
classification will follow the same process at the Prediction and
Classification procedures specified in the previous sections of this
document.</li>
</ul>
<p>We assume simple averaging based on the same number of samples
involved in each year, but not necessarily the same seasons. There is
therefore no problem (from a statistical point of view) if spring one
year and autumn the next, but we do have a problem if year 1 = single
season and Year 2 = 2-season classification. Basically, we assume the
same sampling effort each year. However, remember that official WFD
status classification must always be based on 2-season spring + autumn
data.</p>
</div>
<div class="section level2" number="12">
<h2 id="multi-site-classification">
<span class="header-section-number">12</span> Multi-site
classification<a class="anchor" aria-label="anchor" href="#multi-site-classification"></a>
</h2>
<p>The aim of multi-site classification is to determine the overall
status class for a water body based on samples collected from more than
one site. The Environment Agency collects samples from some water bodies
from more than one site.</p>
<p>The Environment Agency currently uses VISCOUS software to calculate
WFD status for water bodies monitored from more than one site, as well
as sites sampled in more than one year before 2019. Multi-site will
allow the Environment Agency to replace VISCOUS completely, and
therefore streamline the classification process.</p>
<p>Multi-site classification uses similar algorithms to multi-year
classification. Additionally, its output indicates which sites have been
used.</p>
<p>As with multi-year, we assume simple averaging based on the same
number of samples involved in each year within the water body (not
necessarily the same seasons). There is therefore no problem (from the
point of view of multi-year classification) if spring one year and
autumn the next, but we do have a problem if year 1 = single season and
Year 2 = 2-season classification. Basically, we assume the same sampling
effort each year. However, remember that official WFD status
classification must always be based on 2-season spring + autumn
data.</p>
</div>
<div class="section level2" number="13">
<h2 id="compare">
<span class="header-section-number">13</span> Compare<a class="anchor" aria-label="anchor" href="#compare"></a>
</h2>
<p>The relevant parts of the algorithms section of the SNIFFER WFD72C
project 2008 Final Report have been extracted and adapted here to
explain the algorithms needed to code the Compare procedure in R.</p>
<p>The new RICT only refers to EQR values (which are bias-corrected
observed (Obs) values divided by WFD reference-adjusted Expected
(ExpRef) values, all WFD72C algorithms section references to former EQI
(Obs/Exp) values are replaced by their new counterpart EQR values to
improve explanation of how to program the new RICT Compare
procedure.</p>
<p>Compare flow chart:</p>
<p><img src="images/rict-compare.png"></p>
<p>The Compare procedure allows the user to assess whether there is a
real difference in EQR values and/or status class between a pair of
samples and/or sites and/or time periods. This is done using an
extension of the simulation techniques and algorithms described above
that are used to assess the EQRs and ecological status class and the
associated uncertainty for individual samples/sites and time
periods.</p>
<p>The first sample in a pair is known as result A and the second as
result B.</p>
<p>In each simulation r, independent simulated EQR values are calculated
for each index i for each of the two results using the methods described
in section 8.9 Correct observed values for bias. In this context,
independent simulations means that the various random uncertainty terms
are different and completely independent for the two simulated samples A
and B for any simulation r.</p>
<p>To compare results, the two input files into Compare must contain the
same number of rows. The two files are then compared pair-wise, row to
row for each result. For instance, if comparing a single upstream result
to multiple downstream results, repeat the single result over multiple
rows (equal to the number of downstream results) in the input file.</p>
<p>Note, Compare allows individual-season estimates of class for spring
and autumn to be compared.</p>
<p><strong>Calculate Difference and Related Statistics:</strong></p>
<p>Average EQR for Results A = mean(EQR<sub>A</sub>)</p>
<p>Average EQR for Results B = mean(EQR<sub>B</sub>)</p>
<p>Average EQR: Difference (B- A) (DiffEQRirB) = EQR<sub>B</sub> –
EQR<sub>A</sub></p>
<p>For each simulation r, the difference in the two simulated EQR values
(sample B value minus sample A value) is calculated for each index i to
give DiffEQRirB when corrected for bias.</p>
<p>Standard Deviation of Difference = SD of the rN simulated values of
EQI<sub>i</sub> (corrected for bias) for index i for the current test
site</p>
<p>Calculate the SD, (SDEQR<sub>i</sub>) of the rN values of
EQR<sub>ir</sub> in the usual way for calculating any SD.</p>
<p>Lower 95% (L95) of Difference = Lower 2.5 percentile of the rN
simulated values (EQR<sub>ir</sub>) of EQR (corrected for bias) for
index i for the current test site</p>
<p>Upper 95% (U95) of Difference = Upper 2.5 percentile of the rN
simulated values (EQR<sub>ir</sub>) of EQR</p>
<p>Determine the lower and upper 2.5 percentiles and thus 95% confidence
limits by sorting all of the rN simulated EQRir values into order from
smallest to largest. Then the lower and upper percentiles are given by
the mL and mU smallest values, where:</p>
<p>mL = nearest integer to 0.025 * (<em>rN</em> + 1)</p>
<p>mU = nearest integer to 0.975 * (<em>rN</em> + 1)</p>
<p>For the recommended <em>rN</em> = 9999, mL = 250 and mU = 9750.</p>
<p>Confidence (and statistical test) of change/difference in EQR:</p>
<p>Confidence limits for the difference in EQR values are obtained from
the frequency distribution of the differences (DiffEQRir) using the same
approach as for single sample EQR values described above, namely, order
the differences from smallest to largest and find the 2.5 and 97.5
percentile values of the order distribution.</p>
<p>Strictly speaking we can’t do a normal type of statistical test for
the statistical significance of the difference (DiffEQRir) in EQR
because we only actually have one sample on each occasion with no
actually replication. However, we can generate a type of statistical
test using the simulated EQI values, or more specifically, the frequency
distribution of the simulated differences (DiffEQRir).</p>
<p>PDiff0 = proportion of simulated differences less than or equal to
zero.</p>
<p>PDiff1 = proportion of simulated differences greater than or equal to
zero.</p>
<p><strong>2-sided test probability p of No difference in EQR
(PDiff)</strong> = 2 * minimum of (PDiff0, PDiff1)</p>
<p>Then PDiff is the two-sided test probability of the null hypothesis
of no difference in true EQR values between the sites and/or times from
which the two samples were taken. [True EQR for a site, in this sense,
means average EQI amongst all possible samples from the sites as
estimated from the simulated values of EQR].</p>
<p>Code to calculate the difference and related statistics can be found
in the compare_test() function. Note, that the simulated EQRs are
randomly re-ordered (using set.seed). This is because the simulate EQRs
are created in the rict_classify() using the same set.seed and will have
equal variance add to each simulated EQR. Therefore, if we calculate the
difference without re-ordering the result will be zero. In other words,
the difference will cancel out. By re-ordering, we ensure the there will
be a difference for each pair of EQRs compared.</p>
<p>Confidence of change in status class:</p>
<p>Each of the two simulated samples is assigned to a status class by
applying the ‘status classification method’ independently to the
simulated EQR values for each sample for that simulation. This is done
repeatedly in rN simulations to build up a two-way frequency (and hence
probability) distribution that the site (in its time period) from which
sample A was taken was of status class ‘x’ (say) and the sites (in its
time period) from which sample B was taken was of class ‘y’.</p>
<p>From this two-way probability distribution, the probability that
samples A and B are from the same quality band can be estimated,
together with the probabilities that sample B is one band better than A,
one band worse, two or more bands better, or two or more bands
worse.</p>
<p>In terms of RICT software, a 5 x 5 probability tables of changes is
calculated internally using compare_probability() function. This is done
for each index for which class limits are to be used and for each
multi-index MINTA classification method.</p>
<p>In each case, a wide range of outputs are derived from this table and
presented to the user as listed below.</p>
<p>If for coding purposes classes ‘high’ to ‘bad’ are referred to as
classes 1-5 respectively, then</p>
<p>PrChij = Proportion of simulations for which simulated sample A was
classified as class i and simulated sample B was classified as class
j.</p>
<p>= Estimated probability of change in status from class i to class
j</p>
<table class="table">
<colgroup>
<col width="27%">
<col width="25%">
<col width="9%">
<col width="8%">
<col width="9%">
<col width="8%">
<col width="9%">
</colgroup>
<thead><tr class="header">
<th></th>
<th>Status class of sample B</th>
<th></th>
<th></th>
<th></th>
<th></th>
<th></th>
</tr></thead>
<tbody>
<tr class="odd">
<td></td>
<td></td>
<td>high (1)</td>
<td>good (2)</td>
<td>mod (3)</td>
<td>poor (4)</td>
<td>bad (5)</td>
</tr>
<tr class="even">
<td><strong>Status class of sample A</strong></td>
<td>high (1)</td>
<td>PrCh<sub>11</sub>
</td>
<td>PrCh<sub>12</sub>
</td>
<td>PrCh<sub>13</sub>
</td>
<td>PrCh<sub>14</sub>
</td>
<td>PrCh<sub>15</sub>
</td>
</tr>
<tr class="odd">
<td></td>
<td>good (2)</td>
<td>PrCh<sub>21</sub>
</td>
<td>PrCh<sub>22</sub>
</td>
<td>PrCh<sub>23</sub>
</td>
<td>PrCh<sub>24</sub>
</td>
<td>PrCh<sub>25</sub>
</td>
</tr>
<tr class="even">
<td></td>
<td>mod (3)</td>
<td>PrCh<sub>31</sub>
</td>
<td>PrCh<sub>32</sub>
</td>
<td>PrCh<sub>33</sub>
</td>
<td>PrCh<sub>34</sub>
</td>
<td>PrCh<sub>35</sub>
</td>
</tr>
<tr class="odd">
<td></td>
<td>poor (4)</td>
<td>PrCh<sub>41</sub>
</td>
<td>PrCh<sub>42</sub>
</td>
<td>PrCh<sub>43</sub>
</td>
<td>PrCh<sub>44</sub>
</td>
<td>PrCh<sub>45</sub>
</td>
</tr>
<tr class="even">
<td></td>
<td>bad (5)</td>
<td>PrCh<sub>51</sub>
</td>
<td>PrCh<sub>52</sub>
</td>
<td>PrCh<sub>53</sub>
</td>
<td>PrCh<sub>54</sub>
</td>
<td>PrCh<sub>55</sub>
</td>
</tr>
</tbody>
</table>
<p>Find the most frequent class (random pick if equal frequency across
two or more classes):</p>
<p><strong>Most* Probable Class for Result A</strong> = most frequency
class (status classification method(EQRA))</p>
<p><strong>Probability of most likely class for Result A</strong> =
Proportion in most probable class</p>
<p><strong>Probability of most likely class for Result B</strong> = most
frequency class (status classification method(EQRB))</p>
<p><strong>Probability of most likely class for Result B</strong> =
Proportion in most probable class</p>
<p>Probability status class of result(s) from which results A and B were
taken is:</p>
<p>Both status class i = PrChii</p>
<p><strong>Probability B more than one class Worse than A</strong> = sum
of all { PrChij } for which j &gt; i + 1</p>
<p><strong>Probability B one class Worse than A</strong> = sum of all {
PrChij } for which j = i + 1</p>
<p><strong>Probability B same Class as A</strong> = PrCh11 + PrCh22 +
PrCh33 + PrCh44 + PrCh55</p>
<p><strong>Probability B one class Better than A</strong> = sum of all {
PrChij } for which j = i – 1</p>
<p><strong>Probability B more than one class Better than A</strong> =
sum of all { PrChij } for which j &lt; I - 1</p>
<p>Furthermore – extract each output from probability table in this
order:</p>
<p><strong>Probability Result A in High &amp; Result B in
High</strong><br><strong>Probability Result A in High &amp; Result B in Good</strong>
<strong>Probability Result A in High &amp; Result B in
Moderate</strong><br><strong>Probability Result A in High &amp; Result B in Poor
</strong><br><strong>Probability Result A in High &amp; Result B in Bad
</strong><br><strong>Probability Result A in Good &amp; Result B in High
</strong><br><strong>Probability Result A in Good &amp; Result B in Good
</strong><br><strong>Probability Result A in Good &amp; Result B in Moderate
</strong><br><strong>Probability Result A in Good &amp; Result B in Poor
</strong><br><strong>Probability Result A in Good &amp; Result B in Bad
</strong><br><strong>Probability Result A in Moderate &amp; Result B in High
</strong><br><strong>Probability Result A in Moderate &amp; Result B in Good
</strong> <strong>Probability Result A in Moderate &amp; Result B in
Moderate</strong><br><strong>Probability Result A in Moderate &amp; Result B in
Poor</strong><br><strong>Probability Result A in Moderate &amp; Result B in Bad</strong>
<strong>Probability Result A in Poor &amp; Result B in
High</strong><br><strong>Probability Result A in Poor &amp; Result B in
Good</strong><br><strong>Probability Result A in Poor &amp; Result B in
Moderate</strong><br><strong>Probability Result A in Poor &amp; Result B in
Poor</strong><br><strong>Probability Result A in Poor &amp; Result B in
Bad</strong><br><strong>Probability Result A in Bad &amp; Result B in
High</strong><br><strong>Probability Result A in Bad &amp; Result B in
Good</strong><br><strong>Probability Result A in Bad &amp; Result B in
Moderate</strong><br><strong>Probability Result A in Bad &amp; Result B in
Poor</strong><br><strong>Probability Result A in Bad &amp; Result B in Bad</strong></p>
<p>Pivot all calculated variables (in bold above) to give one column per
variable. Each row represents a pair of classification results.</p>
</div>
<div class="section level2" number="14">
<h2 id="model-44-prediction-and-classification">
<span class="header-section-number">14</span> Model 44 Prediction
and Classification<a class="anchor" aria-label="anchor" href="#model-44-prediction-and-classification"></a>
</h2>
<p>The Centre for Ecology and Hydrology (CEH) have produced a database
of GIS environmental variables data for every 50m of steam or river for
use with the new RIVPACS GB Model M44. T</p>
<p>This database will have a map-based location checker, to enable users
to check that the Ordnance survey grid reference that they enter returns
data for the catchment that they intended. Many monitoring sites are at
the downstream end of rivers close to tributaries, so small error in the
grid reference or GIS river line can cause the system to return data for
the wrong river, and the database holds data only for one river within
each 50m grid. The database holds all the environmental data for Model
44, derived from GIS, including discharge category but not including
alkalinity.</p>
<p>This database has been hosted by <strong>Add details
here</strong></p>
<p>This model produced by Ralph Clark and John Davey Bowker and based on
these predictive variables is detailed in the report ‘GIS Re-calibration
of the hydromorphology-independent RIVPACS predictive model (M37): new
model M44’.</p>
<p>RICT will be used with the new RIVPACS Model 44 to give better
predictions of streams impacted by siltation due to flow alteration.</p>
<p>The majority of the coding that has been done in RICT for prediction
and classification will also be suitable when running Model 44
prediction and classification.</p>
<p>With minor adjustments, the RICT prediction and classification code
is suitable for running both Model 1 and Model 44.</p>
<p>The main areas of development involved understanding how to extract
the data from RIVPACS and to link to a location checker as outlined in
the picture below:</p>
<div class="section level3" number="14.1">
<h3 id="model-44-validation">
<span class="header-section-number">14.1</span> Model 44
Validation<a class="anchor" aria-label="anchor" href="#model-44-validation"></a>
</h3>
<p>The GIS input file spreadsheet may be needed for these values (tbc).
However, it should be noted that these values will be provided by the
model and not entered by a user.</p>
<p>Detailed validation requirements for model 44 are outlined in the
acceptance and validation - section 5 of this document.</p>
</div>
<div class="section level3" number="14.2">
<h3 id="discriminant-function-scores">
<span class="header-section-number">14.2</span> Discriminant
function scores<a class="anchor" aria-label="anchor" href="#discriminant-function-scores"></a>
</h3>
<p>Another difference is that there are now 17 discriminant function
scores and discriminant function end group means scores rather than 13.
See supporting files:</p>
<ul>
<li>discrimant-function-coefficients-model-44.csv</li>
<li>end-group-means-discriminant-scores-model-44.csv</li>
</ul>
</div>
<div class="section level3" number="14.3">
<h3 id="summary-diagrams">
<span class="header-section-number">14.3</span> Summary
diagrams<a class="anchor" aria-label="anchor" href="#summary-diagrams"></a>
</h3>
<p>The flow diagram below summarises the prediction process and
calculations as well as identifying the relevant report for further
information:</p>
<p><img src="images/rict-prediction-model-44.png" width="650"></p>
<p>The flow diagram below summarises the classification process and
calculations as well as identifying the relevant report for further
information:</p>
<p><img src="images/rict-classification-model-44.png" width="650"></p>
</div>
</div>
<div class="section level2" number="15">
<h2 id="non-functional-requirements">
<span class="header-section-number">15</span> Non-Functional
Requirements<a class="anchor" aria-label="anchor" href="#non-functional-requirements"></a>
</h2>
<div class="section level3" number="15.1">
<h3 id="operational-support">
<span class="header-section-number">15.1</span> Operational
Support<a class="anchor" aria-label="anchor" href="#operational-support"></a>
</h3>
<p>The tool needs to be freely available for anyone to access
online.</p>
<p>User support for EA users will be via the Defra service desk (at Tier
4 service level) who will route the issue to the appropriate team to
deal with. This routing could be to RICT support email or to the
Environmental systems team depending on the nature of the issue. EA
users will also be able to access an article in MyIT which will provide
FAQs to help users with common issues.</p>
<p>User support for other UK regulatory agency users will be via the
support email box called RICT support.</p>
<p>There will be no official contracted support for external users but
they can send issues and comments to the RICT support inbox</p>
</div>
<div class="section level3" number="15.2">
<h3 id="look-and-feel-of-user-interface">
<span class="header-section-number">15.2</span> Look and Feel of
User Interface<a class="anchor" aria-label="anchor" href="#look-and-feel-of-user-interface"></a>
</h3>
<p>The user interface will provide intuitive and ‘user friendly’.</p>
</div>
<div class="section level3" number="15.3">
<h3 id="input-and-output-files">
<span class="header-section-number">15.3</span> Input and Output
Files<a class="anchor" aria-label="anchor" href="#input-and-output-files"></a>
</h3>
<p>Input files will be a standard template in Excel which can be
downloaded, completed by the user and then uploaded as a CSV file to
RICT. A user guide will be available to help users understand and
complete the input file.</p>
<p>The output file will be produced by RICT as a CSV file following the
run. A CSV file can easily be opened in Excel or other applications to
view the results.</p>
</div>
<div class="section level3" number="15.4">
<h3 id="hosting">
<span class="header-section-number">15.4</span> Hosting<a class="anchor" aria-label="anchor" href="#hosting"></a>
</h3>
<p>RICT web app is cloud hosted by Posit. The code is hosted on
Github.</p>
</div>
<div class="section level3" number="15.5">
<h3 id="accessibility">
<span class="header-section-number">15.5</span> Accessibility<a class="anchor" aria-label="anchor" href="#accessibility"></a>
</h3>
<p>Access to RICT functionality may be required by a number of different
device types. RICT will be use-able at a minimum by the following device
types (model not specified):</p>
<ul>
<li>Desktop</li>
<li>Laptop</li>
</ul>
<p>Access to RICT functionality may be required by a number of different
browser types. RICT will be use-able in the following browser types:</p>
<ul>
<li>Chrome</li>
<li>Firefox</li>
<li>Edge</li>
</ul>
<p>Users will only have access to their own data and cannot access data
input or output from other users.</p>
</div>
<div class="section level3" number="15.6">
<h3 id="performance">
<span class="header-section-number">15.6</span> Performance<a class="anchor" aria-label="anchor" href="#performance"></a>
</h3>
<p>RICT will be accessible by multiple concurrent users at any one time
without degradation of performance or limitation of features. Users will
be internal EA, other UK regulatory body users (SEPA, NRW and NIEA) and
external users.</p>
<p>RICT will be capable of processing the prediction and classification
of a very large number of sites (approx. 5,000) once per year.</p>
<p>RICT will meet the following rough order estimates of service usage
and performance requirements:</p>
<ul>
<li>Service Availability: In excess of 97% at all times;</li>
<li>Service Recovery: RTO (Recovery Time Objective) in 48 hours;</li>
<li>Maximum Nos. of Users: &lt;1000;</li>
<li>Max number of Concurrent Users: 50.</li>
</ul>
<p>RICT availability must be at an acceptable level. Planned downtime
for maintenance must be advised in advance (minimum 48 hours’ notice).
Unplanned downtime must be communicated regularly with up to date
information on tools/services affected and projected downtime.</p>
</div>
<div class="section level3" number="15.7">
<h3 id="system-administration">
<span class="header-section-number">15.7</span> System
Administration<a class="anchor" aria-label="anchor" href="#system-administration"></a>
</h3>
<p>Updates to documentation, web app or input template are made via
Github but the R developer appointed by the RICT group.</p>
</div>
<div class="section level3" number="15.8">
<h3 id="data-protection">
<span class="header-section-number">15.8</span> Data Protection<a class="anchor" aria-label="anchor" href="#data-protection"></a>
</h3>
<p>Data protection requirements are handled by Posit as the tool is
hosted on Posit cloud. No name or email is required to access the
site.</p>
</div>
</div>
<div class="section level2" number="16">
<h2 id="annex-a-input-file">
<span class="header-section-number">16</span> Annex A: Input
File<a class="anchor" aria-label="anchor" href="#annex-a-input-file"></a>
</h2>
<p>Below are examples of the import file format to help understand and
verify the format to used.</p>
<p>GB - Model 1 input format</p>
<table class="table">
<thead><tr class="header">
<th align="left"></th>
<th align="left">1</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">SITE</td>
<td align="left">MYR-GB-01-R</td>
</tr>
<tr class="even">
<td align="left">Waterbody</td>
<td align="left">Waterbody name</td>
</tr>
<tr class="odd">
<td align="left">Year</td>
<td align="left">2016</td>
</tr>
<tr class="even">
<td align="left">NGR</td>
<td align="left">SE</td>
</tr>
<tr class="odd">
<td align="left">Easting</td>
<td align="left">94200</td>
</tr>
<tr class="even">
<td align="left">Northing</td>
<td align="left">91000</td>
</tr>
<tr class="odd">
<td align="left">Altitude</td>
<td align="left">60</td>
</tr>
<tr class="even">
<td align="left">Slope</td>
<td align="left">2.7</td>
</tr>
<tr class="odd">
<td align="left">Discharge</td>
<td align="left">2</td>
</tr>
<tr class="even">
<td align="left">Velocity</td>
<td align="left">NA</td>
</tr>
<tr class="odd">
<td align="left">Dist_from_Source</td>
<td align="left">10</td>
</tr>
<tr class="even">
<td align="left">Mean_Width</td>
<td align="left">6.4</td>
</tr>
<tr class="odd">
<td align="left">Mean_Depth</td>
<td align="left">21.7</td>
</tr>
<tr class="even">
<td align="left">Alkalinity</td>
<td align="left">101.4</td>
</tr>
<tr class="odd">
<td align="left">Boulder_Cobbles</td>
<td align="left">58</td>
</tr>
<tr class="even">
<td align="left">Pebbles_Gravel</td>
<td align="left">36</td>
</tr>
<tr class="odd">
<td align="left">Sand</td>
<td align="left">3</td>
</tr>
<tr class="even">
<td align="left">Silt_Clay</td>
<td align="left">1</td>
</tr>
<tr class="odd">
<td align="left">Hardness</td>
<td align="left">NA</td>
</tr>
<tr class="even">
<td align="left">Calcium</td>
<td align="left">NA</td>
</tr>
<tr class="odd">
<td align="left">Conductivity</td>
<td align="left">NA</td>
</tr>
<tr class="even">
<td align="left">Spr_Season_ID</td>
<td align="left">1</td>
</tr>
<tr class="odd">
<td align="left">Spr_TL2_WHPT_ASPT (AbW,DistFam)</td>
<td align="left">6.512</td>
</tr>
<tr class="even">
<td align="left">Spr_TL2_WHPT_NTaxa (AbW,DistFam)</td>
<td align="left">24</td>
</tr>
<tr class="odd">
<td align="left">Spr_Ntaxa_Bias</td>
<td align="left">1.62</td>
</tr>
<tr class="even">
<td align="left">Sum_Season_ID</td>
<td align="left">2</td>
</tr>
<tr class="odd">
<td align="left">Sum_TL2_WHPT_ASPT (AbW,DistFam)</td>
<td align="left">6.663</td>
</tr>
<tr class="even">
<td align="left">Sum_TL2_WHPT_NTaxa (AbW,DistFam)</td>
<td align="left">27</td>
</tr>
<tr class="odd">
<td align="left">Sum_Ntaxa_Bias</td>
<td align="left">1.62</td>
</tr>
<tr class="even">
<td align="left">Aut_Season_ID</td>
<td align="left">3</td>
</tr>
<tr class="odd">
<td align="left">Aut_TL2_WHPT_ASPT (AbW,DistFam)</td>
<td align="left">6.348</td>
</tr>
<tr class="even">
<td align="left">Aut_TL2_WHPT_NTaxa (AbW,DistFam)</td>
<td align="left">27</td>
</tr>
<tr class="odd">
<td align="left">Aut_Ntaxa_Bias</td>
<td align="left">1.62</td>
</tr>
</tbody>
</table>
<p>NI - Model 1 input format</p>
<table class="table">
<thead><tr class="header">
<th align="left"></th>
<th align="left">1</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">SITE</td>
<td align="left">TST-NI-01-R</td>
</tr>
<tr class="even">
<td align="left">Waterbody</td>
<td align="left">Waterbody name</td>
</tr>
<tr class="odd">
<td align="left">Year</td>
<td align="left">2018</td>
</tr>
<tr class="even">
<td align="left">NGR</td>
<td align="left">H</td>
</tr>
<tr class="odd">
<td align="left">Easting</td>
<td align="left">24720</td>
</tr>
<tr class="even">
<td align="left">Northing</td>
<td align="left">36350</td>
</tr>
<tr class="odd">
<td align="left">Altitude</td>
<td align="left">85</td>
</tr>
<tr class="even">
<td align="left">Slope</td>
<td align="left">1.3</td>
</tr>
<tr class="odd">
<td align="left">Discharge</td>
<td align="left">4</td>
</tr>
<tr class="even">
<td align="left">Velocity</td>
<td align="left">NA</td>
</tr>
<tr class="odd">
<td align="left">Dist_from_Source</td>
<td align="left">16.4</td>
</tr>
<tr class="even">
<td align="left">Mean_Width</td>
<td align="left">9</td>
</tr>
<tr class="odd">
<td align="left">Mean_Depth</td>
<td align="left">34</td>
</tr>
<tr class="even">
<td align="left">Alkalinity</td>
<td align="left">97.8</td>
</tr>
<tr class="odd">
<td align="left">Boulder_Cobbles</td>
<td align="left">55</td>
</tr>
<tr class="even">
<td align="left">Pebbles_Gravel</td>
<td align="left">15</td>
</tr>
<tr class="odd">
<td align="left">Sand</td>
<td align="left">25</td>
</tr>
<tr class="even">
<td align="left">Silt_Clay</td>
<td align="left">5</td>
</tr>
<tr class="odd">
<td align="left">Hardness</td>
<td align="left">NA</td>
</tr>
<tr class="even">
<td align="left">Calcium</td>
<td align="left">NA</td>
</tr>
<tr class="odd">
<td align="left">Conductivity</td>
<td align="left">NA</td>
</tr>
<tr class="even">
<td align="left">Spr_Season_ID</td>
<td align="left">1</td>
</tr>
<tr class="odd">
<td align="left">Spr_TL2_WHPT_ASPT (AbW,DistFam)</td>
<td align="left">6.038</td>
</tr>
<tr class="even">
<td align="left">Spr_TL2_WHPT_NTaxa (AbW,DistFam)</td>
<td align="left">26</td>
</tr>
<tr class="odd">
<td align="left">Spr_Ntaxa_Bias</td>
<td align="left">1.62</td>
</tr>
<tr class="even">
<td align="left">Sum_Season_ID</td>
<td align="left">2</td>
</tr>
<tr class="odd">
<td align="left">Sum_TL2_WHPT_ASPT (AbW,DistFam)</td>
<td align="left">5.041</td>
</tr>
<tr class="even">
<td align="left">Sum_TL2_WHPT_NTaxa (AbW,DistFam)</td>
<td align="left">22</td>
</tr>
<tr class="odd">
<td align="left">Sum_Ntaxa_Bias</td>
<td align="left">1.62</td>
</tr>
<tr class="even">
<td align="left">Aut_Season_ID</td>
<td align="left">3</td>
</tr>
<tr class="odd">
<td align="left">Aut_TL2_WHPT_ASPT (AbW,DistFam)</td>
<td align="left">4.935</td>
</tr>
<tr class="even">
<td align="left">Aut_TL2_WHPT_NTaxa (AbW,DistFam)</td>
<td align="left">23</td>
</tr>
<tr class="odd">
<td align="left">Aut_Ntaxa_Bias</td>
<td align="left">1.62</td>
</tr>
</tbody>
</table>
<p>GIS - Model 44 input format</p>
<table class="table">
<thead><tr class="header">
<th align="left"></th>
<th align="left">1</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">SITE</td>
<td align="left">TST-GB-01-R</td>
</tr>
<tr class="even">
<td align="left">YEAR</td>
<td align="left">2019</td>
</tr>
<tr class="odd">
<td align="left">WATERBODY</td>
<td align="left">TST-GB-01-R</td>
</tr>
<tr class="even">
<td align="left">Alkalinity</td>
<td align="left">101.4</td>
</tr>
<tr class="odd">
<td align="left">Conductivity</td>
<td align="left">NA</td>
</tr>
<tr class="even">
<td align="left">hardness</td>
<td align="left">NA</td>
</tr>
<tr class="odd">
<td align="left">calcium</td>
<td align="left">NA</td>
</tr>
<tr class="even">
<td align="left">OBJECTID</td>
<td align="left">NA</td>
</tr>
<tr class="odd">
<td align="left">SX</td>
<td align="left">494200</td>
</tr>
<tr class="even">
<td align="left">SY</td>
<td align="left">491000</td>
</tr>
<tr class="odd">
<td align="left">EX</td>
<td align="left">NA</td>
</tr>
<tr class="even">
<td align="left">EY</td>
<td align="left">NA</td>
</tr>
<tr class="odd">
<td align="left">Altitude</td>
<td align="left">56</td>
</tr>
<tr class="even">
<td align="left">d_f_source</td>
<td align="left">16877.141</td>
</tr>
<tr class="odd">
<td align="left">logaltbar</td>
<td align="left">2.24428105</td>
</tr>
<tr class="even">
<td align="left">log_area</td>
<td align="left">1.69537222</td>
</tr>
<tr class="odd">
<td align="left">disch_cat</td>
<td align="left">3</td>
</tr>
<tr class="even">
<td align="left">slope</td>
<td align="left">2.57359314</td>
</tr>
<tr class="odd">
<td align="left">chalk</td>
<td align="left">0.0274263</td>
</tr>
<tr class="even">
<td align="left">clay</td>
<td align="left">0.134409</td>
</tr>
<tr class="odd">
<td align="left">hardrock</td>
<td align="left">0</td>
</tr>
<tr class="even">
<td align="left">limestone</td>
<td align="left">0</td>
</tr>
<tr class="odd">
<td align="left">peat</td>
<td align="left">0</td>
</tr>
<tr class="even">
<td align="left">shape_Length</td>
<td align="left">NA</td>
</tr>
<tr class="odd">
<td align="left">Spr_Season_ID</td>
<td align="left">1</td>
</tr>
<tr class="even">
<td align="left">Spr_TL2_WHPT_ASPT (AbW,DistFam)</td>
<td align="left">6.512</td>
</tr>
<tr class="odd">
<td align="left">Spr_TL2_WHPT_NTaxa (AbW,DistFam)</td>
<td align="left">24</td>
</tr>
<tr class="even">
<td align="left">Spr_Ntaxa_Bias</td>
<td align="left">1.62</td>
</tr>
<tr class="odd">
<td align="left">Sum_Season_ID</td>
<td align="left">2</td>
</tr>
<tr class="even">
<td align="left">Sum_TL2_WHPT_ASPT (AbW,DistFam)</td>
<td align="left">6.663</td>
</tr>
<tr class="odd">
<td align="left">Sum_TL2_WHPT_NTaxa (AbW,DistFam)</td>
<td align="left">27</td>
</tr>
<tr class="even">
<td align="left">Sum_Ntaxa_Bias</td>
<td align="left">1.62</td>
</tr>
<tr class="odd">
<td align="left">Aut_Season_ID</td>
<td align="left">3</td>
</tr>
<tr class="even">
<td align="left">Aut_TL2_WHPT_ASPT (AbW,DistFam)</td>
<td align="left">6.348</td>
</tr>
<tr class="odd">
<td align="left">Aut_TL2_WHPT_NTaxa (AbW,DistFam)</td>
<td align="left">27</td>
</tr>
<tr class="even">
<td align="left">Aut_Ntaxa_Bias</td>
<td align="left">1.62</td>
</tr>
</tbody>
</table>
<p>See the <a href="https://aquametrics.github.io/rict/">Input File</a>
excel spreadsheet which includes test data and validation</p>
<p>A full description of each column for the input table and how it is
completed can be found within the <a href="https://aquametrics.github.io/rict/">RICT user guide</a>.</p>
</div>
<div class="section level2" number="17">
<h2 id="annex-b-output-files-predict-and-classify">
<span class="header-section-number">17</span> Annex B: Output Files
predict and classify<a class="anchor" aria-label="anchor" href="#annex-b-output-files-predict-and-classify"></a>
</h2>
<div class="section level5" number="17.0.0.1">
<h5 id="prediction-outputs-1">
<span class="header-section-number">17.0.0.1</span> Prediction
outputs<a class="anchor" aria-label="anchor" href="#prediction-outputs-1"></a>
</h5>
<p>RICT predict and classify will produce two output files; one for
prediction, one for classification</p>
<p>Prediction Output file</p>
<p>An example of the output file for prediction is linked below:</p>
<table class="table">
<thead><tr class="header">
<th align="left"></th>
<th align="left">1</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">SITE</td>
<td align="left">MYR-GB-01-R</td>
</tr>
<tr class="even">
<td align="left">LATITUDE</td>
<td align="left">54.3059249</td>
</tr>
<tr class="odd">
<td align="left">LONGITUDE</td>
<td align="left">-0.553780286</td>
</tr>
<tr class="even">
<td align="left">LOG.ALTITUDE</td>
<td align="left">1.77815125</td>
</tr>
<tr class="odd">
<td align="left">LOG.DISTANCE.FROM.SOURCE</td>
<td align="left">1</td>
</tr>
<tr class="even">
<td align="left">LOG.WIDTH</td>
<td align="left">0.806179974</td>
</tr>
<tr class="odd">
<td align="left">LOG.DEPTH</td>
<td align="left">1.33645973</td>
</tr>
<tr class="even">
<td align="left">MEAN.SUBSTRATUM</td>
<td align="left">-5.6377551</td>
</tr>
<tr class="odd">
<td align="left">DISCHARGE.CATEGORY</td>
<td align="left">2</td>
</tr>
<tr class="even">
<td align="left">ALKALINITY</td>
<td align="left">101.4</td>
</tr>
<tr class="odd">
<td align="left">LOG.ALKALINITY</td>
<td align="left">2.00603795</td>
</tr>
<tr class="even">
<td align="left">LOG.SLOPE</td>
<td align="left">0.431363764</td>
</tr>
<tr class="odd">
<td align="left">MEAN.AIR.TEMP</td>
<td align="left">9.48625834</td>
</tr>
<tr class="even">
<td align="left">AIR.TEMP.RANGE</td>
<td align="left">11.9531393</td>
</tr>
<tr class="odd">
<td align="left">p1</td>
<td align="left">9.35625191e-09</td>
</tr>
<tr class="even">
<td align="left">p2</td>
<td align="left">6.9258721e-07</td>
</tr>
<tr class="odd">
<td align="left">p3</td>
<td align="left">1.05324199e-13</td>
</tr>
<tr class="even">
<td align="left">p4</td>
<td align="left">0.00000124332917</td>
</tr>
<tr class="odd">
<td align="left">p5</td>
<td align="left">3.49226117e-12</td>
</tr>
<tr class="even">
<td align="left">p6</td>
<td align="left">0.00000563026764</td>
</tr>
<tr class="odd">
<td align="left">p7</td>
<td align="left">8.85886928e-07</td>
</tr>
<tr class="even">
<td align="left">p8</td>
<td align="left">0.0000121781599</td>
</tr>
<tr class="odd">
<td align="left">p9</td>
<td align="left">0.000650372352</td>
</tr>
<tr class="even">
<td align="left">p10</td>
<td align="left">0.0000101954775</td>
</tr>
<tr class="odd">
<td align="left">p11</td>
<td align="left">0.0000757338524</td>
</tr>
<tr class="even">
<td align="left">p12</td>
<td align="left">0.00111837349</td>
</tr>
<tr class="odd">
<td align="left">p13</td>
<td align="left">0.00000198648293</td>
</tr>
<tr class="even">
<td align="left">p14</td>
<td align="left">2.31121211e-07</td>
</tr>
<tr class="odd">
<td align="left">p15</td>
<td align="left">1.13547466e-08</td>
</tr>
<tr class="even">
<td align="left">p16</td>
<td align="left">0.00128235533</td>
</tr>
<tr class="odd">
<td align="left">p17</td>
<td align="left">0.000237885641</td>
</tr>
<tr class="even">
<td align="left">p18</td>
<td align="left">0.00037426176</td>
</tr>
<tr class="odd">
<td align="left">p19</td>
<td align="left">0.0461301439</td>
</tr>
<tr class="even">
<td align="left">p20</td>
<td align="left">0.111632614</td>
</tr>
<tr class="odd">
<td align="left">p21</td>
<td align="left">0.0354693052</td>
</tr>
<tr class="even">
<td align="left">p22</td>
<td align="left">0.000918726922</td>
</tr>
<tr class="odd">
<td align="left">p23</td>
<td align="left">0.015013709</td>
</tr>
<tr class="even">
<td align="left">p24</td>
<td align="left">0.269136018</td>
</tr>
<tr class="odd">
<td align="left">p25</td>
<td align="left">0.00735522713</td>
</tr>
<tr class="even">
<td align="left">p26</td>
<td align="left">0.142875017</td>
</tr>
<tr class="odd">
<td align="left">p27</td>
<td align="left">0.091394313</td>
</tr>
<tr class="even">
<td align="left">p28</td>
<td align="left">0.104596167</td>
</tr>
<tr class="odd">
<td align="left">p29</td>
<td align="left">0.0000740990176</td>
</tr>
<tr class="even">
<td align="left">p30</td>
<td align="left">5.90527952e-10</td>
</tr>
<tr class="odd">
<td align="left">p31</td>
<td align="left">0.00235158298</td>
</tr>
<tr class="even">
<td align="left">p32</td>
<td align="left">0.107588442</td>
</tr>
<tr class="odd">
<td align="left">p33</td>
<td align="left">0.000555897078</td>
</tr>
<tr class="even">
<td align="left">p34</td>
<td align="left">0.000005673203</td>
</tr>
<tr class="odd">
<td align="left">p35</td>
<td align="left">0.03057304</td>
</tr>
<tr class="even">
<td align="left">p36</td>
<td align="left">0.0023718675</td>
</tr>
<tr class="odd">
<td align="left">p37</td>
<td align="left">0.0177924343</td>
</tr>
<tr class="even">
<td align="left">p38</td>
<td align="left">0.00830783677</td>
</tr>
<tr class="odd">
<td align="left">p39</td>
<td align="left">0.000625693191</td>
</tr>
<tr class="even">
<td align="left">p40</td>
<td align="left">0.0014486586</td>
</tr>
<tr class="odd">
<td align="left">p41</td>
<td align="left">0.0000114618661</td>
</tr>
<tr class="even">
<td align="left">p42</td>
<td align="left">2.61677226e-08</td>
</tr>
<tr class="odd">
<td align="left">p43</td>
<td align="left">4.28703879e-17</td>
</tr>
<tr class="even">
<td align="left">SuitCode</td>
<td align="left">1</td>
</tr>
<tr class="odd">
<td align="left">SuitText</td>
<td align="left">&gt;5%</td>
</tr>
<tr class="even">
<td align="left">belongs_to_end_grp</td>
<td align="left">EndGr24</td>
</tr>
<tr class="odd">
<td align="left">TL2_WHPT_NTAXA_AbW_DistFam_spr</td>
<td align="left">27.3034177</td>
</tr>
<tr class="even">
<td align="left">TL2_WHPT_ASPT_AbW_DistFam_spr</td>
<td align="left">6.69529166</td>
</tr>
<tr class="odd">
<td align="left">TL2_WHPT_NTAXA_AbW_DistFam_aut</td>
<td align="left">26.964738</td>
</tr>
<tr class="even">
<td align="left">TL2_WHPT_ASPT_AbW_DistFam_aut</td>
<td align="left">6.34146345</td>
</tr>
<tr class="odd">
<td align="left">TL2_WHPT_NTAXA_AbW_CompFam_spr</td>
<td align="left">26.6333663</td>
</tr>
<tr class="even">
<td align="left">TL2_WHPT_NTAXA_ASPT_CompFam_spr</td>
<td align="left">6.6786404</td>
</tr>
<tr class="odd">
<td align="left">TL2_WHPT_NTAXA_AbW_CompFam_aut</td>
<td align="left">26.4207811</td>
</tr>
<tr class="even">
<td align="left">TL2_WHPT_ASPT_AbW_CompFam_aut</td>
<td align="left">6.32932751</td>
</tr>
<tr class="odd">
<td align="left">TL2_WHPT_NTAXA_AbW_DistFam_sum</td>
<td align="left">25.1806036</td>
</tr>
<tr class="even">
<td align="left">TL2_WHPT_ASPT_AbW_DistFam_sum</td>
<td align="left">6.28047581</td>
</tr>
<tr class="odd">
<td align="left">TL2_WHPT_NTAXA_AbW_CompFam_sum</td>
<td align="left">24.666582</td>
</tr>
<tr class="even">
<td align="left">TL2_WHPT_ASPT_AbW_CompFam_sum</td>
<td align="left">6.26393808</td>
</tr>
<tr class="odd">
<td align="left">WATERBODY</td>
<td align="left">Waterbody name</td>
</tr>
<tr class="even">
<td align="left">YEAR</td>
<td align="left">2016</td>
</tr>
<tr class="odd">
<td align="left">SPR_SEASON_ID</td>
<td align="left">1</td>
</tr>
<tr class="even">
<td align="left">SPR_TL2_WHPT_ASPT (ABW,DISTFAM)</td>
<td align="left">6.512</td>
</tr>
<tr class="odd">
<td align="left">SPR_TL2_WHPT_NTAXA (ABW,DISTFAM)</td>
<td align="left">24</td>
</tr>
<tr class="even">
<td align="left">SPR_NTAXA_BIAS</td>
<td align="left">1.62</td>
</tr>
<tr class="odd">
<td align="left">SUM_SEASON_ID</td>
<td align="left">2</td>
</tr>
<tr class="even">
<td align="left">SUM_TL2_WHPT_ASPT (ABW,DISTFAM)</td>
<td align="left">6.663</td>
</tr>
<tr class="odd">
<td align="left">SUM_TL2_WHPT_NTAXA (ABW,DISTFAM)</td>
<td align="left">27</td>
</tr>
<tr class="even">
<td align="left">SUM_NTAXA_BIAS</td>
<td align="left">1.62</td>
</tr>
<tr class="odd">
<td align="left">AUT_SEASON_ID</td>
<td align="left">3</td>
</tr>
<tr class="even">
<td align="left">AUT_TL2_WHPT_ASPT (ABW,DISTFAM)</td>
<td align="left">6.348</td>
</tr>
<tr class="odd">
<td align="left">AUT_TL2_WHPT_NTAXA (ABW,DISTFAM)</td>
<td align="left">27</td>
</tr>
<tr class="even">
<td align="left">AUT_NTAXA_BIAS</td>
<td align="left">1.62</td>
</tr>
<tr class="odd">
<td align="left">area</td>
<td align="left">gb</td>
</tr>
</tbody>
</table>
</div>
<div class="section level5" number="17.0.0.2">
<h5 id="classification-2">
<span class="header-section-number">17.0.0.2</span>
Classification<a class="anchor" aria-label="anchor" href="#classification-2"></a>
</h5>
<p>Multiple year:</p>
<table class="table">
<thead><tr class="header">
<th align="left"></th>
<th align="left">1</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">SITE</td>
<td align="left">MYR-GB-01-R</td>
</tr>
<tr class="even">
<td align="left">YEAR</td>
<td align="left">2016</td>
</tr>
<tr class="odd">
<td align="left">WATERBODY</td>
<td align="left">Waterbody name</td>
</tr>
<tr class="even">
<td align="left">H_NTAXA_spr_aut</td>
<td align="left">96.9</td>
</tr>
<tr class="odd">
<td align="left">G_NTAXA_spr_aut</td>
<td align="left">3.02</td>
</tr>
<tr class="even">
<td align="left">M_NTAXA_spr_aut</td>
<td align="left">0.08</td>
</tr>
<tr class="odd">
<td align="left">P_NTAXA_spr_aut</td>
<td align="left">0</td>
</tr>
<tr class="even">
<td align="left">B_NTAXA_spr_aut</td>
<td align="left">0</td>
</tr>
<tr class="odd">
<td align="left">mostProb_NTAXA_spr_aut</td>
<td align="left">H</td>
</tr>
<tr class="even">
<td align="left">NTAXA_aver_spr_aut</td>
<td align="left">1.00079713</td>
</tr>
<tr class="odd">
<td align="left">H_ASPT_spr_aut</td>
<td align="left">52.14</td>
</tr>
<tr class="even">
<td align="left">G_ASPT_spr_aut</td>
<td align="left">44.12</td>
</tr>
<tr class="odd">
<td align="left">M_ASPT_spr_aut</td>
<td align="left">3.73</td>
</tr>
<tr class="even">
<td align="left">P_ASPT_spr_aut</td>
<td align="left">0.01</td>
</tr>
<tr class="odd">
<td align="left">B_ASPT_spr_aut</td>
<td align="left">0</td>
</tr>
<tr class="even">
<td align="left">mostProb_ASPT_spr_aut</td>
<td align="left">H</td>
</tr>
<tr class="odd">
<td align="left">ASPT_aver_spr_aut</td>
<td align="left">0.97079562</td>
</tr>
<tr class="even">
<td align="left">mintawhpt_spr_aut_H_MINTA_</td>
<td align="left">52.14</td>
</tr>
<tr class="odd">
<td align="left">mintawhpt_spr_aut_G_MINTA_</td>
<td align="left">44.12</td>
</tr>
<tr class="even">
<td align="left">mintawhpt_spr_aut_M_MINTA_</td>
<td align="left">3.73</td>
</tr>
<tr class="odd">
<td align="left">mintawhpt_spr_aut_P_MINTA_</td>
<td align="left">0.01</td>
</tr>
<tr class="even">
<td align="left">mintawhpt_spr_aut_B_MINTA_</td>
<td align="left">0</td>
</tr>
<tr class="odd">
<td align="left">mintawhpt_spr_aut_mostProb_MINTA_</td>
<td align="left">H</td>
</tr>
</tbody>
</table>
<p>Single year:</p>
<table class="table">
<thead><tr class="header">
<th align="left"></th>
<th align="left">1</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">SITE</td>
<td align="left">MYR-GB-01-R</td>
</tr>
<tr class="even">
<td align="left">YEAR</td>
<td align="left">2016</td>
</tr>
<tr class="odd">
<td align="left">WATERBODY</td>
<td align="left">Waterbody name</td>
</tr>
<tr class="even">
<td align="left">H_NTAXA_spr</td>
<td align="left">90.59</td>
</tr>
<tr class="odd">
<td align="left">G_NTAXA_spr</td>
<td align="left">8.82</td>
</tr>
<tr class="even">
<td align="left">M_NTAXA_spr</td>
<td align="left">0.59</td>
</tr>
<tr class="odd">
<td align="left">P_NTAXA_spr</td>
<td align="left">0</td>
</tr>
<tr class="even">
<td align="left">B_NTAXA_spr</td>
<td align="left">0</td>
</tr>
<tr class="odd">
<td align="left">mostProb_NTAXA_spr</td>
<td align="left">H</td>
</tr>
<tr class="even">
<td align="left">NTAXA_eqr_av_spr</td>
<td align="left">0.939394037</td>
</tr>
<tr class="odd">
<td align="left">H_NTAXA_aut</td>
<td align="left">99.24</td>
</tr>
<tr class="even">
<td align="left">G_NTAXA_aut</td>
<td align="left">0.76</td>
</tr>
<tr class="odd">
<td align="left">M_NTAXA_aut</td>
<td align="left">0</td>
</tr>
<tr class="even">
<td align="left">P_NTAXA_aut</td>
<td align="left">0</td>
</tr>
<tr class="odd">
<td align="left">B_NTAXA_aut</td>
<td align="left">0</td>
</tr>
<tr class="even">
<td align="left">mostProb_NTAXA_aut</td>
<td align="left">H</td>
</tr>
<tr class="odd">
<td align="left">NTAXA_eqr_av_aut</td>
<td align="left">1.06220021</td>
</tr>
<tr class="even">
<td align="left">H_NTAXA_spr_aut</td>
<td align="left">96.9</td>
</tr>
<tr class="odd">
<td align="left">G_NTAXA_spr_aut</td>
<td align="left">3.02</td>
</tr>
<tr class="even">
<td align="left">M_NTAXA_spr_aut</td>
<td align="left">0.08</td>
</tr>
<tr class="odd">
<td align="left">P_NTAXA_spr_aut</td>
<td align="left">0</td>
</tr>
<tr class="even">
<td align="left">B_NTAXA_spr_aut</td>
<td align="left">0</td>
</tr>
<tr class="odd">
<td align="left">mostProb_NTAXA_spr_aut</td>
<td align="left">H</td>
</tr>
<tr class="even">
<td align="left">NTAXA_aver_spr_aut</td>
<td align="left">1.00079713</td>
</tr>
<tr class="odd">
<td align="left">H_ASPT_spr</td>
<td align="left">41.97</td>
</tr>
<tr class="even">
<td align="left">G_ASPT_spr</td>
<td align="left">52.45</td>
</tr>
<tr class="odd">
<td align="left">M_ASPT_spr</td>
<td align="left">5.52</td>
</tr>
<tr class="even">
<td align="left">P_ASPT_spr</td>
<td align="left">0.06</td>
</tr>
<tr class="odd">
<td align="left">B_ASPT_spr</td>
<td align="left">0</td>
</tr>
<tr class="even">
<td align="left">mostProb_ASPT_spr</td>
<td align="left">G</td>
</tr>
<tr class="odd">
<td align="left">ASPT_eqr_av_spr</td>
<td align="left">0.956092544</td>
</tr>
<tr class="even">
<td align="left">H_ASPT_aut</td>
<td align="left">62.36</td>
</tr>
<tr class="odd">
<td align="left">G_ASPT_aut</td>
<td align="left">35.26</td>
</tr>
<tr class="even">
<td align="left">M_ASPT_aut</td>
<td align="left">2.38</td>
</tr>
<tr class="odd">
<td align="left">P_ASPT_aut</td>
<td align="left">0</td>
</tr>
<tr class="even">
<td align="left">B_ASPT_aut</td>
<td align="left">0</td>
</tr>
<tr class="odd">
<td align="left">mostProb_ASPT_aut</td>
<td align="left">H</td>
</tr>
<tr class="even">
<td align="left">ASPT_eqr_av_aut</td>
<td align="left">0.985498696</td>
</tr>
<tr class="odd">
<td align="left">H_ASPT_spr_aut</td>
<td align="left">52.14</td>
</tr>
<tr class="even">
<td align="left">G_ASPT_spr_aut</td>
<td align="left">44.12</td>
</tr>
<tr class="odd">
<td align="left">M_ASPT_spr_aut</td>
<td align="left">3.73</td>
</tr>
<tr class="even">
<td align="left">P_ASPT_spr_aut</td>
<td align="left">0.01</td>
</tr>
<tr class="odd">
<td align="left">B_ASPT_spr_aut</td>
<td align="left">0</td>
</tr>
<tr class="even">
<td align="left">mostProb_ASPT_spr_aut</td>
<td align="left">H</td>
</tr>
<tr class="odd">
<td align="left">ASPT_aver_spr_aut</td>
<td align="left">0.97079562</td>
</tr>
<tr class="even">
<td align="left">mintawhpt_spr_H</td>
<td align="left">41.97</td>
</tr>
<tr class="odd">
<td align="left">mintawhpt_spr_G</td>
<td align="left">52.4</td>
</tr>
<tr class="even">
<td align="left">mintawhpt_spr_M</td>
<td align="left">5.57</td>
</tr>
<tr class="odd">
<td align="left">mintawhpt_spr_P</td>
<td align="left">0.06</td>
</tr>
<tr class="even">
<td align="left">mintawhpt_spr_B</td>
<td align="left">0</td>
</tr>
<tr class="odd">
<td align="left">mintawhpt_spr_mostProb</td>
<td align="left">G</td>
</tr>
<tr class="even">
<td align="left">mintawhpt_aut_H</td>
<td align="left">62.36</td>
</tr>
<tr class="odd">
<td align="left">mintawhpt_aut_G</td>
<td align="left">35.26</td>
</tr>
<tr class="even">
<td align="left">mintawhpt_aut_M</td>
<td align="left">2.38</td>
</tr>
<tr class="odd">
<td align="left">mintawhpt_aut_P</td>
<td align="left">0</td>
</tr>
<tr class="even">
<td align="left">mintawhpt_aut_B</td>
<td align="left">0</td>
</tr>
<tr class="odd">
<td align="left">mintawhpt_aut_mostProb</td>
<td align="left">H</td>
</tr>
<tr class="even">
<td align="left">mintawhpt_spr_aut_H</td>
<td align="left">52.14</td>
</tr>
<tr class="odd">
<td align="left">mintawhpt_spr_aut_G</td>
<td align="left">44.12</td>
</tr>
<tr class="even">
<td align="left">mintawhpt_spr_aut_M</td>
<td align="left">3.73</td>
</tr>
<tr class="odd">
<td align="left">mintawhpt_spr_aut_P</td>
<td align="left">0.01</td>
</tr>
<tr class="even">
<td align="left">mintawhpt_spr_aut_B</td>
<td align="left">0</td>
</tr>
<tr class="odd">
<td align="left">mintawhpt_spr_aut_mostProb_MINTA_</td>
<td align="left">H</td>
</tr>
<tr class="even">
<td align="left">eqr_av_sum_aspt</td>
<td align="left">1.0426497</td>
</tr>
<tr class="odd">
<td align="left">H_ASPT_sum</td>
<td align="left">88.57</td>
</tr>
<tr class="even">
<td align="left">G_ASPT_sum</td>
<td align="left">11.05</td>
</tr>
<tr class="odd">
<td align="left">M_ASPT_sum</td>
<td align="left">0.38</td>
</tr>
<tr class="even">
<td align="left">P_ASPT_sum</td>
<td align="left">0</td>
</tr>
<tr class="odd">
<td align="left">B_ASPT_sum</td>
<td align="left">0</td>
</tr>
<tr class="even">
<td align="left">mostProb_ASPT_sum</td>
<td align="left">H</td>
</tr>
<tr class="odd">
<td align="left">NTAXA_eqr_av_sum</td>
<td align="left">1.13733288</td>
</tr>
<tr class="even">
<td align="left">H_NTAXA_sum</td>
<td align="left">99.89</td>
</tr>
<tr class="odd">
<td align="left">G_NTAXA_sum</td>
<td align="left">0.11</td>
</tr>
<tr class="even">
<td align="left">M_NTAXA_sum</td>
<td align="left">0</td>
</tr>
<tr class="odd">
<td align="left">P_NTAXA_sum</td>
<td align="left">0</td>
</tr>
<tr class="even">
<td align="left">B_NTAXA_sum</td>
<td align="left">0</td>
</tr>
<tr class="odd">
<td align="left">mostProb_NTAXA_sum</td>
<td align="left">H</td>
</tr>
<tr class="even">
<td align="left">mintawhpt_sum_H</td>
<td align="left">88.57</td>
</tr>
<tr class="odd">
<td align="left">mintawhpt_sum_G</td>
<td align="left">11.05</td>
</tr>
<tr class="even">
<td align="left">mintawhpt_sum_M</td>
<td align="left">0.38</td>
</tr>
<tr class="odd">
<td align="left">mintawhpt_sum_P</td>
<td align="left">0</td>
</tr>
<tr class="even">
<td align="left">mintawhpt_sum_B</td>
<td align="left">0</td>
</tr>
<tr class="odd">
<td align="left">mintawhpt_sum_mostProb</td>
<td align="left">H</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="section level2" number="18">
<h2 id="appendix-c-biotic-included-in-all-index-prediction">
<span class="header-section-number">18</span> Appendix C: Biotic
included in all index prediction<a class="anchor" aria-label="anchor" href="#appendix-c-biotic-included-in-all-index-prediction"></a>
</h2>
<p>*Please note the format changes to the labels of the indices – see
table of changes below:</p>
<table class="table">
<colgroup>
<col width="3%">
<col width="48%">
<col width="47%">
</colgroup>
<thead><tr class="header">
<th align="left"></th>
<th align="left">RIVPACS DB Label</th>
<th align="left">OUTPUT Label</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">5</td>
<td align="left">TL1 BMWP</td>
<td align="left">TL1_BMWP</td>
</tr>
<tr class="even">
<td align="left">6</td>
<td align="left">TL1 NTAXA</td>
<td align="left">TL1_NTAXA</td>
</tr>
<tr class="odd">
<td align="left">7</td>
<td align="left">TL1 ASPT</td>
<td align="left">TL1_ASPT</td>
</tr>
<tr class="even">
<td align="left">8</td>
<td align="left">TL2 WHPT Score (nonAb,DistFam)</td>
<td align="left">TL2_WHPT_Score_nonAb_DistFam</td>
</tr>
<tr class="odd">
<td align="left">9</td>
<td align="left">TL2 WHPT NTAXA (nonAb,DistFam)</td>
<td align="left">TL2_WHPT_NTAXA_nonAb_DistFam</td>
</tr>
<tr class="even">
<td align="left">10</td>
<td align="left">TL2 WHPT ASPT (nonAb,DistFam)</td>
<td align="left">TL2_WHPT_ASPT_nonAb_DistFam</td>
</tr>
<tr class="odd">
<td align="left">11</td>
<td align="left">TL2 WHPT Score (nonAb,CompFam)</td>
<td align="left">TL2_WHPT_Score_nonAb_CompFam</td>
</tr>
<tr class="even">
<td align="left">12</td>
<td align="left">TL2 WHPT NTAXA (nonAb,CompFam)</td>
<td align="left">TL2_WHPT_NTAXA_nonAb_CompFam</td>
</tr>
<tr class="odd">
<td align="left">13</td>
<td align="left">TL2 WHPT ASPT (nonAb,CompFam)</td>
<td align="left">TL2_WHPT_ASPT_nonAb_CompFam</td>
</tr>
<tr class="even">
<td align="left">14</td>
<td align="left">TL2 WHPT Score (AbW,DistFam)</td>
<td align="left">TL2_WHPT_Score_AbW_DistFam</td>
</tr>
<tr class="odd">
<td align="left">15</td>
<td align="left">TL2 WHPT NTAXA (AbW,DistFam)</td>
<td align="left">TL2_WHPT_NTAXA_AbW_DistFam</td>
</tr>
<tr class="even">
<td align="left">16</td>
<td align="left">TL2 WHPT ASPT (AbW,DistFam)</td>
<td align="left">TL2_WHPT_ASPT_AbW_DistFam</td>
</tr>
<tr class="odd">
<td align="left">17</td>
<td align="left">TL2 WHPT Score (AbW,CompFam)</td>
<td align="left">TL2_WHPT_Score_AbW_CompFam</td>
</tr>
<tr class="even">
<td align="left">18</td>
<td align="left">TL2 WHPT NTAXA (AbW,CompFam)</td>
<td align="left">TL2_WHPT_NTAXA_AbW_CompFam</td>
</tr>
<tr class="odd">
<td align="left">19</td>
<td align="left">TL2 WHPT ASPT (AbW,CompFam)</td>
<td align="left">TL2_WHPT_ASPT_AbW_CompFam</td>
</tr>
<tr class="even">
<td align="left">20</td>
<td align="left">TL1 AWIC(Fam)</td>
<td align="left">TL1_AWIC_Fam</td>
</tr>
<tr class="odd">
<td align="left">21</td>
<td align="left">TL4 AWIC(Sp) Murphy</td>
<td align="left">TL4_AWIC_Sp_Murphy</td>
</tr>
<tr class="even">
<td align="left">22</td>
<td align="left">TL5 AWIC(Sp) Murphy</td>
<td align="left">TL5_AWIC_Sp_Murphy</td>
</tr>
<tr class="odd">
<td align="left">23</td>
<td align="left">TL4 WFD AWIC(Sp) McFarland</td>
<td align="left">TL4_WFD_AWIC_Sp_McFarland</td>
</tr>
<tr class="even">
<td align="left">24</td>
<td align="left">TL5 WFD AWIC(Sp) McFarland</td>
<td align="left">TL5_WFD_AWIC_Sp_McFarland</td>
</tr>
<tr class="odd">
<td align="left">25</td>
<td align="left">TL4 Raddum</td>
<td align="left">TL4_Raddum</td>
</tr>
<tr class="even">
<td align="left">26</td>
<td align="left">TL5 Raddum</td>
<td align="left">TL5_Raddum</td>
</tr>
<tr class="odd">
<td align="left">27</td>
<td align="left">TL4 SEPA % Acid Sensitive Taxa</td>
<td align="left">TL4_SEPA_per_Acid_Sensitive_Taxa</td>
</tr>
<tr class="even">
<td align="left">28</td>
<td align="left">TL5 SEPA % Acid Sensitive Taxa</td>
<td align="left">TL5_SEPA_perc_Acid_Sensitive_Taxa</td>
</tr>
<tr class="odd">
<td align="left">29</td>
<td align="left">TL4 MetTol</td>
<td align="left">TL4_MetTol</td>
</tr>
<tr class="even">
<td align="left">30</td>
<td align="left">TL5 MetTol</td>
<td align="left">TL5_MetTol</td>
</tr>
<tr class="odd">
<td align="left">31</td>
<td align="left">TL1/2 LIFE(Fam) (CompFam)</td>
<td align="left">TL1_2_LIFE_Fam_CompFam</td>
</tr>
<tr class="even">
<td align="left">32</td>
<td align="left">TL2 LIFE(Fam) (DistFam)</td>
<td align="left">TL2_LIFE_Fam_DistFam</td>
</tr>
<tr class="odd">
<td align="left">33</td>
<td align="left">TL3 LIFE(Fam) (DistFam)</td>
<td align="left">TL3_LIFE_Fam_DistFam</td>
</tr>
<tr class="even">
<td align="left">34</td>
<td align="left">TL4 LIFE(Sp)</td>
<td align="left">TL4_LIFE_Sp</td>
</tr>
<tr class="odd">
<td align="left">35</td>
<td align="left">TL5 LIFE(Sp)</td>
<td align="left">TL5_LIFE_Sp</td>
</tr>
<tr class="even">
<td align="left">36</td>
<td align="left">TL3 PSI(Fam)</td>
<td align="left">TL3_PSI_Fam</td>
</tr>
<tr class="odd">
<td align="left">37</td>
<td align="left">TL4 PSI(Sp)</td>
<td align="left">TL4_PSI_Sp</td>
</tr>
<tr class="even">
<td align="left">38</td>
<td align="left">TL5 PSI(Sp)</td>
<td align="left">TL5_PSI_Sp</td>
</tr>
<tr class="odd">
<td align="left">39</td>
<td align="left">TL3 E-PSI(fam69)</td>
<td align="left">TL3_E_PSI_fam69</td>
</tr>
<tr class="even">
<td align="left">40</td>
<td align="left">TL4 E-PSI(mixed level)</td>
<td align="left">TL4_E_PSI_mixed_level</td>
</tr>
<tr class="odd">
<td align="left">41</td>
<td align="left">TL5 E-PSI(mixed level)</td>
<td align="left">TL5_E_PSI_mixed_level</td>
</tr>
<tr class="even">
<td align="left">42</td>
<td align="left">TL4 oFSIsp</td>
<td align="left">TL4_oFSIsp</td>
</tr>
<tr class="odd">
<td align="left">43</td>
<td align="left">TL5 oFSIsp</td>
<td align="left">TL5_oFSIsp</td>
</tr>
<tr class="even">
<td align="left">44</td>
<td align="left">TL4 ToFSIsp</td>
<td align="left">TL4_ToFSIsp</td>
</tr>
<tr class="odd">
<td align="left">45</td>
<td align="left">TL5 ToFSIsp</td>
<td align="left">TL5_ToFSIsp</td>
</tr>
<tr class="even">
<td align="left">46</td>
<td align="left">TL4 CoFSIsp</td>
<td align="left">TL4_CoFSIsp</td>
</tr>
<tr class="odd">
<td align="left">47</td>
<td align="left">TL5 CoFSIsp</td>
<td align="left">TL5_CoFSIsp</td>
</tr>
<tr class="even">
<td align="left">48</td>
<td align="left">TL4 GSFI FI05</td>
<td align="left">TL4_GSFI_FI05</td>
</tr>
<tr class="odd">
<td align="left">49</td>
<td align="left">TL5 GSFI FI05</td>
<td align="left">TL5_GSFI_FI05</td>
</tr>
<tr class="even">
<td align="left">50</td>
<td align="left">TL4 GSFI FI09</td>
<td align="left">TL4_GSFI_FI09</td>
</tr>
<tr class="odd">
<td align="left">51</td>
<td align="left">TL5 GSFI FI09</td>
<td align="left">TL5_GSFI_FI09</td>
</tr>
<tr class="even">
<td align="left">52</td>
<td align="left">TL4 GSFI FI091</td>
<td align="left">TL4_GSFI_FI091</td>
</tr>
<tr class="odd">
<td align="left">53</td>
<td align="left">TL5 GSFI FI091</td>
<td align="left">TL5_GSFI_FI091</td>
</tr>
<tr class="even">
<td align="left">54</td>
<td align="left">TL4 GSFI FI091_K</td>
<td align="left">TL4_GSFI_FI091_K</td>
</tr>
<tr class="odd">
<td align="left">55</td>
<td align="left">TL5 GSFI FI091_K</td>
<td align="left">TL5_GSFI_FI091_K</td>
</tr>
<tr class="even">
<td align="left">56</td>
<td align="left">TL4 GSFI FI092</td>
<td align="left">TL4_GSFI_FI092</td>
</tr>
<tr class="odd">
<td align="left">57</td>
<td align="left">TL5 GSFI FI092</td>
<td align="left">TL5_GSFI_FI092</td>
</tr>
<tr class="even">
<td align="left">58</td>
<td align="left">TL4 GSFI FI11_12</td>
<td align="left">TL4_GSFI_FI11_12</td>
</tr>
<tr class="odd">
<td align="left">59</td>
<td align="left">TL5 GSFI FI11_12</td>
<td align="left">TL5_GSFI_FI11_12</td>
</tr>
<tr class="even">
<td align="left">60</td>
<td align="left">TL4 GSFI FI14_16</td>
<td align="left">TL4_GSFI_FI14_16</td>
</tr>
<tr class="odd">
<td align="left">61</td>
<td align="left">TL5 GSFI FI14_16</td>
<td align="left">TL5_GSFI_FI14_16</td>
</tr>
<tr class="even">
<td align="left">62</td>
<td align="left">TL4 GSFI FI15_17</td>
<td align="left">TL4_GSFI_FI15_17</td>
</tr>
<tr class="odd">
<td align="left">63</td>
<td align="left">TL5 GSFI FI15_17</td>
<td align="left">TL5_GSFI_FI15_17</td>
</tr>
<tr class="even">
<td align="left">64</td>
<td align="left">TL4 GSFI FI152</td>
<td align="left">TL4_GSFI_FI152</td>
</tr>
<tr class="odd">
<td align="left">65</td>
<td align="left">TL5 GSFI FI152</td>
<td align="left">TL5_GSFI_FI152</td>
</tr>
<tr class="even">
<td align="left">66</td>
<td align="left">TL2 SPEAR(Fam) %</td>
<td align="left">TL2_SPEAR_Fam_perc</td>
</tr>
<tr class="odd">
<td align="left">67</td>
<td align="left">TL4 SPEAR(Sp) %</td>
<td align="left">TL4_SPEAR_Sp_perc</td>
</tr>
<tr class="even">
<td align="left">68</td>
<td align="left">TL5 SPEAR(Sp) %</td>
<td align="left">TL5_SPEAR_Sp_perc</td>
</tr>
<tr class="odd">
<td align="left">69</td>
<td align="left">SPEAR(pesticides) TL2 fam Knillmann 2018</td>
<td align="left">SPEAR_pesticides_TL2_fam_Knillmann_2018</td>
</tr>
<tr class="even">
<td align="left">70</td>
<td align="left">SPEAR(refuge) TL2 fam Knillmann 2018</td>
<td align="left">SPEAR_refuge_TL2_fam_Knillmann_2018</td>
</tr>
<tr class="odd">
<td align="left">71</td>
<td align="left">SPEAR(pesticides) TL4 sp Knillmann 2018</td>
<td align="left">SPEAR_pesticides_TL4_sp_Knillmann_2018</td>
</tr>
<tr class="even">
<td align="left">72</td>
<td align="left">SPEAR(refuge) TL4 sp Knillmann 2018</td>
<td align="left">SPEAR_refuge_TL4_sp_Knillmann_2018</td>
</tr>
<tr class="odd">
<td align="left">73</td>
<td align="left">SPEAR(pesticides) TL5 sp Knillmann 2018</td>
<td align="left">SPEAR_pesticides_TL5_sp_Knillmann_2018</td>
</tr>
<tr class="even">
<td align="left">74</td>
<td align="left">SPEAR(refuge) TL5 sp Knillmann 2018</td>
<td align="left">SPEAR_refuge_TL5_sp_Knillmann_2018</td>
</tr>
<tr class="odd">
<td align="left">75</td>
<td align="left">TL4 CCI</td>
<td align="left">TL4_CCI</td>
</tr>
<tr class="even">
<td align="left">76</td>
<td align="left">TL5 CCI</td>
<td align="left">TL5_CCI</td>
</tr>
<tr class="odd">
<td align="left">77</td>
<td align="left">TL2 08 Group ARMI NTaxa</td>
<td align="left">TL2_08_Group_ARMI_NTaxa</td>
</tr>
<tr class="even">
<td align="left">78</td>
<td align="left">TL2 08 Group ARMI Score</td>
<td align="left">TL2_08_Group_ARMI_Score</td>
</tr>
<tr class="odd">
<td align="left">79</td>
<td align="left">TL2 33 Group ARMI NTaxa</td>
<td align="left">TL2_33_Group_ARMI_NTaxa</td>
</tr>
<tr class="even">
<td align="left">80</td>
<td align="left">TL2 33 Group ARMI Score</td>
<td align="left">TL2_33_Group_ARMI_Score</td>
</tr>
<tr class="odd">
<td align="left">81</td>
<td align="left">TL2 33 Group Flow &amp; Silt NTaxa</td>
<td align="left">TL2_33_Group_Flow_Silt_NTaxa</td>
</tr>
<tr class="even">
<td align="left">82</td>
<td align="left">TL2 33 Group Flow &amp; Silt Score</td>
<td align="left">TL2_33_Group_Flow_Silt_Score</td>
</tr>
<tr class="odd">
<td align="left">83</td>
<td align="left">TL2 14 Group Urban NTaxa</td>
<td align="left">TL2_14_Group_Urban_NTaxa</td>
</tr>
<tr class="even">
<td align="left">84</td>
<td align="left">TL2 14 Group Urban Score</td>
<td align="left">TL2_14_Group_Urban_Score</td>
</tr>
</tbody>
</table>
<p>A full description of each column for the prediction output table and
what the values indicate can be found within the RICT user guide. A
summary list of the column headings is given in the
<code>rict_predict</code> function.</p>
</div>
<div class="section level2" number="19">
<h2 id="annex-d-critical-success-factors">
<span class="header-section-number">19</span> Annex D: Critical
Success Factors<a class="anchor" aria-label="anchor" href="#annex-d-critical-success-factors"></a>
</h2>
<p>The CSF specified below denotes the minimum requirements as agreed
with the project team and stakeholders as agreed in the outline business
case:</p>
<table class="table">
<colgroup>
<col width="3%">
<col width="13%">
<col width="76%">
<col width="6%">
</colgroup>
<thead><tr class="header">
<th align="left">N</th>
<th align="left">Level</th>
<th align="left">Description</th>
<th align="left">Score</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">1</td>
<td align="left">Primary</td>
<td align="left">RICT can complete the full national classification in
June 2019</td>
<td align="left">3</td>
</tr>
<tr class="even">
<td align="left">2</td>
<td align="left">Primary</td>
<td align="left">Improved performance of RICT – end to end processing
time</td>
<td align="left">3</td>
</tr>
<tr class="odd">
<td align="left">3</td>
<td align="left">Primary</td>
<td align="left">New RIVPACS model added to RICT</td>
<td align="left">3</td>
</tr>
<tr class="even">
<td align="left">4</td>
<td align="left">Primary</td>
<td align="left">Platform and associated code accessible for future
development</td>
<td align="left">3</td>
</tr>
<tr class="odd">
<td align="left">5</td>
<td align="left">Secondary</td>
<td align="left">Agree ongoing support and maintenance arrangement
(Hosting)</td>
<td align="left">2</td>
</tr>
<tr class="even">
<td align="left">6</td>
<td align="left">Secondary</td>
<td align="left">Agree ongoing support, maintenance and development
arrangement (application)</td>
<td align="left">2</td>
</tr>
<tr class="odd">
<td align="left">7</td>
<td align="left">Secondary</td>
<td align="left">Improved technical and scientific resilience</td>
<td align="left">2</td>
</tr>
<tr class="even">
<td align="left">8</td>
<td align="left">Tertiary</td>
<td align="left">Critical bugs resolved</td>
<td align="left">1</td>
</tr>
<tr class="odd">
<td align="left">9</td>
<td align="left">Tertiary</td>
<td align="left">Critical functionality added</td>
<td align="left">1</td>
</tr>
<tr class="even">
<td align="left">10</td>
<td align="left">Tertiary</td>
<td align="left">Non critical bugs resolved</td>
<td align="left">1</td>
</tr>
<tr class="odd">
<td align="left">11</td>
<td align="left">Tertiary</td>
<td align="left">Non critical functionality added</td>
<td align="left">1</td>
</tr>
<tr class="even">
<td align="left">12</td>
<td align="left">Tertiary</td>
<td align="left">Produce an updated functional specification and
architecture documentation</td>
<td align="left">1</td>
</tr>
</tbody>
</table>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Maybin Muyeba, Tim Foster, Tim Loveday.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
